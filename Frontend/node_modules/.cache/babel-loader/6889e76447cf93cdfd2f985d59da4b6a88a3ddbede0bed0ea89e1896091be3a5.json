{"ast":null,"code":"import * as $type from \"./Type\";\nimport * as $array from \"./Array\";\nimport * as $object from \"./Object\";\nimport { Disposer, DisposerClass } from \"./Disposer\";\n/**\r\n * ============================================================================\r\n * DOM FUNCTIONS\r\n * ============================================================================\r\n * @hidden\r\n */\n/**\r\n * Execute a function when DOM is ready.\r\n *\r\n * @since 5.0.2\r\n * @param  f  Callback\r\n */\nexport function ready(f) {\n  if (document.readyState !== \"loading\") {\n    f();\n  } else {\n    const listener = () => {\n      if (document.readyState !== \"loading\") {\n        document.removeEventListener(\"readystatechange\", listener);\n        f();\n      }\n    };\n    document.addEventListener(\"readystatechange\", listener);\n  }\n}\n/**\r\n * Removes a DOM element.\r\n * @param  el  Target element\r\n */\nexport function removeElement(el) {\n  if (el.parentNode) {\n    el.parentNode.removeChild(el);\n  }\n}\n/**\r\n * Function that adds a disposable event listener directly to a DOM element.\r\n *\r\n * @ignore Exclude from docs\r\n * @param dom       A DOM element to add event to\r\n * @param type      Event type\r\n * @param listener  Event listener\r\n * @returns Disposable event\r\n */\nexport function addEventListener(dom, type, listener, options) {\n  //@todo proper type check for options: EventListenerOptions | boolean (TS for some reason gives error on passive parameter)\n  dom.addEventListener(type, listener, options || false);\n  return new Disposer(() => {\n    dom.removeEventListener(type, listener, options || false);\n  });\n}\n/**\r\n * Function that adds an event listener which is triggered when the browser's zoom changes.\r\n *\r\n * @param listener  Event listener\r\n * @returns Disposable event\r\n */\nexport function onZoom(listener) {\n  // TODO use matchMedia instead ?\n  return addEventListener(window, \"resize\", _ev => {\n    listener();\n  });\n}\n/**\r\n * @ignore\r\n */\nexport function supports(cap) {\n  switch (cap) {\n    case \"touchevents\":\n      //return \"ontouchstart\" in document.documentElement;\n      return window.hasOwnProperty(\"TouchEvent\");\n    case \"pointerevents\":\n      return window.hasOwnProperty(\"PointerEvent\");\n    case \"mouseevents\":\n      return window.hasOwnProperty(\"MouseEvent\");\n    case \"wheelevents\":\n      return window.hasOwnProperty(\"WheelEvent\");\n    case \"keyboardevents\":\n      return window.hasOwnProperty(\"KeyboardEvent\");\n  }\n  return false;\n}\n/**\r\n * @ignore\r\n */\nexport function getPointerId(event) {\n  let id = event.pointerId || 0;\n  return id;\n}\n/**\r\n * Removes focus from any element by shifting focus to body.\r\n *\r\n * @ignore\r\n */\nexport function blur() {\n  if (document.activeElement && document.activeElement != document.body) {\n    if (document.activeElement.blur) {\n      document.activeElement.blur();\n    } else {\n      let input = document.createElement(\"button\");\n      input.style.position = \"fixed\";\n      input.style.top = \"0px\";\n      input.style.left = \"-10000px\";\n      document.body.appendChild(input);\n      input.focus();\n      input.blur();\n      document.body.removeChild(input);\n    }\n  }\n}\n/**\r\n * Focuses element.\r\n *\r\n * @ignore\r\n */\nexport function focus(el) {\n  if (el) {\n    el.focus();\n  }\n}\n/**\r\n * @ignore\r\n */\nexport function getRendererEvent(key) {\n  if (supports(\"pointerevents\")) {\n    return key;\n  } else if (supports(\"touchevents\")) {\n    switch (key) {\n      case \"pointerover\":\n        return \"touchstart\";\n      case \"pointerout\":\n        return \"touchend\";\n      case \"pointerleave\":\n        return \"touchend\";\n      case \"pointerdown\":\n        return \"touchstart\";\n      case \"pointermove\":\n        return \"touchmove\";\n      case \"pointerup\":\n        return \"touchend\";\n      case \"click\":\n        return \"click\";\n      case \"dblclick\":\n        return \"dblclick\";\n    }\n  } else if (supports(\"mouseevents\")) {\n    switch (key) {\n      case \"pointerover\":\n        return \"mouseover\";\n      case \"pointerout\":\n        return \"mouseout\";\n      case \"pointerleave\":\n        return \"mouseleave\";\n      case \"pointerdown\":\n        return \"mousedown\";\n      case \"pointermove\":\n        return \"mousemove\";\n      case \"pointerup\":\n        return \"mouseup\";\n      case \"click\":\n        return \"click\";\n      case \"dblclick\":\n        return \"dblclick\";\n    }\n  }\n  return key;\n}\n/**\r\n * Determines if pointer event originated from a touch pointer or mouse.\r\n *\r\n * @param ev  Original event\r\n * @return Touch pointer?\r\n */\nexport function isTouchEvent(ev) {\n  if (typeof Touch !== \"undefined\" && ev instanceof Touch) {\n    return true;\n  } else if (typeof PointerEvent !== \"undefined\" && ev instanceof PointerEvent && ev.pointerType != null) {\n    switch (ev.pointerType) {\n      case \"touch\":\n      case \"pen\":\n      case 2:\n        return true;\n      case \"mouse\":\n      case 4:\n        return false;\n      default:\n        return !(ev instanceof MouseEvent);\n    }\n  } else if (ev.type != null) {\n    if (ev.type.match(/^mouse/)) {\n      return false;\n    }\n  }\n  return true;\n}\n/**\r\n * Sets style property on DOM element.\r\n *\r\n * @ignore Exclude from docs\r\n */\nexport function setStyle(dom, property, value) {\n  dom.style[property] = value;\n}\nexport function getStyle(dom, property) {\n  return dom.style[property];\n}\n/**\r\n * Gets the target of the event, works for shadow DOM too.\r\n */\nexport function getEventTarget(event) {\n  if (event.composedPath) {\n    const path = event.composedPath();\n    if (path.length === 0) {\n      return null;\n    } else {\n      return path[0];\n    }\n  } else {\n    return event.target;\n  }\n}\n/**\r\n * Checks of element `a` contains element `b`.\r\n *\r\n * @param a  Aleged ascendant\r\n * @param b  Aleged descendant\r\n * @return Contains?\r\n */\nexport function contains(a, b) {\n  let cursor = b;\n  while (true) {\n    if (a === cursor) {\n      return true;\n    } else if (cursor.parentNode === null) {\n      // TODO better ShadowRoot detection\n      if (cursor.host == null) {\n        return false;\n      } else {\n        cursor = cursor.host;\n      }\n    } else {\n      cursor = cursor.parentNode;\n    }\n  }\n}\n/**\r\n * Returns `true` if pointer event originated on an element within Root.\r\n *\r\n * @since 5.2.8\r\n * @param  event   Event\r\n * @param  target  Target element\r\n */\nexport function isLocalEvent(event, target) {\n  return event.target && contains(target.root.dom, event.target);\n}\n/**\r\n * Disables or enables interactivity of a DOM element.\r\n *\r\n * @param  target       Target element\r\n * @param  interactive  Interactive?\r\n */\nexport function setInteractive(target, interactive) {\n  if (interactive) {\n    target.style.pointerEvents = \"auto\";\n  } else {\n    target.style.pointerEvents = \"none\";\n  }\n}\nexport function getEventKey(event) {\n  if (event.key !== undefined) {\n    return event.key;\n  }\n  switch (event.keyCode) {\n    case 9:\n      return \"Tab\";\n    case 13:\n      return \"Enter\";\n    case 16:\n      return \"Shift\";\n    case 17:\n      return \"Control\";\n    case 27:\n      return \"Escape\";\n    case 32:\n      return \" \";\n    case 37:\n      return \"ArrowLeft\";\n    case 38:\n      return \"ArrowUp\";\n    case 39:\n      return \"ArrowRight\";\n    case 40:\n      return \"ArrowDown\";\n    case 46:\n      return \"Delete\";\n  }\n  return \"\" + event.keyCode;\n}\n/**\r\n * Returns the shadow root of the element or null\r\n *\r\n * @param a  Node\r\n * @return Root\r\n */\nexport function getShadowRoot(a) {\n  let cursor = a;\n  while (true) {\n    if (cursor.parentNode === null) {\n      // TODO better ShadowRoot detection\n      if (cursor.host != null) {\n        return cursor;\n      } else {\n        return null;\n      }\n    } else {\n      cursor = cursor.parentNode;\n    }\n  }\n}\n/**\r\n * [rootStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n */\nlet rootStylesheet;\n/**\r\n * @ignore Exclude from docs\r\n */\nfunction createStylesheet(element, text) {\n  let nonce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n  // TODO use createElementNS ?\n  const e = document.createElement(\"style\");\n  e.type = \"text/css\";\n  if (nonce != \"\") {\n    e.setAttribute(\"nonce\", nonce);\n  }\n  e.textContent = text;\n  if (element === null) {\n    document.head.appendChild(e);\n  } else {\n    element.appendChild(e);\n  }\n  return e;\n}\n/**\r\n * [getStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n * @return [description]\r\n */\nfunction getStylesheet(element) {\n  let nonce = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n  if (element === null) {\n    if (rootStylesheet == null) {\n      // TODO use createElementNS ?\n      const e = document.createElement(\"style\");\n      e.type = \"text/css\";\n      if (nonce != \"\") {\n        e.setAttribute(\"nonce\", nonce);\n      }\n      document.head.appendChild(e);\n      rootStylesheet = e.sheet;\n    }\n    return rootStylesheet;\n  } else {\n    // TODO use createElementNS ?\n    const e = document.createElement(\"style\");\n    e.type = \"text/css\";\n    if (nonce != \"\") {\n      e.setAttribute(\"nonce\", nonce);\n    }\n    element.appendChild(e);\n    return e.sheet;\n  }\n}\n/**\r\n * [makeStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n * @param selector  [description]\r\n * @return [description]\r\n */\nfunction appendStylesheet(root, selector) {\n  const index = root.cssRules.length;\n  root.insertRule(selector + \"{}\", index);\n  return root.cssRules[index];\n}\n/**\r\n * Defines a class for a CSS rule.\r\n *\r\n * Can be used to dynamically add CSS to the document.\r\n */\nexport class StyleRule extends DisposerClass {\n  /**\r\n   * Constructor.\r\n   *\r\n   * @param selector  CSS selector\r\n   * @param styles    An object of style attribute - value pairs\r\n   */\n  constructor(element, selector, styles) {\n    let nonce = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : \"\";\n    super();\n    Object.defineProperty(this, \"_root\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    /**\r\n     * CSS rule.\r\n     */\n    Object.defineProperty(this, \"_rule\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    this._root = getStylesheet(element, nonce);\n    try {\n      this._rule = appendStylesheet(this._root, selector);\n    } catch (err) {\n      // Create an empty rule on failed selectors\n      this._rule = appendStylesheet(this._root, \":not(*)\");\n    }\n    $object.each(styles, (key, value) => {\n      this.setStyle(key, value);\n    });\n  }\n  /**\r\n   * A CSS selector text.\r\n   *\r\n   * E.g.: `.myClass p`\r\n   *\r\n   * @param selector  CSS selector\r\n   */\n  set selector(selector) {\n    this._rule.selectorText = selector;\n  }\n  /**\r\n   * @return CSS selector\r\n   */\n  get selector() {\n    return this._rule.selectorText;\n  }\n  // TODO test this\n  _dispose() {\n    // TODO a bit hacky\n    const index = $array.indexOf(this._root.cssRules, this._rule);\n    if (index === -1) {\n      throw new Error(\"Could not dispose StyleRule\");\n    } else {\n      // TODO if it's empty remove it from the DOM ?\n      this._root.deleteRule(index);\n    }\n  }\n  /**\r\n   * Sets the same style properties with browser-specific prefixes.\r\n   *\r\n   * @param name   Attribute name\r\n   * @param value  Attribute value\r\n   */\n  _setVendorPrefixName(name, value) {\n    const style = this._rule.style;\n    style.setProperty(\"-webkit-\" + name, value, \"\");\n    style.setProperty(\"-moz-\" + name, value, \"\");\n    style.setProperty(\"-ms-\" + name, value, \"\");\n    style.setProperty(\"-o-\" + name, value, \"\");\n    style.setProperty(name, value, \"\");\n  }\n  /**\r\n   * Sets a value for specific style attribute.\r\n   *\r\n   * @param name   Attribute\r\n   * @param value  Value\r\n   */\n  setStyle(name, value) {\n    if (name === \"transition\") {\n      this._setVendorPrefixName(name, value);\n    } else {\n      this._rule.style.setProperty(name, value, \"\");\n    }\n  }\n}\n/**\r\n * Defines a class for an entire CSS style sheet.\r\n *\r\n * Can be used to dynamically add CSS to the document.\r\n */\nexport class StyleSheet extends DisposerClass {\n  /**\r\n   * Constructor.\r\n   *\r\n   * @param text  CSS stylesheet\r\n   */\n  constructor(element, text) {\n    let nonce = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n    super();\n    Object.defineProperty(this, \"_element\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    this._element = createStylesheet(element, text, nonce);\n  }\n  _dispose() {\n    if (this._element.parentNode) {\n      this._element.parentNode.removeChild(this._element);\n    }\n  }\n}\n/**\r\n * Adds a class name to an HTML or SVG element.\r\n *\r\n * @ignore Exclude from docs\r\n * @param element    Element\r\n * @param className  Class name to add\r\n */\nexport function addClass(element, className) {\n  if (!element) {\n    return;\n  }\n  if (element.classList) {\n    const classes = className.split(\" \");\n    $array.each(classes, name => {\n      element.classList.add(name);\n    });\n  } else {\n    let currentClassName = element.getAttribute(\"class\");\n    if (currentClassName) {\n      element.setAttribute(\"class\", currentClassName.split(\" \").filter(item => {\n        return item !== className;\n      }).join(\" \") + \" \" + className);\n    } else {\n      element.setAttribute(\"class\", className);\n    }\n  }\n}\n/**\r\n * Removes a class name from an HTML or SVG element.\r\n *\r\n * @ignore Exclude from docs\r\n * @param element    Element\r\n * @param className  Class name to add\r\n */\nexport function removeClass(element, className) {\n  if (!element) {\n    return;\n  }\n  if (element.classList) {\n    element.classList.remove(className);\n  } else {\n    let currentClassName = element.getAttribute(\"class\");\n    if (currentClassName) {\n      element.setAttribute(\"class\", currentClassName.split(\" \").filter(item => {\n        return item !== className;\n      }).join(\" \"));\n    }\n  }\n}\n// /**\n//  * Applies a set of styles to an element. Stores the original styles so they\n//  * can be restored later.\n//  *\n//  * @ignore\n//  * @param io      Element\n//   */\n// export function prepElementForDrag(dom: HTMLElement): void {\n// \t// @todo: save current values\n// \t// Define possible props\n// \tlet props = [\n// \t\t\"touchAction\", \"webkitTouchAction\", \"MozTouchAction\", \"MSTouchAction\", \"msTouchAction\", \"oTouchAction\",\n// \t\t\"userSelect\", \"webkitUserSelect\", \"MozUserSelect\", \"MSUserSelect\", \"msUserSelect\", \"oUserSelect\",\n// \t\t\"touchSelect\", \"webkitTouchSelect\", \"MozTouchSelect\", \"MSTouchSelect\", \"msTouchSelect\", \"oTouchSelect\",\n// \t\t\"touchCallout\", \"webkitTouchCallout\", \"MozTouchCallout\", \"MSTouchCallout\", \"msTouchCallout\", \"oTouchCallout\",\n// \t\t\"contentZooming\", \"webkitContentZooming\", \"MozContentZooming\", \"MSContentZooming\", \"msContentZooming\", \"oContentZooming\",\n// \t\t\"userDrag\", \"webkitUserDrag\", \"MozUserDrag\", \"MSUserDrag\", \"msUserDrag\", \"oUserDrag\"\n// \t];\n// \tfor (let i = 0; i < props.length; i++) {\n// \t\tif (props[i] in dom.style) {\n// \t\t\tsetStyle(dom, props[i], \"none\");\n// \t\t}\n// \t}\n// \t// Remove iOS-specific selection;\n// \tsetStyle(dom, \"tapHighlightColor\", \"rgba(0, 0, 0, 0)\");\n// }\n// /**\n//  * Restores replaced styles\n//  *\n//  * @ignore\n//  * @param  io  Element\n//  */\n// export function unprepElementForDrag(dom: HTMLElement): void {\n// \t// Define possible props\n// \tlet props = [\n// \t\t\"touchAction\", \"webkitTouchAction\", \"MozTouchAction\", \"MSTouchAction\", \"msTouchAction\", \"oTouchAction\",\n// \t\t\"userSelect\", \"webkitUserSelect\", \"MozUserSelect\", \"MSUserSelect\", \"msUserSelect\", \"oUserSelect\",\n// \t\t\"touchSelect\", \"webkitTouchSelect\", \"MozTouchSelect\", \"MSTouchSelect\", \"msTouchSelect\", \"oTouchSelect\",\n// \t\t\"touchCallout\", \"webkitTouchCallout\", \"MozTouchCallout\", \"MSTouchCallout\", \"msTouchCallout\", \"oTouchCallout\",\n// \t\t\"contentZooming\", \"webkitContentZooming\", \"MozContentZooming\", \"MSContentZooming\", \"msContentZooming\", \"oContentZooming\",\n// \t\t\"userDrag\", \"webkitUserDrag\", \"MozUserDrag\", \"MSUserDrag\", \"msUserDrag\", \"oUserDrag\"\n// \t];\n// \tfor (let i = 0; i < props.length; i++) {\n// \t\tif (props[i] in dom.style) {\n// \t\t\tsetStyle(dom, props[i], \"\");\n// \t\t}\n// \t}\n// \t// Remove iOS-specific selection;\n// \tsetStyle(dom, \"tapHighlightColor\", \"\");\n// }\nexport function iOS() {\n  return /apple/i.test(navigator.vendor) && \"ontouchend\" in document;\n}\nexport function getSafeResolution() {\n  return iOS() ? 1 : undefined;\n}\nexport function relativeToValue(percent, full) {\n  if ($type.isNumber(percent)) {\n    return percent;\n  } else if (percent != null && $type.isNumber(percent.value) && $type.isNumber(full)) {\n    return full * percent.value;\n  } else {\n    return 0;\n  }\n}\n/**\r\n * Returns number of decimals\r\n *\r\n * @ignore Exclude from docs\r\n * @param number  Input number\r\n * @return Number of decimals\r\n */\nexport function decimalPlaces(number) {\n  let match = ('' + number).match(/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/);\n  if (!match) {\n    return 0;\n  }\n  return Math.max(0, (match[1] ? match[1].length : 0) - (match[2] ? +match[2] : 0));\n}\n/**\r\n * ============================================================================\r\n * STRING FORMATTING FUNCTIONS\r\n * ============================================================================\r\n * @hidden\r\n */\n/**\r\n * Pads a string with additional characters to certain length.\r\n *\r\n * @param value  A numeric value\r\n * @param len    Result string length in characters\r\n * @param char   A character to use for padding\r\n * @return Padded value as string\r\n */\nexport function padString(value) {\n  let len = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  let char = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"0\";\n  if (typeof value !== \"string\") {\n    value = value.toString();\n  }\n  return len > value.length ? Array(len - value.length + 1).join(char) + value : value;\n}\nexport function trimLeft(text) {\n  return text.replace(/^[\\s]*/, \"\");\n}\nexport function trimRight(text) {\n  return text.replace(/[\\s]*$/, \"\");\n}\nexport function trim(text) {\n  return trimLeft(trimRight(text));\n}\nexport function truncateTextWithEllipsis(text, maxLength) {\n  let breakWords = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  let ellipsis = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : \"...\";\n  if (text.length > maxLength) {\n    // Find the last non-alphanumeric character before maxLength\n    let lastNonAlphanumericIndex = maxLength - 1;\n    while (lastNonAlphanumericIndex >= 0 && text.charAt(lastNonAlphanumericIndex).match(/\\w/)) {\n      lastNonAlphanumericIndex--;\n    }\n    if (lastNonAlphanumericIndex >= 0 && breakWords == false) {\n      return text.substring(0, lastNonAlphanumericIndex + 1) + '...';\n    } else {\n      // If no non-alphanumeric character found, truncate without breaking words\n      return text.substring(0, maxLength) + ellipsis;\n    }\n  } else {\n    return text;\n  }\n}\n/**\r\n * Tries to determine format type.\r\n *\r\n * @ignore Exclude from docs\r\n * @param format  Format string\r\n * @return Format type (\"string\" | \"number\" | \"date\" | \"duration\")\r\n */\nexport function getFormat(format) {\n  // Undefined?\n  if (typeof format === \"undefined\") {\n    return \"string\";\n  }\n  // Cleanup and lowercase format\n  format = format.toLowerCase().replace(/^\\[[^\\]]*\\]/, \"\");\n  // Remove style tags\n  format = format.replace(/\\[[^\\]]+\\]/, \"\");\n  // Trim\n  format = format.trim();\n  // Check for any explicit format hints (i.e. /Date)\n  let hints = format.match(/\\/(date|number|duration)$/);\n  if (hints) {\n    return hints[1];\n  }\n  // Check for explicit hints\n  if (format === \"number\") {\n    return \"number\";\n  }\n  if (format === \"date\") {\n    return \"date\";\n  }\n  if (format === \"duration\") {\n    return \"duration\";\n  }\n  // Detect number formatting symbols\n  if (format.match(/[#0]/)) {\n    return \"number\";\n  }\n  // Detect date formatting symbols\n  if (format.match(/[ymwdhnsqaxkzgtei]/)) {\n    return \"date\";\n  }\n  // Nothing? Let's display as string\n  return \"string\";\n}\n/**\r\n * Cleans up format:\r\n * * Strips out formatter hints\r\n *\r\n * @ignore Exclude from docs\r\n * @param format  Format\r\n * @return Cleaned format\r\n */\nexport function cleanFormat(format) {\n  return format.replace(/\\/(date|number|duration)$/i, \"\");\n}\n/**\r\n * Strips all tags from the string.\r\n *\r\n * @param text  Source string\r\n * @return String without tags\r\n */\nexport function stripTags(text) {\n  return text ? text.replace(/<[^>]*>/g, \"\") : text;\n}\n/**\r\n * Removes new lines and tags from a string.\r\n *\r\n * @param text  String to conver\r\n * @return Converted string\r\n */\nexport function plainText(text) {\n  return text ? stripTags((\"\" + text).replace(/[\\n\\r]+/g, \". \")) : text;\n}\n/**\r\n * Escapes string so it can safely be used in a Regex.\r\n *\r\n * @param value  Unsescaped string\r\n * @return Escaped string\r\n */\nexport function escapeForRgex(value) {\n  return value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n}\n/**\r\n * Adds space before each uppercase letter.\r\n *\r\n * @param   str Input string\r\n * @return      Output string\r\n */\nexport function addSpacing(str) {\n  let result = \"\";\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charAt(i);\n    if (char.toUpperCase() == char && i != 0) {\n      result += \" \";\n    }\n    result += char;\n  }\n  return result;\n}\n/**\r\n * Splits the string into separate characters. Keeps RTL words non-split.\r\n *\r\n * @param   source  Input\r\n * @return          Split text\r\n */\nexport function splitString(source) {\n  // Regular expression to identify RTL characters\n  const rtlChar = /[\\u0590-\\u05FF\\u0600-\\u06FF\\u0750-\\u077F\\u08A0-\\u08FF\\uFB50-\\uFDFF\\uFE70-\\uFEFF]/;\n  // Regular expression to capture segments ending with specific Arabic characters\n  const splitPattern = /([^اأدذرزو]*[اأدذرزو])/gi;\n  // Split input string into array of words or characters, including whitespace\n  let segments = source.split(/(\\s+)/); // Split by whitespace, capturing it\n  let result = [];\n  segments.forEach(segment => {\n    if (segment.match(/^\\s+$/)) {\n      // If the segment is purely whitespace\n      if (segment = \" \") {\n        segment = \"  \";\n      }\n      result.push(segment);\n    } else if (rtlChar.test(segment)) {\n      // If the segment contains RTL characters, handle special splits\n      let parts = segment.split(splitPattern).filter(part => part !== '');\n      // Concatenate parts processed by the split pattern directly to result\n      result = result.concat(parts);\n    } else {\n      // Treat this segment as LTR: split into characters\n      result = result.concat([...segment]);\n    }\n  });\n  return result;\n}\n/**\r\n * ============================================================================\r\n * DATE-RELATED FUNCTIONS\r\n * ============================================================================\r\n * @hidden\r\n */\n/**\r\n * Returns a year day.\r\n *\r\n * @param date  Date\r\n * @param utc   Assume UTC dates?\r\n * @return Year day\r\n * @todo Account for UTC\r\n */\nexport function getYearDay(date) {\n  let utc = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  // TODO: utc needed?\n  utc;\n  const start = new Date(date.getFullYear(), 0, 0);\n  const diff = date.getTime() - start.getTime() + (start.getTimezoneOffset() - date.getTimezoneOffset()) * 60 * 1000;\n  const oneDay = 1000 * 60 * 60 * 24;\n  return Math.floor(diff / oneDay);\n}\n/**\r\n * Returns week number for a given date.\r\n *\r\n * @param date  Date\r\n * @param utc   Assume UTC dates?\r\n * @return Week number\r\n * @todo Account for UTC\r\n */\nexport function getWeek(date) {\n  let _utc = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n  const day = d.getUTCDay() || 7;\n  d.setUTCDate(d.getUTCDate() + 4 - day);\n  const firstDay = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\n  return Math.ceil(((d.getTime() - firstDay.getTime()) / 86400000 + 1) / 7);\n}\n/**\r\n * Returns a \"week year\" of the given date.\r\n *\r\n * @param date  Date\r\n * @param utc   Assume UTC dates?\r\n * @return Year of week\r\n * @since 5.3.0\r\n * @todo Account for UTC\r\n */\nexport function getWeekYear(date) {\n  let _utc = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n  const day = d.getUTCDay() || 7;\n  d.setUTCDate(d.getUTCDate() + 4 - day);\n  const firstDay = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\n  return firstDay.getFullYear();\n}\n/**\r\n * Returns a week number in the month.\r\n *\r\n * @param date  Source Date\r\n * @param utc   Assume UTC dates?\r\n * @return Week number in month\r\n */\nexport function getMonthWeek(date) {\n  let utc = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  const firstWeek = getWeek(new Date(date.getFullYear(), date.getMonth(), 1), utc);\n  let currentWeek = getWeek(date, utc);\n  if (currentWeek == 1) {\n    currentWeek = 53;\n  }\n  return currentWeek - firstWeek + 1;\n}\n/**\r\n * Returns a year day out of the given week number.\r\n *\r\n * @param week     Week\r\n * @param year     Year\r\n * @param weekday  Weekday\r\n * @param utc      Assume UTC dates\r\n * @return Day in a year\r\n */\nexport function getDayFromWeek(week, year) {\n  let weekday = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  let utc = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  let date = new Date(year, 0, 4, 0, 0, 0, 0);\n  if (utc) {\n    date.setUTCFullYear(year);\n  }\n  let day = week * 7 + weekday - ((date.getDay() || 7) + 3);\n  return day;\n}\n/**\r\n * Returns 12-hour representation out of the 24-hour hours.\r\n *\r\n * @param hours  24-hour number\r\n * @return 12-hour number\r\n */\nexport function get12Hours(hours, base) {\n  if (hours > 12) {\n    hours -= 12;\n  } else if (hours === 0) {\n    hours = 12;\n  }\n  return base != null ? hours + (base - 1) : hours;\n}\n/**\r\n * Returns a string name of the time zone.\r\n *\r\n * @param date     Date object\r\n * @param long     Should return long (\"Pacific Standard Time\") or short abbreviation (\"PST\")\r\n * @param savings  Include information if it's in daylight savings mode\r\n * @param utc      Assume UTC dates\r\n * @return Time zone name\r\n */\nexport function getTimeZone(date) {\n  let long = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  let savings = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  let utc = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  let timezone = arguments.length > 4 ? arguments[4] : undefined;\n  if (utc) {\n    return long ? \"Coordinated Universal Time\" : \"UTC\";\n  } else if (timezone) {\n    const d1 = date.toLocaleString(\"en-US\", {\n      timeZone: timezone\n    });\n    const d2 = date.toLocaleString(\"en-US\", {\n      timeZone: timezone,\n      timeZoneName: long ? \"long\" : \"short\"\n    });\n    return trim(d2.substr(d1.length));\n  }\n  let wotz = date.toLocaleString(\"UTC\");\n  let wtz = date.toLocaleString(\"UTC\", {\n    timeZoneName: long ? \"long\" : \"short\"\n  }).substr(wotz.length);\n  //wtz = wtz.replace(/[+-]+[0-9]+$/, \"\");\n  if (savings === false) {\n    wtz = wtz.replace(/ (standard|daylight|summer|winter) /i, \" \");\n  }\n  return trim(wtz);\n}\nexport function getTimezoneOffset(timezone) {\n  const date = new Date(Date.UTC(2012, 0, 1, 0, 0, 0, 0));\n  const utcDate = new Date(date.toLocaleString(\"en-US\", {\n    timeZone: \"UTC\"\n  }));\n  const tzDate = new Date(date.toLocaleString(\"en-US\", {\n    timeZone: timezone\n  }));\n  return (tzDate.getTime() - utcDate.getTime()) / 6e4 * -1;\n}\nexport function capitalizeFirst(text) {\n  return text.charAt(0).toUpperCase() + text.slice(1);\n}\n/**\r\n * The functions below are taken and adapted from Garry Tan's blog post:\r\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\r\n *\r\n * The further attributions go mjijackson.com, which now seems to be defunct.\r\n */\n/**\r\n * Converts an HSL color value to RGB. Conversion formula\r\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\r\n * Assumes h, s, and l are contained in the set [0, 1] and\r\n * returns r, g, and b in the set [0, 255].\r\n *\r\n * Function adapted from:\r\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\r\n *\r\n * @param h       The hue\r\n * @param s       The saturation\r\n * @param l       The lightness\r\n * @return The RGB representation\r\n */\nexport function hslToRgb(color) {\n  let r, g, b;\n  let h = color.h;\n  let s = color.s;\n  let l = color.l;\n  if (s == 0) {\n    r = g = b = l; // achromatic\n  } else {\n    let hue2rgb = function hue2rgb(p, q, t) {\n      if (t < 0) {\n        t += 1;\n      }\n      if (t > 1) {\n        t -= 1;\n      }\n      if (t < 1 / 6) {\n        return p + (q - p) * 6 * t;\n      }\n      if (t < 1 / 2) {\n        return q;\n      }\n      if (t < 2 / 3) {\n        return p + (q - p) * (2 / 3 - t) * 6;\n      }\n      return p;\n    };\n    let q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    let p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n  return {\n    r: Math.round(r * 255),\n    g: Math.round(g * 255),\n    b: Math.round(b * 255)\n  };\n}\n/**\r\n * Converts an RGB color value to HSL. Conversion formula\r\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\r\n * Assumes r, g, and b are contained in the set [0, 255] and\r\n * returns h, s, and l in the set [0, 1].\r\n *\r\n * Function adapted from:\r\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\r\n *\r\n * @param r       The red color value\r\n * @param g       The green color value\r\n * @param b       The blue color value\r\n * @return The HSL representation\r\n */\nexport function rgbToHsl(color) {\n  let r = color.r / 255;\n  let g = color.g / 255;\n  let b = color.b / 255;\n  let max = Math.max(r, g, b);\n  let min = Math.min(r, g, b);\n  let h = 0;\n  let s = 0;\n  let l = (max + min) / 2;\n  if (max === min) {\n    h = s = 0; // achromatic\n  } else {\n    let d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n  return {\n    h: h,\n    s: s,\n    l: l\n  };\n}\n/**\r\n * Converts HSV to HSL.\r\n *\r\n * https://en.wikipedia.org/wiki/HSL_and_HSV#HSV_to_HSL\r\n */\nexport function hsvToHsl(hsv) {\n  const l = hsv.v * (1 - hsv.s / 2);\n  const s = l === 0 || l === 1 ? 0 : (hsv.v - l) / Math.min(l, 1 - l);\n  return {\n    h: hsv.h,\n    s,\n    l,\n    a: hsv.a\n  };\n}\n/**\r\n * Converts HSL to HSV.\r\n *\r\n * https://en.wikipedia.org/wiki/HSL_and_HSV#HSL_to_HSV\r\n */\nexport function hslToHsv(hsl) {\n  const v = hsl.l + hsl.s * Math.min(hsl.l, 1 - hsl.l);\n  const s = v === 0 ? 0 : 2 * (1 - hsl.l / v);\n  return {\n    h: hsl.h,\n    s,\n    v,\n    a: hsl.a\n  };\n}\n/**\r\n * Returns a color that is `percent` brighter than the reference color.\r\n *\r\n * @param color    Reference color\r\n * @param percent  Brightness percent\r\n * @return Hex code of the new color\r\n */\nexport function lighten(rgb, percent) {\n  if (rgb) {\n    return {\n      r: Math.max(0, Math.min(255, rgb.r + getLightnessStep(rgb.r, percent))),\n      g: Math.max(0, Math.min(255, rgb.g + getLightnessStep(rgb.g, percent))),\n      b: Math.max(0, Math.min(255, rgb.b + getLightnessStep(rgb.b, percent))),\n      a: rgb.a\n    };\n  } else {\n    // TODO is this correct ?\n    return rgb;\n  }\n}\n;\n/**\r\n * Gets lightness step.\r\n *\r\n * @param value    Value\r\n * @param percent  Percent\r\n * @return Step\r\n */\nexport function getLightnessStep(value, percent) {\n  let base = percent > 0 ? 255 - value : value;\n  return Math.round(base * percent);\n}\n/**\r\n * Returns a color that is `percent` brighter than the source `color`.\r\n *\r\n * @param color    Source color\r\n * @param percent  Brightness percent\r\n * @return New color\r\n */\nexport function brighten(rgb, percent) {\n  if (rgb) {\n    let base = Math.min(Math.max(rgb.r, rgb.g, rgb.b), 230);\n    //let base = Math.max(rgb.r, rgb.g, rgb.b);\n    let step = getLightnessStep(base, percent);\n    return {\n      r: Math.max(0, Math.min(255, Math.round(rgb.r + step))),\n      g: Math.max(0, Math.min(255, Math.round(rgb.g + step))),\n      b: Math.max(0, Math.min(255, Math.round(rgb.b + step))),\n      a: rgb.a\n    };\n  } else {\n    // TODO is this correct ?\n    return rgb;\n  }\n}\n;\n/**\r\n * Returns brightness step.\r\n *\r\n * @ignore Exclude from docs\r\n * @param value    Value\r\n * @param percent  Percent\r\n * @return Step\r\n */\nexport function getBrightnessStep(_value, percent) {\n  let base = 255; //percent > 0 ? 255 - value : value;\n  return Math.round(base * percent);\n}\n/**\r\n * Returns `true` if color is \"light\". Useful indetermining which contrasting\r\n * color to use for elements over this color. E.g.: you would want to use\r\n * black text over light background, and vice versa.\r\n *\r\n * @param color  Source color\r\n * @return Light?\r\n */\nexport function isLight(color) {\n  return (color.r * 299 + color.g * 587 + color.b * 114) / 1000 >= 128;\n}\n/**\r\n * Returns a new [[iRGB]] object based on `rgb` parameter with specific\r\n * saturation applied.\r\n *\r\n * `saturation` can be in the range of 0 (fully desaturated) to 1 (fully\r\n * saturated).\r\n *\r\n * @param color       Base color\r\n * @param saturation  Saturation (0-1)\r\n * @return New color\r\n */\nexport function saturate(rgb, saturation) {\n  if (rgb === undefined || saturation == 1) {\n    return rgb;\n  }\n  let hsl = rgbToHsl(rgb);\n  hsl.s = saturation;\n  return hslToRgb(hsl);\n}\n/**\r\n * Returns a color which contrasts more with the source `color`.\r\n *\r\n * @param  color             Base color\r\n * @param  lightAlternative  Light option\r\n * @param  darkAlternative   Dark option\r\n * @return New color\r\n */\nexport function alternativeColor(color) {\n  let lightAlternative = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n    r: 255,\n    g: 255,\n    b: 255\n  };\n  let darkAlternative = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n    r: 255,\n    g: 255,\n    b: 255\n  };\n  let light = lightAlternative;\n  let dark = darkAlternative;\n  if (isLight(darkAlternative)) {\n    light = darkAlternative;\n    dark = lightAlternative;\n  }\n  return isLight(color) ? dark : light;\n}\n/**\r\n * @ignore\r\n */\nexport function mergeTags(tags1, tags2) {\n  if (!tags1) {\n    tags1 = [];\n  }\n  return [...tags1, ...tags2].filter((value, index, self) => {\n    return self.indexOf(value) === index;\n  });\n}\n/**\r\n * @ignore\r\n */\nexport function sameBounds(a, b) {\n  if (!b) {\n    return false;\n  }\n  if (a.left != b.left) {\n    return false;\n  }\n  if (a.right != b.right) {\n    return false;\n  }\n  if (a.top != b.top) {\n    return false;\n  }\n  if (a.bottom != b.bottom) {\n    return false;\n  }\n  return true;\n}","map":{"version":3,"names":["$type","$array","$object","Disposer","DisposerClass","ready","f","document","readyState","listener","removeEventListener","addEventListener","removeElement","el","parentNode","removeChild","dom","type","options","onZoom","window","_ev","supports","cap","hasOwnProperty","getPointerId","event","id","pointerId","blur","activeElement","body","input","createElement","style","position","top","left","appendChild","focus","getRendererEvent","key","isTouchEvent","ev","Touch","PointerEvent","pointerType","MouseEvent","match","setStyle","property","value","getStyle","getEventTarget","composedPath","path","length","target","contains","a","b","cursor","host","isLocalEvent","root","setInteractive","interactive","pointerEvents","getEventKey","undefined","keyCode","getShadowRoot","rootStylesheet","createStylesheet","element","text","nonce","arguments","e","setAttribute","textContent","head","getStylesheet","sheet","appendStylesheet","selector","index","cssRules","insertRule","StyleRule","constructor","styles","Object","defineProperty","_root","_rule","err","each","selectorText","_dispose","indexOf","Error","deleteRule","_setVendorPrefixName","name","setProperty","StyleSheet","_element","addClass","className","classList","classes","split","add","currentClassName","getAttribute","filter","item","join","removeClass","remove","iOS","test","navigator","vendor","getSafeResolution","relativeToValue","percent","full","isNumber","decimalPlaces","number","Math","max","padString","len","char","toString","Array","trimLeft","replace","trimRight","trim","truncateTextWithEllipsis","maxLength","breakWords","ellipsis","lastNonAlphanumericIndex","charAt","substring","getFormat","format","toLowerCase","hints","cleanFormat","stripTags","plainText","escapeForRgex","addSpacing","str","result","i","toUpperCase","splitString","source","rtlChar","splitPattern","segments","forEach","segment","push","parts","part","concat","getYearDay","date","utc","start","Date","getFullYear","diff","getTime","getTimezoneOffset","oneDay","floor","getWeek","_utc","d","UTC","getMonth","getDate","day","getUTCDay","setUTCDate","getUTCDate","firstDay","getUTCFullYear","ceil","getWeekYear","getMonthWeek","firstWeek","currentWeek","getDayFromWeek","week","year","weekday","setUTCFullYear","getDay","get12Hours","hours","base","getTimeZone","long","savings","timezone","d1","toLocaleString","timeZone","d2","timeZoneName","substr","wotz","wtz","utcDate","tzDate","capitalizeFirst","slice","hslToRgb","color","r","g","h","s","l","hue2rgb","p","q","t","round","rgbToHsl","min","hsvToHsl","hsv","v","hslToHsv","hsl","lighten","rgb","getLightnessStep","brighten","step","getBrightnessStep","_value","isLight","saturate","saturation","alternativeColor","lightAlternative","darkAlternative","light","dark","mergeTags","tags1","tags2","self","sameBounds","right","bottom"],"sources":["C:\\Users\\Moham\\Downloads\\Github projects\\Digital-Portfolio-main\\Frontend\\node_modules\\src\\.internal\\core\\util\\Utils.ts"],"sourcesContent":["import type { Percent } from \"./Percent\";\nimport type { IPointerEvent } from \"../render/backend/Renderer\";\nimport type { Sprite } from \"../render/Sprite\";\n\nimport * as $type from \"./Type\";\nimport * as $array from \"./Array\";\nimport * as $object from \"./Object\";\nimport type { IBounds } from \"./IBounds\";\n\nimport { Disposer, DisposerClass, IDisposer } from \"./Disposer\";\n\n/**\n * ============================================================================\n * DOM FUNCTIONS\n * ============================================================================\n * @hidden\n */\n\n/**\n * Execute a function when DOM is ready.\n *\n * @since 5.0.2\n * @param  f  Callback\n */\nexport function ready(f: () => void): void {\n\tif (document.readyState !== \"loading\") {\n\t\tf();\n\n\t} else {\n\t\tconst listener = () => {\n\t\t\tif (document.readyState !== \"loading\") {\n\t\t\t\tdocument.removeEventListener(\"readystatechange\", listener);\n\t\t\t\tf();\n\t\t\t}\n\t\t};\n\n\t\tdocument.addEventListener(\"readystatechange\", listener);\n\t}\n}\n\n/**\n * Removes a DOM element.\n * @param  el  Target element\n */\nexport function removeElement(el: HTMLElement): void {\n\tif (el.parentNode) {\n\t\tel.parentNode.removeChild(el);\n\t}\n}\n\n/**\n * Function that adds a disposable event listener directly to a DOM element.\n *\n * @ignore Exclude from docs\n * @param dom       A DOM element to add event to\n * @param type      Event type\n * @param listener  Event listener\n * @returns Disposable event\n */\nexport function addEventListener<E extends Event>(dom: EventTarget, type: string, listener: (event: E) => void, options?: any): IDisposer {\n\t//@todo proper type check for options: EventListenerOptions | boolean (TS for some reason gives error on passive parameter)\n\tdom.addEventListener(type, <EventListener>listener, options || false);\n\n\treturn new Disposer(() => {\n\t\tdom.removeEventListener(type, <EventListener>listener, options || false);\n\t});\n}\n\n/**\n * Function that adds an event listener which is triggered when the browser's zoom changes.\n *\n * @param listener  Event listener\n * @returns Disposable event\n */\nexport function onZoom(listener: () => void): IDisposer {\n\t// TODO use matchMedia instead ?\n\treturn addEventListener(window, \"resize\", (_ev) => {\n\t\tlistener();\n\t});\n}\n\n/**\n * @ignore\n */\nexport function supports(cap: \"touchevents\" | \"pointerevents\" | \"mouseevents\" | \"wheelevents\" | \"keyboardevents\"): boolean {\n\tswitch (cap) {\n\t\tcase \"touchevents\":\n\t\t\t//return \"ontouchstart\" in document.documentElement;\n\t\t\treturn window.hasOwnProperty(\"TouchEvent\");\n\n\t\tcase \"pointerevents\":\n\t\t\treturn window.hasOwnProperty(\"PointerEvent\");\n\n\t\tcase \"mouseevents\":\n\t\t\treturn window.hasOwnProperty(\"MouseEvent\");\n\n\t\tcase \"wheelevents\":\n\t\t\treturn window.hasOwnProperty(\"WheelEvent\");\n\n\t\tcase \"keyboardevents\":\n\t\t\treturn window.hasOwnProperty(\"KeyboardEvent\");\n\t}\n\treturn false;\n}\n\n/**\n * @ignore\n */\nexport function getPointerId(event: IPointerEvent) {\n\tlet id = (<any>event).pointerId || 0;\n\treturn id;\n}\n\n/**\n * Removes focus from any element by shifting focus to body.\n *\n * @ignore\n */\nexport function blur(): void {\n\tif (document.activeElement && document.activeElement != document.body) {\n\t\tif ((<any>document.activeElement).blur) {\n\t\t\t(<any>document.activeElement).blur();\n\t\t}\n\t\telse {\n\t\t\tlet input = document.createElement(\"button\");\n\t\t\tinput.style.position = \"fixed\";\n\t\t\tinput.style.top = \"0px\";\n\t\t\tinput.style.left = \"-10000px\";\n\t\t\tdocument.body.appendChild(input);\n\t\t\tinput.focus();\n\t\t\tinput.blur();\n\t\t\tdocument.body.removeChild(input);\n\t\t}\n\t}\n}\n\n/**\n * Focuses element.\n *\n * @ignore\n */\nexport function focus(el: HTMLElement): void {\n\tif (el) {\n\t\tel.focus();\n\t}\n}\n\n/**\n * @ignore\n */\nexport function getRendererEvent(key: string): string {\n\tif (supports(\"pointerevents\")) {\n\t\treturn key;\n\t}\n\telse if (supports(\"touchevents\")) {\n\t\tswitch (key) {\n\t\t\tcase \"pointerover\": return \"touchstart\";\n\t\t\tcase \"pointerout\": return \"touchend\";\n\t\t\tcase \"pointerleave\": return \"touchend\";\n\t\t\tcase \"pointerdown\": return \"touchstart\";\n\t\t\tcase \"pointermove\": return \"touchmove\";\n\t\t\tcase \"pointerup\": return \"touchend\";\n\t\t\tcase \"click\": return \"click\";\n\t\t\tcase \"dblclick\": return \"dblclick\";\n\n\t\t}\n\t}\n\telse if (supports(\"mouseevents\")) {\n\t\tswitch (key) {\n\t\t\tcase \"pointerover\": return \"mouseover\";\n\t\t\tcase \"pointerout\": return \"mouseout\";\n\t\t\tcase \"pointerleave\": return \"mouseleave\";\n\t\t\tcase \"pointerdown\": return \"mousedown\";\n\t\t\tcase \"pointermove\": return \"mousemove\";\n\t\t\tcase \"pointerup\": return \"mouseup\";\n\t\t\tcase \"click\": return \"click\";\n\t\t\tcase \"dblclick\": return \"dblclick\";\n\n\t\t}\n\t}\n\treturn key;\n}\n\n/**\n * Determines if pointer event originated from a touch pointer or mouse.\n *\n * @param ev  Original event\n * @return Touch pointer?\n */\nexport function isTouchEvent(ev: MouseEvent | Touch): boolean {\n\tif (typeof Touch !== \"undefined\" && ev instanceof Touch) {\n\t\treturn true;\n\t}\n\telse if (typeof PointerEvent !== \"undefined\" && ev instanceof PointerEvent && (<any>ev).pointerType != null) {\n\t\tswitch ((<any>ev).pointerType) {\n\t\t\tcase \"touch\":\n\t\t\tcase \"pen\":\n\t\t\tcase 2:\n\t\t\t\treturn true;\n\t\t\tcase \"mouse\":\n\t\t\tcase 4:\n\t\t\t\treturn false;\n\t\t\tdefault:\n\t\t\t\treturn !(ev instanceof MouseEvent);\n\t\t}\n\t}\n\telse if ((<any>ev).type != null) {\n\t\tif ((<any>ev).type.match(/^mouse/)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\n/**\n * Sets style property on DOM element.\n *\n * @ignore Exclude from docs\n */\nexport function setStyle(dom: HTMLElement, property: string, value: string | undefined): void {\n\t(<any>dom.style)[property] = value;\n}\n\nexport function getStyle(dom: HTMLElement, property: string): string | undefined {\n\treturn (<any>dom.style)[property];\n}\n\n/**\n * Gets the target of the event, works for shadow DOM too.\n */\nexport function getEventTarget(event: Event | Touch): Node | null {\n\tif ((event as any).composedPath) {\n\t\tconst path = (event as Event).composedPath();\n\n\t\tif (path.length === 0) {\n\t\t\treturn null;\n\n\t\t} else {\n\t\t\treturn path[0] as Node;\n\t\t}\n\n\t} else {\n\t\treturn event.target as Node | null;\n\t}\n}\n\n/**\n * Checks of element `a` contains element `b`.\n *\n * @param a  Aleged ascendant\n * @param b  Aleged descendant\n * @return Contains?\n */\nexport function contains(a: Element, b: Element): boolean {\n\tlet cursor: Node = b;\n\n\twhile (true) {\n\t\tif (a === cursor) {\n\t\t\treturn true;\n\n\t\t} else if (cursor.parentNode === null) {\n\t\t\t// TODO better ShadowRoot detection\n\t\t\tif ((<ShadowRoot>cursor).host == null) {\n\t\t\t\treturn false;\n\n\t\t\t} else {\n\t\t\t\tcursor = (<ShadowRoot>cursor).host;\n\t\t\t}\n\n\t\t} else {\n\t\t\tcursor = cursor.parentNode;\n\t\t}\n\t}\n}\n\n/**\n * Returns `true` if pointer event originated on an element within Root.\n *\n * @since 5.2.8\n * @param  event   Event\n * @param  target  Target element\n */\nexport function isLocalEvent(event: IPointerEvent, target: Sprite) {\n\treturn event.target && contains(target.root.dom, <Element>event.target);\n}\n\n/**\n * Disables or enables interactivity of a DOM element.\n *\n * @param  target       Target element\n * @param  interactive  Interactive?\n */\nexport function setInteractive(target: HTMLElement, interactive: boolean): void {\n\tif (interactive) {\n\t\ttarget.style.pointerEvents = \"auto\";\n\t}\n\telse {\n\t\ttarget.style.pointerEvents = \"none\";\n\t}\n}\n\nexport function getEventKey(event: KeyboardEvent): string {\n\tif (event.key !== undefined) {\n\t\treturn event.key;\n\t}\n\tswitch (event.keyCode) {\n\t\tcase 9: return \"Tab\";\n\t\tcase 13: return \"Enter\";\n\t\tcase 16: return \"Shift\";\n\t\tcase 17: return \"Control\";\n\t\tcase 27: return \"Escape\";\n\t\tcase 32: return \" \";\n\t\tcase 37: return \"ArrowLeft\";\n\t\tcase 38: return \"ArrowUp\";\n\t\tcase 39: return \"ArrowRight\";\n\t\tcase 40: return \"ArrowDown\";\n\t\tcase 46: return \"Delete\";\n\t}\n\treturn \"\" + event.keyCode;\n}\n\n/**\n * Returns the shadow root of the element or null\n *\n * @param a  Node\n * @return Root\n */\nexport function getShadowRoot(a: Node): ShadowRoot | null {\n\tlet cursor: Node = a;\n\n\twhile (true) {\n\t\tif (cursor.parentNode === null) {\n\t\t\t// TODO better ShadowRoot detection\n\t\t\tif ((<ShadowRoot>cursor).host != null) {\n\t\t\t\treturn <ShadowRoot>cursor;\n\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t} else {\n\t\t\tcursor = cursor.parentNode;\n\t\t}\n\t}\n}\n\n/**\n * [rootStylesheet description]\n *\n * @ignore Exclude from docs\n * @todo Description\n */\nlet rootStylesheet: $type.Optional<CSSStyleSheet>;\n\n/**\n * @ignore Exclude from docs\n */\nfunction createStylesheet(element: ShadowRoot | null, text: string, nonce: string = \"\"): HTMLStyleElement {\n\t// TODO use createElementNS ?\n\tconst e = document.createElement(\"style\");\n\te.type = \"text/css\";\n\tif (nonce != \"\") {\n\t\te.setAttribute(\"nonce\", nonce)\n\t}\n\te.textContent = text;\n\n\tif (element === null) {\n\t\tdocument.head.appendChild(e);\n\t} else {\n\t\telement.appendChild(e);\n\t}\n\n\treturn e;\n}\n\n/**\n * [getStylesheet description]\n *\n * @ignore Exclude from docs\n * @todo Description\n * @return [description]\n */\nfunction getStylesheet(element: ShadowRoot | null, nonce: string = \"\"): CSSStyleSheet {\n\tif (element === null) {\n\t\tif (rootStylesheet == null) {\n\t\t\t// TODO use createElementNS ?\n\t\t\tconst e = document.createElement(\"style\");\n\t\t\te.type = \"text/css\";\n\t\t\tif (nonce != \"\") {\n\t\t\t\te.setAttribute(\"nonce\", nonce)\n\t\t\t}\n\t\t\tdocument.head.appendChild(e);\n\t\t\trootStylesheet = e.sheet as CSSStyleSheet;\n\t\t}\n\n\t\treturn rootStylesheet;\n\n\t} else {\n\t\t// TODO use createElementNS ?\n\t\tconst e = document.createElement(\"style\");\n\t\te.type = \"text/css\";\n\t\tif (nonce != \"\") {\n\t\t\te.setAttribute(\"nonce\", nonce)\n\t\t}\n\t\telement.appendChild(e);\n\t\treturn e.sheet as CSSStyleSheet;\n\t}\n}\n\n/**\n * [makeStylesheet description]\n *\n * @ignore Exclude from docs\n * @todo Description\n * @param selector  [description]\n * @return [description]\n */\nfunction appendStylesheet(root: CSSStyleSheet, selector: string): CSSStyleRule {\n\tconst index = root.cssRules.length;\n\troot.insertRule(selector + \"{}\", index);\n\n\treturn root.cssRules[index] as CSSStyleRule;\n}\n\n/**\n * Defines a class for a CSS rule.\n *\n * Can be used to dynamically add CSS to the document.\n */\nexport class StyleRule extends DisposerClass {\n\tprivate _root: CSSStyleSheet;\n\n\t/**\n\t * CSS rule.\n\t */\n\tprivate _rule: CSSStyleRule;\n\n\t/**\n\t * A CSS selector text.\n\t *\n\t * E.g.: `.myClass p`\n\t *\n\t * @param selector  CSS selector\n\t */\n\tpublic set selector(selector: string) {\n\t\tthis._rule.selectorText = selector;\n\t}\n\n\t/**\n\t * @return CSS selector\n\t */\n\tpublic get selector(): string {\n\t\treturn this._rule.selectorText;\n\t}\n\n\t/**\n\t * Constructor.\n\t *\n\t * @param selector  CSS selector\n\t * @param styles    An object of style attribute - value pairs\n\t */\n\tconstructor(element: ShadowRoot | null, selector: string, styles: { [name: string]: string }, nonce: string = \"\") {\n\t\tsuper();\n\n\t\tthis._root = getStylesheet(element, nonce);\n\n\t\ttry {\n\t\t\tthis._rule = appendStylesheet(this._root, selector);\n\t\t}\n\t\tcatch (err) {\n\t\t\t// Create an empty rule on failed selectors\n\t\t\tthis._rule = appendStylesheet(this._root, \":not(*)\");\n\t\t}\n\n\t\t$object.each(styles, (key, value) => {\n\t\t\tthis.setStyle(<string>key, value);\n\t\t});\n\t}\n\n\t// TODO test this\n\tprotected _dispose(): void {\n\t\t// TODO a bit hacky\n\t\tconst index = $array.indexOf(this._root.cssRules, this._rule);\n\n\t\tif (index === -1) {\n\t\t\tthrow new Error(\"Could not dispose StyleRule\");\n\n\t\t} else {\n\t\t\t// TODO if it's empty remove it from the DOM ?\n\t\t\tthis._root.deleteRule(index);\n\t\t}\n\t}\n\n\t/**\n\t * Sets the same style properties with browser-specific prefixes.\n\t *\n\t * @param name   Attribute name\n\t * @param value  Attribute value\n\t */\n\tprivate _setVendorPrefixName(name: string, value: string): void {\n\t\tconst style = this._rule.style;\n\t\tstyle.setProperty(\"-webkit-\" + name, value, \"\");\n\t\tstyle.setProperty(\"-moz-\" + name, value, \"\");\n\t\tstyle.setProperty(\"-ms-\" + name, value, \"\");\n\t\tstyle.setProperty(\"-o-\" + name, value, \"\");\n\t\tstyle.setProperty(name, value, \"\");\n\t}\n\n\t/**\n\t * Sets a value for specific style attribute.\n\t *\n\t * @param name   Attribute\n\t * @param value  Value\n\t */\n\tpublic setStyle(name: string, value: string): void {\n\t\tif (name === \"transition\") {\n\t\t\tthis._setVendorPrefixName(name, value);\n\n\t\t} else {\n\t\t\tthis._rule.style.setProperty(name, value, \"\");\n\t\t}\n\t}\n}\n\n/**\n * Defines a class for an entire CSS style sheet.\n *\n * Can be used to dynamically add CSS to the document.\n */\nexport class StyleSheet extends DisposerClass {\n\tprivate _element: HTMLStyleElement;\n\n\t/**\n\t * Constructor.\n\t *\n\t * @param text  CSS stylesheet\n\t */\n\tconstructor(element: ShadowRoot | null, text: string, nonce: string = \"\") {\n\t\tsuper();\n\t\tthis._element = createStylesheet(element, text, nonce);\n\t}\n\n\tprotected _dispose(): void {\n\t\tif (this._element.parentNode) {\n\t\t\tthis._element.parentNode.removeChild(this._element);\n\t\t}\n\t}\n}\n\n\n/**\n * Adds a class name to an HTML or SVG element.\n *\n * @ignore Exclude from docs\n * @param element    Element\n * @param className  Class name to add\n */\nexport function addClass(element: HTMLElement | SVGElement, className: string): void {\n\tif (!element) {\n\t\treturn;\n\t}\n\tif (element.classList) {\n\t\tconst classes = className.split(\" \");\n\t\t$array.each(classes, (name) => {\n\t\t\telement.classList.add(name);\n\t\t});\n\t}\n\telse {\n\t\tlet currentClassName = element.getAttribute(\"class\");\n\t\tif (currentClassName) {\n\t\t\telement.setAttribute(\"class\", currentClassName.split(\" \").filter((item) => {\n\t\t\t\treturn item !== className;\n\t\t\t}).join(\" \") + \" \" + className);\n\t\t}\n\t\telse {\n\t\t\telement.setAttribute(\"class\", className);\n\t\t}\n\t}\n}\n\n/**\n * Removes a class name from an HTML or SVG element.\n *\n * @ignore Exclude from docs\n * @param element    Element\n * @param className  Class name to add\n */\nexport function removeClass(element: HTMLElement, className: string): void {\n\tif (!element) {\n\t\treturn;\n\t}\n\tif (element.classList) {\n\t\telement.classList.remove(className);\n\t}\n\telse {\n\t\tlet currentClassName = element.getAttribute(\"class\");\n\t\tif (currentClassName) {\n\t\t\telement.setAttribute(\"class\", currentClassName.split(\" \").filter((item) => {\n\t\t\t\treturn item !== className;\n\t\t\t}).join(\" \"));\n\t\t}\n\t}\n}\n\n// /**\n//  * Applies a set of styles to an element. Stores the original styles so they\n//  * can be restored later.\n//  *\n//  * @ignore\n//  * @param io      Element\n//   */\n// export function prepElementForDrag(dom: HTMLElement): void {\n\n// \t// @todo: save current values\n\n// \t// Define possible props\n// \tlet props = [\n// \t\t\"touchAction\", \"webkitTouchAction\", \"MozTouchAction\", \"MSTouchAction\", \"msTouchAction\", \"oTouchAction\",\n// \t\t\"userSelect\", \"webkitUserSelect\", \"MozUserSelect\", \"MSUserSelect\", \"msUserSelect\", \"oUserSelect\",\n// \t\t\"touchSelect\", \"webkitTouchSelect\", \"MozTouchSelect\", \"MSTouchSelect\", \"msTouchSelect\", \"oTouchSelect\",\n// \t\t\"touchCallout\", \"webkitTouchCallout\", \"MozTouchCallout\", \"MSTouchCallout\", \"msTouchCallout\", \"oTouchCallout\",\n// \t\t\"contentZooming\", \"webkitContentZooming\", \"MozContentZooming\", \"MSContentZooming\", \"msContentZooming\", \"oContentZooming\",\n// \t\t\"userDrag\", \"webkitUserDrag\", \"MozUserDrag\", \"MSUserDrag\", \"msUserDrag\", \"oUserDrag\"\n// \t];\n// \tfor (let i = 0; i < props.length; i++) {\n// \t\tif (props[i] in dom.style) {\n// \t\t\tsetStyle(dom, props[i], \"none\");\n// \t\t}\n// \t}\n\n// \t// Remove iOS-specific selection;\n// \tsetStyle(dom, \"tapHighlightColor\", \"rgba(0, 0, 0, 0)\");\n\n// }\n\n// /**\n//  * Restores replaced styles\n//  *\n//  * @ignore\n//  * @param  io  Element\n//  */\n// export function unprepElementForDrag(dom: HTMLElement): void {\n\n// \t// Define possible props\n// \tlet props = [\n// \t\t\"touchAction\", \"webkitTouchAction\", \"MozTouchAction\", \"MSTouchAction\", \"msTouchAction\", \"oTouchAction\",\n// \t\t\"userSelect\", \"webkitUserSelect\", \"MozUserSelect\", \"MSUserSelect\", \"msUserSelect\", \"oUserSelect\",\n// \t\t\"touchSelect\", \"webkitTouchSelect\", \"MozTouchSelect\", \"MSTouchSelect\", \"msTouchSelect\", \"oTouchSelect\",\n// \t\t\"touchCallout\", \"webkitTouchCallout\", \"MozTouchCallout\", \"MSTouchCallout\", \"msTouchCallout\", \"oTouchCallout\",\n// \t\t\"contentZooming\", \"webkitContentZooming\", \"MozContentZooming\", \"MSContentZooming\", \"msContentZooming\", \"oContentZooming\",\n// \t\t\"userDrag\", \"webkitUserDrag\", \"MozUserDrag\", \"MSUserDrag\", \"msUserDrag\", \"oUserDrag\"\n// \t];\n// \tfor (let i = 0; i < props.length; i++) {\n// \t\tif (props[i] in dom.style) {\n// \t\t\tsetStyle(dom, props[i], \"\");\n// \t\t}\n// \t}\n\n// \t// Remove iOS-specific selection;\n// \tsetStyle(dom, \"tapHighlightColor\", \"\");\n\n// }\n\nexport function iOS(): boolean {\n\treturn /apple/i.test(navigator.vendor) && \"ontouchend\" in document;\n}\n\nexport function getSafeResolution(): number | undefined {\n\treturn iOS() ? 1 : undefined;\n}\n\nexport function relativeToValue(percent: number | Percent | undefined | null, full: number): number {\n\tif ($type.isNumber(percent)) {\n\t\treturn percent;\n\t} else if (percent != null && $type.isNumber(percent.value) && $type.isNumber(full)) {\n\t\treturn full * percent.value;\n\n\t} else {\n\t\treturn 0;\n\t}\n}\n\n\n\n/**\n * Returns number of decimals\n *\n * @ignore Exclude from docs\n * @param number  Input number\n * @return Number of decimals\n */\nexport function decimalPlaces(number: number): number {\n\tlet match = ('' + number).match(/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/);\n\tif (!match) { return 0; }\n\treturn Math.max(0, (match[1] ? match[1].length : 0) - (match[2] ? +match[2] : 0));\n}\n\n\n/**\n * ============================================================================\n * STRING FORMATTING FUNCTIONS\n * ============================================================================\n * @hidden\n */\n\n/**\n * Pads a string with additional characters to certain length.\n *\n * @param value  A numeric value\n * @param len    Result string length in characters\n * @param char   A character to use for padding\n * @return Padded value as string\n */\nexport function padString(value: any, len: number = 0, char: string = \"0\"): string {\n\tif (typeof value !== \"string\") {\n\t\tvalue = value.toString();\n\t}\n\n\treturn len > value.length ? Array(len - value.length + 1).join(char) + value : value;\n}\n\nexport function trimLeft(text: string): string {\n\treturn text.replace(/^[\\s]*/, \"\");\n}\n\nexport function trimRight(text: string): string {\n\treturn text.replace(/[\\s]*$/, \"\");\n}\n\nexport function trim(text: string): string {\n\treturn trimLeft(trimRight(text));\n}\n\nexport function truncateTextWithEllipsis(text: string, maxLength: number, breakWords: boolean = false, ellipsis: string = \"...\") {\n\tif (text.length > maxLength) {\n\t\t// Find the last non-alphanumeric character before maxLength\n\t\tlet lastNonAlphanumericIndex = maxLength - 1;\n\t\twhile (lastNonAlphanumericIndex >= 0 && text.charAt(lastNonAlphanumericIndex).match(/\\w/)) {\n\t\t\tlastNonAlphanumericIndex--;\n\t\t}\n\n\t\tif (lastNonAlphanumericIndex >= 0 && breakWords == false) {\n\t\t\treturn text.substring(0, lastNonAlphanumericIndex + 1) + '...';\n\t\t} else {\n\t\t\t// If no non-alphanumeric character found, truncate without breaking words\n\t\t\treturn text.substring(0, maxLength) + ellipsis;\n\t\t}\n\t} else {\n\t\treturn text;\n\t}\n}\n\n/**\n * Tries to determine format type.\n *\n * @ignore Exclude from docs\n * @param format  Format string\n * @return Format type (\"string\" | \"number\" | \"date\" | \"duration\")\n */\nexport function getFormat(format: string): string {\n\n\t// Undefined?\n\tif (typeof format === \"undefined\") {\n\t\treturn \"string\";\n\t}\n\n\t// Cleanup and lowercase format\n\tformat = format.toLowerCase().replace(/^\\[[^\\]]*\\]/, \"\");\n\n\t// Remove style tags\n\tformat = format.replace(/\\[[^\\]]+\\]/, \"\");\n\n\t// Trim\n\tformat = format.trim();\n\n\t// Check for any explicit format hints (i.e. /Date)\n\tlet hints: RegExpMatchArray | null = format.match(/\\/(date|number|duration)$/);\n\n\tif (hints) {\n\t\treturn hints[1];\n\t}\n\n\t// Check for explicit hints\n\tif (format === \"number\") {\n\t\treturn \"number\";\n\t}\n\n\tif (format === \"date\") {\n\t\treturn \"date\";\n\t}\n\n\tif (format === \"duration\") {\n\t\treturn \"duration\";\n\t}\n\n\t// Detect number formatting symbols\n\tif (format.match(/[#0]/)) {\n\t\treturn \"number\";\n\t}\n\n\t// Detect date formatting symbols\n\tif (format.match(/[ymwdhnsqaxkzgtei]/)) {\n\t\treturn \"date\";\n\t}\n\n\t// Nothing? Let's display as string\n\treturn \"string\";\n}\n\n/**\n * Cleans up format:\n * * Strips out formatter hints\n *\n * @ignore Exclude from docs\n * @param format  Format\n * @return Cleaned format\n */\nexport function cleanFormat(format: string): string {\n\treturn format.replace(/\\/(date|number|duration)$/i, \"\");\n}\n\n/**\n * Strips all tags from the string.\n *\n * @param text  Source string\n * @return String without tags\n */\nexport function stripTags(text: string): string {\n\treturn text ? text.replace(/<[^>]*>/g, \"\") : text;\n}\n\n/**\n * Removes new lines and tags from a string.\n *\n * @param text  String to conver\n * @return Converted string\n */\nexport function plainText(text: string): string {\n\treturn text ? stripTags((\"\" + text).replace(/[\\n\\r]+/g, \". \")) : text;\n}\n\n/**\n * Escapes string so it can safely be used in a Regex.\n *\n * @param value  Unsescaped string\n * @return Escaped string\n */\nexport function escapeForRgex(value: string): string {\n\treturn value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n}\n\n/**\n * Adds space before each uppercase letter.\n *\n * @param   str Input string\n * @return      Output string\n */\nexport function addSpacing(str: string): string {\n\tlet result = \"\";\n\tfor (let i = 0; i < str.length; i++) {\n\t\tconst char = str.charAt(i);\n\t\tif (char.toUpperCase() == char && i != 0) {\n\t\t\tresult += \" \";\n\t\t}\n\t\tresult += char;\n\t}\n\treturn result;\n}\n\n/**\n * Splits the string into separate characters. Keeps RTL words non-split.\n *\n * @param   source  Input\n * @return          Split text\n */\nexport function splitString(source: string): string[] {\n\t// Regular expression to identify RTL characters\n\tconst rtlChar = /[\\u0590-\\u05FF\\u0600-\\u06FF\\u0750-\\u077F\\u08A0-\\u08FF\\uFB50-\\uFDFF\\uFE70-\\uFEFF]/;\n\n\t// Regular expression to capture segments ending with specific Arabic characters\n\tconst splitPattern = /([^اأدذرزو]*[اأدذرزو])/gi;\n\n\t// Split input string into array of words or characters, including whitespace\n\tlet segments = source.split(/(\\s+)/); // Split by whitespace, capturing it\n\n\tlet result: string[] = [];\n\tsegments.forEach(segment => {\n\t\tif (segment.match(/^\\s+$/)) {\n\t\t\t// If the segment is purely whitespace\n\t\t\tif (segment = \" \") {\n\t\t\t\tsegment = \"  \";\n\t\t\t}\n\t\t\tresult.push(segment);\n\t\t} else if (rtlChar.test(segment)) {\n\t\t\t// If the segment contains RTL characters, handle special splits\n\t\t\tlet parts = segment.split(splitPattern).filter(part => part !== '');\n\t\t\t// Concatenate parts processed by the split pattern directly to result\n\t\t\tresult = result.concat(parts);\n\t\t} else {\n\t\t\t// Treat this segment as LTR: split into characters\n\t\t\tresult = result.concat([...segment]);\n\t\t}\n\t});\n\n\treturn result;\n}\n\n/**\n * ============================================================================\n * DATE-RELATED FUNCTIONS\n * ============================================================================\n * @hidden\n */\n\n/**\n * Returns a year day.\n *\n * @param date  Date\n * @param utc   Assume UTC dates?\n * @return Year day\n * @todo Account for UTC\n */\nexport function getYearDay(date: Date, utc: boolean = false): number {\n\t// TODO: utc needed?\n\tutc;\n\tconst start = new Date(date.getFullYear(), 0, 0);\n\tconst diff = (date.getTime() - start.getTime()) + ((start.getTimezoneOffset() - date.getTimezoneOffset()) * 60 * 1000);\n\tconst oneDay = 1000 * 60 * 60 * 24;\n\treturn Math.floor(diff / oneDay);\n}\n\n/**\n * Returns week number for a given date.\n *\n * @param date  Date\n * @param utc   Assume UTC dates?\n * @return Week number\n * @todo Account for UTC\n */\nexport function getWeek(date: Date, _utc: boolean = false): number {\n\tconst d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n\tconst day = d.getUTCDay() || 7;\n\td.setUTCDate(d.getUTCDate() + 4 - day);\n\tconst firstDay = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\n\treturn Math.ceil((((d.getTime() - firstDay.getTime()) / 86400000) + 1) / 7);\n}\n\n/**\n * Returns a \"week year\" of the given date.\n *\n * @param date  Date\n * @param utc   Assume UTC dates?\n * @return Year of week\n * @since 5.3.0\n * @todo Account for UTC\n */\nexport function getWeekYear(date: Date, _utc: boolean = false): number {\n\tconst d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n\tconst day = d.getUTCDay() || 7;\n\td.setUTCDate(d.getUTCDate() + 4 - day);\n\tconst firstDay = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\n\treturn firstDay.getFullYear();\n}\n\n/**\n * Returns a week number in the month.\n *\n * @param date  Source Date\n * @param utc   Assume UTC dates?\n * @return Week number in month\n */\nexport function getMonthWeek(date: Date, utc: boolean = false): number {\n\tconst firstWeek = getWeek(new Date(date.getFullYear(), date.getMonth(), 1), utc);\n\tlet currentWeek = getWeek(date, utc);\n\tif (currentWeek == 1) {\n\t\tcurrentWeek = 53;\n\t}\n\treturn currentWeek - firstWeek + 1;\n}\n\n/**\n * Returns a year day out of the given week number.\n *\n * @param week     Week\n * @param year     Year\n * @param weekday  Weekday\n * @param utc      Assume UTC dates\n * @return Day in a year\n */\nexport function getDayFromWeek(week: number, year: number, weekday: number = 1, utc: boolean = false): number {\n\tlet date = new Date(year, 0, 4, 0, 0, 0, 0);\n\tif (utc) {\n\t\tdate.setUTCFullYear(year);\n\t}\n\tlet day = week * 7 + weekday - ((date.getDay() || 7) + 3);\n\treturn day;\n}\n\n/**\n * Returns 12-hour representation out of the 24-hour hours.\n *\n * @param hours  24-hour number\n * @return 12-hour number\n */\nexport function get12Hours(hours: number, base?: number): number {\n\tif (hours > 12) {\n\t\thours -= 12;\n\t}\n\telse if (hours === 0) {\n\t\thours = 12;\n\t}\n\treturn base != null ? hours + (base - 1) : hours;\n}\n\n/**\n * Returns a string name of the time zone.\n *\n * @param date     Date object\n * @param long     Should return long (\"Pacific Standard Time\") or short abbreviation (\"PST\")\n * @param savings  Include information if it's in daylight savings mode\n * @param utc      Assume UTC dates\n * @return Time zone name\n */\nexport function getTimeZone(date: Date, long: boolean = false, savings: boolean = false, utc: boolean = false, timezone?: string): string {\n\tif (utc) {\n\t\treturn long ? \"Coordinated Universal Time\" : \"UTC\";\n\t}\n\telse if (timezone) {\n\t\tconst d1 = date.toLocaleString(\"en-US\", { timeZone: timezone });\n\t\tconst d2 = date.toLocaleString(\"en-US\", { timeZone: timezone, timeZoneName: long ? \"long\" : \"short\" });\n\t\treturn trim(d2.substr(d1.length));\n\t}\n\tlet wotz = date.toLocaleString(\"UTC\");\n\tlet wtz = date.toLocaleString(\"UTC\", { timeZoneName: long ? \"long\" : \"short\" }).substr(wotz.length);\n\t//wtz = wtz.replace(/[+-]+[0-9]+$/, \"\");\n\tif (savings === false) {\n\t\twtz = wtz.replace(/ (standard|daylight|summer|winter) /i, \" \");\n\t}\n\treturn trim(wtz);\n}\n\nexport function getTimezoneOffset(timezone: string): number {\n\tconst date = new Date(Date.UTC(2012, 0, 1, 0, 0, 0, 0));\n\tconst utcDate = new Date(date.toLocaleString(\"en-US\", { timeZone: \"UTC\" }));\n\tconst tzDate = new Date(date.toLocaleString(\"en-US\", { timeZone: timezone }));\n\treturn (tzDate.getTime() - utcDate.getTime()) / 6e4 * -1;\n}\n\n\nexport function capitalizeFirst(text: string): string {\n\treturn text.charAt(0).toUpperCase() + text.slice(1);\n}\n\n\n/**\n * ============================================================================\n * COLOR UTILS\n * ============================================================================\n */\n\n\n/**\n * Represents an interface for an object that represents an RGB color.\n */\nexport interface iRGB {\n\tr: number;\n\tg: number;\n\tb: number;\n\ta?: number;\n}\n\n/**\n * Represents an interface for an object that represents an HSL color.\n */\nexport interface iHSL {\n\th: number;\n\ts: number;\n\tl: number;\n\ta?: number;\n}\n\n/**\n * Represents an interface for an object that represents an HSV color.\n */\nexport interface iHSV {\n\th: number;\n\ts: number;\n\tv: number;\n\ta?: number;\n}\n\n/**\n * The functions below are taken and adapted from Garry Tan's blog post:\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n *\n * The further attributions go mjijackson.com, which now seems to be defunct.\n */\n\n\n/**\n * Converts an HSL color value to RGB. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n * Assumes h, s, and l are contained in the set [0, 1] and\n * returns r, g, and b in the set [0, 255].\n *\n * Function adapted from:\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n *\n * @param h       The hue\n * @param s       The saturation\n * @param l       The lightness\n * @return The RGB representation\n */\nexport function hslToRgb(color: iHSL): iRGB {\n\tlet r, g, b;\n\tlet h = color.h;\n\tlet s = color.s;\n\tlet l = color.l;\n\n\tif (s == 0) {\n\t\tr = g = b = l; // achromatic\n\t} else {\n\t\tlet hue2rgb = function hue2rgb(p: number, q: number, t: number) {\n\t\t\tif (t < 0) { t += 1; }\n\t\t\tif (t > 1) { t -= 1; }\n\t\t\tif (t < 1 / 6) { return p + (q - p) * 6 * t; }\n\t\t\tif (t < 1 / 2) { return q; }\n\t\t\tif (t < 2 / 3) { return p + (q - p) * (2 / 3 - t) * 6; }\n\t\t\treturn p;\n\t\t}\n\n\t\tlet q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n\t\tlet p = 2 * l - q;\n\t\tr = hue2rgb(p, q, h + 1 / 3);\n\t\tg = hue2rgb(p, q, h);\n\t\tb = hue2rgb(p, q, h - 1 / 3);\n\t}\n\n\treturn {\n\t\tr: Math.round(r * 255),\n\t\tg: Math.round(g * 255),\n\t\tb: Math.round(b * 255)\n\t};\n}\n\n/**\n * Converts an RGB color value to HSL. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n * Assumes r, g, and b are contained in the set [0, 255] and\n * returns h, s, and l in the set [0, 1].\n *\n * Function adapted from:\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n *\n * @param r       The red color value\n * @param g       The green color value\n * @param b       The blue color value\n * @return The HSL representation\n */\nexport function rgbToHsl(color: iRGB): iHSL {\n\tlet r = color.r / 255;\n\tlet g = color.g / 255;\n\tlet b = color.b / 255;\n\tlet max = Math.max(r, g, b);\n\tlet min = Math.min(r, g, b);\n\tlet h = 0;\n\tlet s = 0;\n\tlet l = (max + min) / 2;\n\n\tif (max === min) {\n\t\th = s = 0; // achromatic\n\n\t} else {\n\t\tlet d = max - min;\n\n\t\ts = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n\t\tswitch (max) {\n\t\t\tcase r: h = (g - b) / d + (g < b ? 6 : 0); break;\n\t\t\tcase g: h = (b - r) / d + 2; break;\n\t\t\tcase b: h = (r - g) / d + 4; break;\n\t\t}\n\n\t\th /= 6;\n\t}\n\n\treturn {\n\t\th: h,\n\t\ts: s,\n\t\tl: l,\n\t};\n}\n\n\n/**\n * Converts HSV to HSL.\n *\n * https://en.wikipedia.org/wiki/HSL_and_HSV#HSV_to_HSL\n */\nexport function hsvToHsl(hsv: iHSV): iHSL {\n\tconst l = hsv.v * (1 - (hsv.s / 2));\n\n\tconst s =\n\t\t(l === 0 || l === 1\n\t\t\t? 0\n\t\t\t: (hsv.v - l) / Math.min(l, 1 - l));\n\n\treturn {\n\t\th: hsv.h,\n\t\ts,\n\t\tl,\n\t\ta: hsv.a,\n\t};\n}\n\n\n/**\n * Converts HSL to HSV.\n *\n * https://en.wikipedia.org/wiki/HSL_and_HSV#HSL_to_HSV\n */\nexport function hslToHsv(hsl: iHSL): iHSV {\n\tconst v = hsl.l + (hsl.s * Math.min(hsl.l, 1 - hsl.l));\n\n\tconst s =\n\t\t(v === 0\n\t\t\t? 0\n\t\t\t: 2 * (1 - (hsl.l / v)));\n\n\treturn {\n\t\th: hsl.h,\n\t\ts,\n\t\tv,\n\t\ta: hsl.a,\n\t};\n}\n\n\n/**\n * Returns a color that is `percent` brighter than the reference color.\n *\n * @param color    Reference color\n * @param percent  Brightness percent\n * @return Hex code of the new color\n */\nexport function lighten(rgb: $type.Optional<iRGB>, percent: number): $type.Optional<iRGB> {\n\tif (rgb) {\n\t\treturn {\n\t\t\tr: Math.max(0, Math.min(255, rgb.r + getLightnessStep(rgb.r, percent))),\n\t\t\tg: Math.max(0, Math.min(255, rgb.g + getLightnessStep(rgb.g, percent))),\n\t\t\tb: Math.max(0, Math.min(255, rgb.b + getLightnessStep(rgb.b, percent))),\n\t\t\ta: rgb.a\n\t\t};\n\n\t} else {\n\t\t// TODO is this correct ?\n\t\treturn rgb;\n\t}\n};\n\n/**\n * Gets lightness step.\n *\n * @param value    Value\n * @param percent  Percent\n * @return Step\n */\nexport function getLightnessStep(value: number, percent: number): number {\n\tlet base = percent > 0 ? 255 - value : value;\n\treturn Math.round(base * percent);\n}\n\n/**\n * Returns a color that is `percent` brighter than the source `color`.\n *\n * @param color    Source color\n * @param percent  Brightness percent\n * @return New color\n */\nexport function brighten(rgb: $type.Optional<iRGB>, percent: number): $type.Optional<iRGB> {\n\tif (rgb) {\n\t\tlet base = Math.min(Math.max(rgb.r, rgb.g, rgb.b), 230);\n\t\t//let base = Math.max(rgb.r, rgb.g, rgb.b);\n\t\tlet step = getLightnessStep(base, percent);\n\t\treturn {\n\t\t\tr: Math.max(0, Math.min(255, Math.round(rgb.r + step))),\n\t\t\tg: Math.max(0, Math.min(255, Math.round(rgb.g + step))),\n\t\t\tb: Math.max(0, Math.min(255, Math.round(rgb.b + step))),\n\t\t\ta: rgb.a\n\t\t};\n\n\t} else {\n\t\t// TODO is this correct ?\n\t\treturn rgb;\n\t}\n};\n\n/**\n * Returns brightness step.\n *\n * @ignore Exclude from docs\n * @param value    Value\n * @param percent  Percent\n * @return Step\n */\nexport function getBrightnessStep(_value: number, percent: number): number {\n\tlet base = 255; //percent > 0 ? 255 - value : value;\n\treturn Math.round(base * percent);\n}\n\n/**\n * Returns `true` if color is \"light\". Useful indetermining which contrasting\n * color to use for elements over this color. E.g.: you would want to use\n * black text over light background, and vice versa.\n *\n * @param color  Source color\n * @return Light?\n */\nexport function isLight(color: iRGB): boolean {\n\treturn ((color.r * 299) + (color.g * 587) + (color.b * 114)) / 1000 >= 128;\n}\n\n/**\n * Returns a new [[iRGB]] object based on `rgb` parameter with specific\n * saturation applied.\n *\n * `saturation` can be in the range of 0 (fully desaturated) to 1 (fully\n * saturated).\n *\n * @param color       Base color\n * @param saturation  Saturation (0-1)\n * @return New color\n */\nexport function saturate(rgb: $type.Optional<iRGB>, saturation: number): $type.Optional<iRGB> {\n\tif (rgb === undefined || saturation == 1) {\n\t\treturn rgb;\n\t}\n\n\tlet hsl = rgbToHsl(rgb);\n\thsl.s = saturation;\n\treturn hslToRgb(hsl);\n}\n\n/**\n * Returns a color which contrasts more with the source `color`.\n *\n * @param  color             Base color\n * @param  lightAlternative  Light option\n * @param  darkAlternative   Dark option\n * @return New color\n */\nexport function alternativeColor(color: iRGB, lightAlternative: iRGB = { r: 255, g: 255, b: 255 }, darkAlternative: iRGB = { r: 255, g: 255, b: 255 }): iRGB {\n\tlet light = lightAlternative;\n\tlet dark = darkAlternative;\n\tif (isLight(darkAlternative)) {\n\t\tlight = darkAlternative;\n\t\tdark = lightAlternative;\n\t}\n\treturn isLight(color) ? dark : light;\n}\n\n/**\n * @ignore\n */\nexport function mergeTags(tags1: string[] | undefined, tags2: string[]): string[] {\n\tif (!tags1) {\n\t\ttags1 = [];\n\t}\n\treturn [...tags1, ...tags2].filter((value, index, self) => {\n\t\treturn self.indexOf(value) === index;\n\t});\n}\n\n/**\n * @ignore\n */\nexport function sameBounds(a: IBounds, b?: IBounds): boolean {\n\tif (!b) {\n\t\treturn false;\n\t}\n\tif (a.left != b.left) {\n\t\treturn false\n\t}\n\tif (a.right != b.right) {\n\t\treturn false\n\t}\n\tif (a.top != b.top) {\n\t\treturn false\n\t}\n\tif (a.bottom != b.bottom) {\n\t\treturn false\n\t}\n\treturn true;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}