{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { Entity } from \"../util/Entity\";\nimport { Template } from \"../util/Template\";\nimport { Percent } from \"../util/Percent\";\nimport { EventDispatcher } from \"../util/EventDispatcher\";\nimport { MultiDisposer, CounterDisposer } from \"../util/Disposer\";\nimport { waitForAnimations } from \"../util/Animation\";\nimport * as $utils from \"../util/Utils\";\nimport * as $array from \"../util/Array\";\nimport * as $type from \"../util/Type\";\nimport * as $object from \"../util/Object\";\nimport * as $math from \"../util/Math\";\n//import { populateString } from \"../util/PopulateString\";\n/**\r\n * An [[EventDispatcher]] for [[Sprite]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/concepts/events/} for more info\r\n */\nclass SpriteEventDispatcher extends EventDispatcher {\n  constructor(sprite) {\n    super();\n    Object.defineProperty(this, \"_sprite\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_rendererDisposers\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(this, \"_dispatchParents\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: true\n    });\n    this._sprite = sprite;\n  }\n  _makePointerEvent(key, event) {\n    return {\n      type: key,\n      originalEvent: event.event,\n      point: event.point,\n      simulated: event.simulated,\n      native: event.native,\n      target: this._sprite\n    };\n  }\n  _onRenderer(key, dispatch) {\n    // TODO: is this OK? it'd be good not to require to set this on each individual element\n    this._sprite.set(\"interactive\", true);\n    this._sprite._display.interactive = true;\n    let events = this._rendererDisposers[key];\n    if (events === undefined) {\n      const disposer = this._sprite._display.on(key, e => {\n        dispatch.call(this, e);\n      });\n      events = this._rendererDisposers[key] = new CounterDisposer(() => {\n        delete this._rendererDisposers[key];\n        disposer.dispose();\n      });\n    }\n    return events.increment();\n  }\n  _on(once, type, callback, context, shouldClone, dispatch) {\n    const info = super._on(once, type, callback, context, shouldClone, dispatch);\n    const rendererEvent = SpriteEventDispatcher.RENDERER_EVENTS[type];\n    if (rendererEvent !== undefined) {\n      info.disposer = new MultiDisposer([info.disposer, this._onRenderer(type, rendererEvent)]);\n    }\n    return info;\n  }\n  /**\r\n   * Will stop any bubbling up of the event to element's parents.\r\n   *\r\n   * Should be called in an event handler, e.g.:\r\n   *\r\n   * ```TypeScript\r\n   * element.events.on(\"pointerdown\", function(ev) {\r\n   *   // Do something here and prevent from \"pointerdown\" bubbling up\r\n   *   // ...\r\n   *   ev.target.events.stopParentDispatch();\r\n   * });\r\n   * ```\r\n   * ```JavaScript\r\n   * element.events.on(\"pointerdown\", function(ev) {\r\n   *   // Do something here and prevent from \"pointerdown\" bubbling up\r\n   *   // ...\r\n   *   ev.target.events.stopParentDispatch();\r\n   * });\r\n   * ```\r\n   */\n  stopParentDispatch() {\n    this._dispatchParents = false;\n  }\n  /**\r\n   * @ignore\r\n   */\n  dispatchParents(type, event) {\n    const old = this._dispatchParents;\n    this._dispatchParents = true;\n    try {\n      this.dispatch(type, event);\n      if (this._dispatchParents && this._sprite.parent) {\n        this._sprite.parent.events.dispatchParents(type, event);\n      }\n    } finally {\n      this._dispatchParents = old;\n    }\n  }\n}\nObject.defineProperty(SpriteEventDispatcher, \"RENDERER_EVENTS\", {\n  enumerable: true,\n  configurable: true,\n  writable: true,\n  value: {\n    \"click\": function (event) {\n      if (this.isEnabled(\"click\") && !this._sprite.isDragging() && this._sprite._hasDown() && !this._sprite._hasMoved(this._makePointerEvent(\"click\", event))) {\n        this.dispatch(\"click\", this._makePointerEvent(\"click\", event));\n      }\n    },\n    \"rightclick\": function (event) {\n      if (this.isEnabled(\"rightclick\")) {\n        this.dispatch(\"rightclick\", this._makePointerEvent(\"rightclick\", event));\n      }\n    },\n    \"middleclick\": function (event) {\n      if (this.isEnabled(\"middleclick\")) {\n        this.dispatch(\"middleclick\", this._makePointerEvent(\"middleclick\", event));\n      }\n    },\n    \"dblclick\": function (event) {\n      this.dispatchParents(\"dblclick\", this._makePointerEvent(\"dblclick\", event));\n    },\n    \"pointerover\": function (event) {\n      const sprite = this._sprite;\n      let dispatch = true;\n      if (sprite.getPrivate(\"trustBounds\")) {\n        sprite._getBounds();\n        const bounds = sprite.globalBounds();\n        if (sprite.isType(\"Graphics\")) {\n          const strokeWidth = sprite.get(\"strokeWidth\", 1) / 2;\n          if (strokeWidth >= 1) {\n            bounds.left -= strokeWidth;\n            bounds.right += strokeWidth;\n            bounds.top -= strokeWidth;\n            bounds.bottom += strokeWidth;\n          }\n        }\n        if (!$math.inBounds(event.point, bounds)) {\n          dispatch = false;\n          sprite._root._renderer.removeHovering(sprite._display);\n        }\n      }\n      if (dispatch && this.isEnabled(\"pointerover\")) {\n        this.dispatch(\"pointerover\", this._makePointerEvent(\"pointerover\", event));\n      }\n    },\n    \"pointerout\": function (event) {\n      if (this.isEnabled(\"pointerout\")) {\n        this.dispatch(\"pointerout\", this._makePointerEvent(\"pointerout\", event));\n      }\n    },\n    \"pointerdown\": function (event) {\n      this.dispatchParents(\"pointerdown\", this._makePointerEvent(\"pointerdown\", event));\n    },\n    \"pointerup\": function (event) {\n      if (this.isEnabled(\"pointerup\")) {\n        this.dispatch(\"pointerup\", this._makePointerEvent(\"pointerup\", event));\n      }\n    },\n    \"globalpointerup\": function (event) {\n      if (this.isEnabled(\"globalpointerup\")) {\n        this.dispatch(\"globalpointerup\", this._makePointerEvent(\"globalpointerup\", event));\n      }\n    },\n    \"globalpointermove\": function (event) {\n      if (this.isEnabled(\"globalpointermove\")) {\n        this.dispatch(\"globalpointermove\", this._makePointerEvent(\"globalpointermove\", event));\n      }\n    },\n    \"wheel\": function (event) {\n      this.dispatchParents(\"wheel\", {\n        type: \"wheel\",\n        target: this._sprite,\n        originalEvent: event.event,\n        point: event.point\n      });\n    }\n  }\n});\n/**\r\n * A base class for all visual elements.\r\n *\r\n * @important\r\n */\nexport class Sprite extends Entity {\n  constructor() {\n    super(...arguments);\n    Object.defineProperty(this, \"_adjustedLocalBounds\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 0\n      }\n    });\n    Object.defineProperty(this, \"_localBounds\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 0\n      }\n    });\n    Object.defineProperty(this, \"_parent\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_dataItem\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_templateField\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_sizeDirty\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    // Will be true only when dragging\n    Object.defineProperty(this, \"_isDragging\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    // The event when the dragging starts\n    Object.defineProperty(this, \"_dragEvent\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    // The position when dragging starts\n    Object.defineProperty(this, \"_dragPoint\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_isHidden\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(this, \"_isShowing\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(this, \"_isHiding\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(this, \"_isDown\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(this, \"_downPoint\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_downPoints\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(this, \"_toggleDp\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_dragDp\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_tooltipDp\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_hoverDp\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_focusDp\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_tooltipMoveDp\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_tooltipPointerDp\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"_statesHandled\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n  }\n  _afterNew() {\n    this.setPrivateRaw(\"visible\", true);\n    super._afterNew();\n  }\n  /**\r\n   * Marks some setting as dirty. Could be used to trigger adapter.\r\n   * @param key\r\n   */\n  markDirtyKey(key) {\n    this._markDirtyKey(key);\n  }\n  _markDirtyKey(key) {\n    super._markDirtyKey(key);\n    if (key == \"x\" || key == \"y\" || key == \"dx\" || key == \"dy\") {\n      this.markDirtyBounds();\n      this._addPercentagePositionChildren();\n      this.markDirtyPosition();\n    }\n  }\n  _markDirtyPrivateKey(key) {\n    super._markDirtyPrivateKey(key);\n    if (key == \"x\" || key == \"y\") {\n      this.markDirtyPosition();\n    }\n  }\n  _removeTemplateField() {\n    if (this._templateField) {\n      this._templateField._removeObjectTemplate(this);\n    }\n  }\n  _createEvents() {\n    return new SpriteEventDispatcher(this);\n  }\n  _processTemplateField() {\n    let template;\n    const field = this.get(\"templateField\");\n    if (field) {\n      const dataItem = this.dataItem;\n      if (dataItem) {\n        const context = dataItem.dataContext;\n        if (context) {\n          template = context[field];\n          if (!(template instanceof Template) && template) {\n            template = Template.new(template);\n          }\n        }\n      }\n    }\n    if (this._templateField !== template) {\n      this._removeTemplateField();\n      this._templateField = template;\n      if (template) {\n        template._setObjectTemplate(this);\n      }\n      this._applyTemplates();\n    }\n  }\n  // TODO change this to run before the element is added to the parent, so that way\n  //      it doesn't need to apply the themes twice\n  _setDataItem(dataItem) {\n    const oldDataItem = this._dataItem;\n    this._dataItem = dataItem;\n    this._processTemplateField();\n    const eventType = \"dataitemchanged\";\n    if (dataItem != oldDataItem) {\n      if (this.events.isEnabled(eventType)) {\n        this.events.dispatch(eventType, {\n          type: eventType,\n          target: this,\n          oldDataItem: oldDataItem,\n          newDataItem: dataItem\n        });\n      }\n    }\n  }\n  /**\r\n   * A [[DataItem]] used for this element.\r\n   *\r\n   * NOTE: data item is being assigned automatically in most cases where it\r\n   * matters. Use this accessor to set data item only if you know what you're\r\n   * doing.\r\n   *\r\n   * @param  value  Data item\r\n   */\n  set dataItem(value) {\n    this._setDataItem(value);\n  }\n  /**\r\n   * @return DataItem\r\n   */\n  get dataItem() {\n    if (this._dataItem) {\n      return this._dataItem;\n    } else {\n      let parent = this._parent;\n      while (parent) {\n        if (parent._dataItem) {\n          return parent._dataItem;\n        } else {\n          parent = parent._parent;\n        }\n      }\n    }\n  }\n  _addPercentageSizeChildren() {\n    let parent = this.parent;\n    if (parent) {\n      if (this.get(\"width\") instanceof Percent || this.get(\"height\") instanceof Percent) {\n        $array.pushOne(parent._percentageSizeChildren, this);\n      } else {\n        $array.removeFirst(parent._percentageSizeChildren, this);\n      }\n    }\n  }\n  _addPercentagePositionChildren() {\n    let parent = this.parent;\n    if (parent) {\n      if (this.get(\"x\") instanceof Percent || this.get(\"y\") instanceof Percent) {\n        $array.pushOne(parent._percentagePositionChildren, this);\n      } else {\n        $array.removeFirst(parent._percentagePositionChildren, this);\n      }\n    }\n  }\n  /**\r\n   * @ignore\r\n   */\n  markDirtyPosition() {\n    this._root._addDirtyPosition(this);\n  }\n  updatePivotPoint() {\n    const bounds = this._localBounds;\n    if (bounds) {\n      const centerX = this.get(\"centerX\");\n      if (centerX != null) {\n        this._display.pivot.x = bounds.left + $utils.relativeToValue(centerX, bounds.right - bounds.left);\n      }\n      const centerY = this.get(\"centerY\");\n      if (centerY != null) {\n        this._display.pivot.y = bounds.top + $utils.relativeToValue(centerY, bounds.bottom - bounds.top);\n      }\n    }\n  }\n  _beforeChanged() {\n    super._beforeChanged();\n    // handling states in beforeChanged, otherwise states is not applied without animated theme\n    this._handleStates();\n    if (this.isDirty(\"tooltip\")) {\n      const previous = this._prevSettings.tooltip;\n      if (previous) {\n        previous.dispose();\n      }\n    }\n    if (this.isDirty(\"layer\") || this.isDirty(\"layerMargin\")) {\n      this._display.setLayer(this.get(\"layer\"), this.get(\"layerMargin\"));\n      this.markDirtyLayer();\n    }\n    if (this.isDirty(\"tooltipPosition\")) {\n      const tooltipMoveDp = this._tooltipMoveDp;\n      if (tooltipMoveDp) {\n        tooltipMoveDp.dispose();\n        this._tooltipMoveDp = undefined;\n      }\n      const tooltipPointerDp = this._tooltipPointerDp;\n      if (tooltipPointerDp) {\n        tooltipPointerDp.dispose();\n        this._tooltipPointerDp = undefined;\n      }\n      if (this.get(\"tooltipPosition\") == \"pointer\") {\n        if (this.isHover()) {\n          this._tooltipMoveDp = this.events.on(\"globalpointermove\", e => {\n            this.showTooltip(e.point);\n          });\n        }\n        this._tooltipPointerDp = new MultiDisposer([this.events.on(\"pointerover\", () => {\n          this._tooltipMoveDp = this.events.on(\"globalpointermove\", e => {\n            this.showTooltip(e.point);\n          });\n        }), this.events.on(\"pointerout\", () => {\n          const tooltipMoveDp = this._tooltipMoveDp;\n          if (tooltipMoveDp) {\n            tooltipMoveDp.dispose();\n            this._tooltipMoveDp = undefined;\n          }\n        })]);\n      }\n    }\n  }\n  _handleStates() {\n    if (!this._statesHandled) {\n      if (this.isDirty(\"active\")) {\n        if (this.get(\"active\")) {\n          this.states.applyAnimate(\"active\");\n          this.set(\"ariaChecked\", true);\n        } else {\n          if (!this.isHidden()) {\n            this.states.applyAnimate(\"default\");\n          }\n          this.set(\"ariaChecked\", false);\n        }\n        this.markDirtyAccessibility();\n      }\n      if (this.isDirty(\"disabled\")) {\n        if (this.get(\"disabled\")) {\n          this.states.applyAnimate(\"disabled\");\n          this.set(\"ariaChecked\", false);\n        } else {\n          if (!this.isHidden()) {\n            this.states.applyAnimate(\"default\");\n          }\n          this.set(\"ariaChecked\", true);\n        }\n        this.markDirtyAccessibility();\n      }\n      this._statesHandled = true;\n    }\n  }\n  _changed() {\n    super._changed();\n    const display = this._display;\n    const events = this.events;\n    if (this.isDirty(\"draggable\")) {\n      const draggable = this.get(\"draggable\");\n      if (draggable) {\n        this.set(\"interactive\", true);\n        this._dragDp = new MultiDisposer([events.on(\"pointerdown\", ev => {\n          this.dragStart(ev);\n        }), events.on(\"globalpointermove\", ev => {\n          this.dragMove(ev);\n        }), events.on(\"globalpointerup\", ev => {\n          this.dragStop(ev);\n        })]);\n      } else {\n        if (this._dragDp) {\n          this._dragDp.dispose();\n          this._dragDp = undefined;\n        }\n      }\n      display.cancelTouch = draggable ? true : false;\n    }\n    if (this.isDirty(\"tooltipText\") || this.isDirty(\"tooltipHTML\") || this.isDirty(\"showTooltipOn\")) {\n      const tooltipText = this.get(\"tooltipText\");\n      const tooltipHTML = this.get(\"tooltipHTML\");\n      const showTooltipOn = this.get(\"showTooltipOn\", \"hover\");\n      if (this._tooltipDp) {\n        this._tooltipDp.dispose();\n        this._tooltipDp = undefined;\n      }\n      if (tooltipText || tooltipHTML) {\n        if (showTooltipOn == \"click\") {\n          this._tooltipDp = new MultiDisposer([events.on(\"click\", () => {\n            this.setTimeout(() => {\n              const tooltip = this.getTooltip();\n              if (tooltip && !tooltip.isHidden() && tooltip.get(\"tooltipTarget\") === this) {\n                this.hideTooltip();\n              } else {\n                this.showTooltip();\n              }\n            }, 10);\n          }), $utils.addEventListener(document, \"click\", _ev => {\n            this.hideTooltip();\n          })]);\n          this._disposers.push(this._tooltipDp);\n        } else if (showTooltipOn == \"always\") {\n          // nothing\n        } else {\n          this._tooltipDp = new MultiDisposer([events.on(\"pointerover\", () => {\n            this.showTooltip();\n          }), events.on(\"pointerout\", () => {\n            this.hideTooltip();\n          })]);\n          this._disposers.push(this._tooltipDp);\n        }\n      }\n    }\n    if (this.isDirty(\"toggleKey\")) {\n      let toggleKey = this.get(\"toggleKey\");\n      if (toggleKey && toggleKey != \"none\") {\n        this._toggleDp = events.on(\"click\", () => {\n          if (!this._isDragging) {\n            this.set(toggleKey, !this.get(toggleKey));\n          }\n        });\n      } else {\n        if (this._toggleDp) {\n          this._toggleDp.dispose();\n          this._toggleDp = undefined;\n        }\n      }\n    }\n    if (this.isDirty(\"opacity\")) {\n      display.alpha = Math.max(0, this.get(\"opacity\", 1));\n      if (this.get(\"focusable\")) {\n        this.markDirtyAccessibility();\n      }\n    }\n    if (this.isDirty(\"rotation\")) {\n      this.markDirtyBounds();\n      display.angle = this.get(\"rotation\", 0);\n    }\n    if (this.isDirty(\"scale\")) {\n      this.markDirtyBounds();\n      display.scale = this.get(\"scale\", 0);\n    }\n    if (this.isDirty(\"centerX\") || this.isDirty(\"centerY\")) {\n      this.markDirtyBounds();\n      this.updatePivotPoint();\n    }\n    if (this.isDirty(\"visible\") || this.isPrivateDirty(\"visible\") || this.isDirty(\"forceHidden\")) {\n      if (!this.get(\"visible\") || !this.getPrivate(\"visible\") || this.get(\"forceHidden\")) {\n        display.visible = false;\n        this.hideTooltip();\n      } else {\n        display.visible = true;\n      }\n      this.markDirtyBounds();\n      if (this.get(\"focusable\")) {\n        this.markDirtyAccessibility();\n      }\n    }\n    if (this.isDirty(\"width\") || this.isDirty(\"height\")) {\n      this.markDirtyBounds();\n      this._addPercentageSizeChildren();\n      const parent = this.parent;\n      if (parent) {\n        if (this.isDirty(\"width\") && this.get(\"width\") instanceof Percent || this.isDirty(\"height\") && this.get(\"height\") instanceof Percent) {\n          parent.markDirty();\n          parent._prevWidth = 0;\n        }\n      }\n      this._sizeDirty = true;\n    }\n    if (this.isDirty(\"maxWidth\") || this.isDirty(\"maxHeight\") || this.isPrivateDirty(\"width\") || this.isPrivateDirty(\"height\") || this.isDirty(\"minWidth\") || this.isDirty(\"minHeight\") || this.isPrivateDirty(\"maxWidth\") || this.isPrivateDirty(\"maxHeight\") || this.isPrivateDirty(\"minWidth\") || this.isPrivateDirty(\"minHeight\") || this.isDirty(\"marginLeft\") || this.isDirty(\"marginTop\") || this.isDirty(\"marginRight\") || this.isDirty(\"marginBottom\")) {\n      this.markDirtyBounds();\n      this._sizeDirty = true;\n    }\n    if (this._sizeDirty) {\n      this._updateSize();\n    }\n    if (this.isDirty(\"wheelable\")) {\n      const wheelable = this.get(\"wheelable\");\n      if (wheelable) {\n        this.set(\"interactive\", true);\n      }\n      display.wheelable = wheelable ? true : false;\n    }\n    // Accessibility\n    if (this.isDirty(\"tabindexOrder\") || this.isDirty(\"focusableGroup\")) {\n      if (this.get(\"focusable\")) {\n        this._root._registerTabindexOrder(this);\n      } else {\n        this._root._unregisterTabindexOrder(this);\n      }\n    }\n    if (this.isDirty(\"filter\")) {\n      //this.markDirtyBounds();\n      display.filter = this.get(\"filter\");\n    }\n    let filter = this.get(\"filter\", \"\");\n    if (this.isDirty(\"blur\")) {\n      const blur = this.get(\"blur\", 0);\n      if (blur != 0) {\n        filter += \" blur(\" + blur + \"px)\";\n      }\n    }\n    if (this.isDirty(\"saturate\")) {\n      const saturate = this.get(\"saturate\", 1);\n      if (saturate != 1) {\n        filter += \" saturate(\" + saturate + \")\";\n      }\n    }\n    if (this.isDirty(\"brightness\")) {\n      const brightness = this.get(\"brightness\", 1);\n      if (brightness != 1) {\n        filter += \" brightness(\" + brightness + \")\";\n      }\n    }\n    if (this.isDirty(\"contrast\")) {\n      const contrast = this.get(\"contrast\", 1);\n      if (contrast != 1) {\n        filter += \" contrast(\" + contrast + \")\";\n      }\n    }\n    if (this.isDirty(\"sepia\")) {\n      const sepia = this.get(\"sepia\", 0);\n      if (sepia != 0) {\n        filter += \" sepia(\" + sepia + \")\";\n      }\n    }\n    if (this.isDirty(\"hue\")) {\n      const hue = this.get(\"hue\", 0);\n      if (hue != 0) {\n        filter += \" hue-rotate(\" + hue + \"deg)\";\n      }\n    }\n    if (this.isDirty(\"invert\")) {\n      const invert = this.get(\"invert\", 0);\n      if (invert != 0) {\n        filter += \" invert(\" + invert + \")\";\n      }\n    }\n    if (filter) {\n      display.filter = filter;\n    }\n    if (this.isDirty(\"cursorOverStyle\")) {\n      display.cursorOverStyle = this.get(\"cursorOverStyle\");\n    }\n    if (this.isDirty(\"hoverOnFocus\")) {\n      if (this.get(\"hoverOnFocus\")) {\n        this._focusDp = new MultiDisposer([events.on(\"focus\", () => {\n          // TODO: proper hover, not just tooltip\n          this.showTooltip();\n        }), events.on(\"blur\", () => {\n          // TODO: proper hover, not just tooltip\n          this.hideTooltip();\n        })]);\n      } else {\n        if (this._focusDp) {\n          this._focusDp.dispose();\n          this._focusDp = undefined;\n        }\n      }\n    }\n    if (this.isDirty(\"focusable\")) {\n      if (this.get(\"focusable\")) {\n        this._root._registerTabindexOrder(this);\n      } else {\n        this._root._unregisterTabindexOrder(this);\n      }\n      this.markDirtyAccessibility();\n      this._disposers.push(events.on(\"blur\", () => {\n        this.setPrivateRaw(\"touchHovering\", false);\n      }));\n    }\n    if (this.isPrivateDirty(\"focusable\")) {\n      this.markDirtyAccessibility();\n    }\n    if (this.isDirty(\"role\") || this.isDirty(\"ariaLive\") || this.isDirty(\"ariaChecked\") || this.isDirty(\"ariaHidden\") || this.isDirty(\"ariaOrientation\") || this.isDirty(\"ariaValueNow\") || this.isDirty(\"ariaValueMin\") || this.isDirty(\"ariaValueMax\") || this.isDirty(\"ariaValueText\") || this.isDirty(\"ariaLabel\") || this.isDirty(\"ariaControls\")) {\n      // display.accessibility.ariaLabel = populateString(this, this.get(\"ariaLabel\", \"\"));\n      // @todo make sure ariaLabel gets populated in Root\n      this.markDirtyAccessibility();\n    }\n    if (this.isDirty(\"exportable\")) {\n      display.exportable = this.get(\"exportable\");\n    }\n    if (this.isDirty(\"interactive\")) {\n      const events = this.events;\n      if (this.get(\"interactive\") && !events.isDisposed()) {\n        this._hoverDp = new MultiDisposer([events.on(\"click\", ev => {\n          if ($utils.isTouchEvent(ev.originalEvent)) {\n            if (!this.getPrivate(\"touchHovering\")) {\n              this.setTimeout(() => {\n                this._handleOver();\n                if (this.get(\"tooltipText\") || this.get(\"tooltipHTML\")) {\n                  this.showTooltip();\n                }\n                this.setPrivateRaw(\"touchHovering\", true);\n                this.events.dispatch(\"pointerover\", {\n                  type: \"pointerover\",\n                  target: ev.target,\n                  originalEvent: ev.originalEvent,\n                  point: ev.point,\n                  simulated: ev.simulated\n                });\n              }, 10);\n            }\n          }\n        }), events.on(\"globalpointerup\", ev => {\n          if ($utils.isTouchEvent(ev.originalEvent)) {\n            if (this.getPrivate(\"touchHovering\")) {\n              this._handleOut();\n              if (this.get(\"tooltipText\") || this.get(\"tooltipHTML\")) {\n                this.hideTooltip();\n              }\n              this.setPrivateRaw(\"touchHovering\", false);\n              this.events.dispatch(\"pointerout\", {\n                type: \"pointerout\",\n                target: ev.target,\n                originalEvent: ev.originalEvent,\n                point: ev.point,\n                simulated: ev.simulated\n              });\n            }\n          }\n          if (this._isDown) {\n            this._handleUp(ev);\n          }\n          //this._isDown = false;\n        }), events.on(\"pointerover\", () => {\n          this._handleOver();\n        }), events.on(\"pointerout\", () => {\n          this._handleOut();\n        }), events.on(\"pointerdown\", e => {\n          this._handleDown(e);\n        })]);\n      } else {\n        this._display.interactive = false;\n        if (this._hoverDp) {\n          this._hoverDp.dispose();\n          this._hoverDp = undefined;\n        }\n      }\n    }\n    if (this.isDirty(\"forceInactive\")) {\n      this._display.inactive = this.get(\"forceInactive\", null);\n    }\n    if (this.get(\"showTooltipOn\") == \"always\" && this._display.visible) {\n      this.showTooltip();\n    }\n  }\n  /**\r\n   * @ignore\r\n   * @todo should this be user-accessible?\r\n   */\n  dragStart(e) {\n    this._dragEvent = e;\n    this.events.stopParentDispatch();\n  }\n  /**\r\n   * @ignore\r\n   * @todo should this be user-accessible?\r\n   */\n  dragStop(e) {\n    this._dragEvent = undefined;\n    this._dragPoint = undefined;\n    this.events.stopParentDispatch();\n    if (this._isDragging) {\n      this._isDragging = false;\n      const type = \"dragstop\";\n      if (this.events.isEnabled(type)) {\n        this.events.dispatch(type, {\n          type: type,\n          target: this,\n          originalEvent: e.originalEvent,\n          point: e.point,\n          simulated: e.simulated\n        });\n      }\n    }\n  }\n  _handleOver() {\n    if (!this.isHidden()) {\n      if (this.get(\"active\") && this.states.lookup(\"hoverActive\")) {\n        this.states.applyAnimate(\"hoverActive\");\n      } else if (this.get(\"disabled\") && this.states.lookup(\"hoverDisabled\")) {\n        this.states.applyAnimate(\"hoverDisabled\");\n      } else {\n        this.states.applyAnimate(\"hover\");\n      }\n      if (this.get(\"draggable\") && this._isDown && this.states.lookup(\"down\")) {\n        this.states.applyAnimate(\"down\");\n      }\n    }\n  }\n  _handleOut() {\n    if (!this.isHidden()) {\n      if (this.get(\"active\") && this.states.lookup(\"active\")) {\n        this.states.applyAnimate(\"active\");\n      } else if (this.get(\"disabled\") && this.states.lookup(\"disabled\")) {\n        this.states.applyAnimate(\"disabled\");\n      } else {\n        if (this.states.lookup(\"hover\") || this.states.lookup(\"hoverActive\")) {\n          this.states.applyAnimate(\"default\");\n        }\n      }\n      if (this.get(\"draggable\") && this._isDown && this.states.lookup(\"down\")) {\n        this.states.applyAnimate(\"down\");\n      }\n    }\n  }\n  _handleUp(e) {\n    if (!this.isHidden()) {\n      if (this.get(\"active\") && this.states.lookup(\"active\")) {\n        this.states.applyAnimate(\"active\");\n      } else if (this.get(\"disabled\") && this.states.lookup(\"disabled\")) {\n        this.states.applyAnimate(\"disabled\");\n      } else if (this.states.lookup(\"down\")) {\n        if (this.isHover()) {\n          this.states.applyAnimate(\"hover\");\n        } else {\n          this.states.applyAnimate(\"default\");\n        }\n      }\n      // @todo remove this once migrated to _downPoints\n      this._downPoint = undefined;\n      const pointerId = $utils.getPointerId(e.originalEvent);\n      delete this._downPoints[pointerId];\n      if ($object.keys(this._downPoints).length == 0) {\n        this._isDown = false;\n      }\n    }\n  }\n  _hasMoved(e) {\n    // @todo remove this once migrated to _downPoints\n    // if (this._downPoint) {\n    // \tconst x = Math.abs(this._downPoint.x - e.point.x);\n    // \tconst y = Math.abs(this._downPoint.y - e.point.y);\n    // \treturn (x > 5) || (y > 5);\n    // }\n    const pointerId = $utils.getPointerId(e.originalEvent);\n    const downPoint = this._downPoints[pointerId];\n    if (downPoint) {\n      const x = Math.abs(downPoint.x - e.point.x);\n      const y = Math.abs(downPoint.y - e.point.y);\n      return x > 5 || y > 5;\n    }\n    return false;\n  }\n  _hasDown() {\n    return $object.keys(this._downPoints).length > 0;\n  }\n  _handleDown(e) {\n    const parent = this.parent;\n    if (parent && !this.get(\"draggable\")) {\n      parent._handleDown(e);\n    }\n    if (this.get(\"interactive\") && !this.isHidden()) {\n      if (this.states.lookup(\"down\")) {\n        this.states.applyAnimate(\"down\");\n      }\n      this._downPoint = {\n        x: e.point.x,\n        y: e.point.y\n      };\n      // @todo remove this once migrated to _downPoints\n      this._isDown = true;\n      const pointerId = $utils.getPointerId(e.originalEvent);\n      this._downPoints[pointerId] = {\n        x: e.point.x,\n        y: e.point.y\n      };\n    }\n  }\n  /**\r\n   * @ignore\r\n   * @todo should this be user-accessible?\r\n   */\n  dragMove(e) {\n    let dragEvent = this._dragEvent;\n    if (dragEvent) {\n      if (dragEvent.simulated && !e.simulated) {\n        return true;\n      }\n      let angle = 0;\n      let parent = this.parent;\n      let scale = 1;\n      while (parent != null) {\n        angle += parent.get(\"rotation\", 0);\n        parent = parent.parent;\n        if (parent) {\n          scale *= parent.get(\"scale\", 1);\n        }\n      }\n      let x = (e.point.x - dragEvent.point.x) / scale;\n      let y = (e.point.y - dragEvent.point.y) / scale;\n      const events = this.events;\n      if (dragEvent.simulated && !this._isDragging) {\n        this._isDragging = true;\n        this._dragEvent = e;\n        this._dragPoint = {\n          x: this.x(),\n          y: this.y()\n        };\n        const type = \"dragstart\";\n        if (events.isEnabled(type)) {\n          events.dispatch(type, {\n            type: type,\n            target: this,\n            originalEvent: e.originalEvent,\n            point: e.point,\n            simulated: e.simulated\n          });\n        }\n      }\n      if (this._isDragging) {\n        let dragPoint = this._dragPoint;\n        this.set(\"x\", dragPoint.x + x * $math.cos(angle) + y * $math.sin(angle));\n        this.set(\"y\", dragPoint.y + y * $math.cos(angle) - x * $math.sin(angle));\n        const type = \"dragged\";\n        if (events.isEnabled(type)) {\n          events.dispatch(type, {\n            type: type,\n            target: this,\n            originalEvent: e.originalEvent,\n            point: e.point,\n            simulated: e.simulated\n          });\n        }\n      } else {\n        if (Math.hypot(x, y) > 5) {\n          this._isDragging = true;\n          this._dragEvent = e;\n          this._dragPoint = {\n            x: this.x(),\n            y: this.y()\n          };\n          const type = \"dragstart\";\n          if (events.isEnabled(type)) {\n            events.dispatch(type, {\n              type: type,\n              target: this,\n              originalEvent: e.originalEvent,\n              point: e.point,\n              simulated: e.simulated\n            });\n          }\n        }\n      }\n    }\n  }\n  _updateSize() {}\n  _getBounds() {\n    this._localBounds = this._display.getLocalBounds();\n  }\n  /**\r\n   * Returns depth (how deep in the hierachy of the content tree) of this\r\n   * element.\r\n   *\r\n   * @return Depth\r\n   */\n  depth() {\n    let self = this.parent;\n    let depth = 0;\n    while (true) {\n      if (self) {\n        ++depth;\n        self = self.parent;\n      } else {\n        return depth;\n      }\n    }\n  }\n  /**\r\n   * @ignore\r\n   */\n  markDirtySize() {\n    this._sizeDirty = true;\n    this.markDirty();\n  }\n  /**\r\n   * @ignore\r\n   */\n  markDirtyBounds() {\n    const display = this._display;\n    if (this.get(\"isMeasured\")) {\n      this._root._addDirtyBounds(this);\n      display.isMeasured = true;\n      display.invalidateBounds();\n      const parent = this.parent;\n      if (parent && this.get(\"position\") != \"absolute\") {\n        if (parent.get(\"width\") == null || parent.get(\"height\") == null || parent.get(\"layout\")) {\n          parent.markDirtyBounds();\n        }\n      }\n      if (this.get(\"focusable\") && this.isFocus()) {\n        this.markDirtyAccessibility();\n      }\n    }\n  }\n  /**\r\n   * @ignore\r\n   */\n  markDirtyAccessibility() {\n    //if (this._root.focused(this)) {\n    this._root._invalidateAccessibility(this);\n    //}\n  }\n  /**\r\n   * @ignore\r\n   */\n  markDirtyLayer() {\n    //this._display.markDirtyLayer(this.isDirty(\"opacity\") || this.isDirty(\"visible\")); https://codepen.io/team/amcharts/pen/gOWZPmP <- problems\n    this._display.markDirtyLayer(true);\n  }\n  /**\r\n   * @ignore\r\n   */\n  markDirty() {\n    super.markDirty();\n    this.markDirtyLayer();\n  }\n  _updateBounds() {\n    const oldBounds = this._adjustedLocalBounds;\n    let newBounds;\n    // if display.visible == false, it still returns bounds\n    if (!this.get(\"visible\") || !this.getPrivate(\"visible\") || this.get(\"forceHidden\")) {\n      newBounds = {\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 0\n      };\n      this._localBounds = newBounds;\n      this._adjustedLocalBounds = newBounds;\n    } else {\n      this._getBounds();\n      this._fixMinBounds(this._localBounds);\n      this.updatePivotPoint();\n      this._adjustedLocalBounds = this._display.getAdjustedBounds(this._localBounds);\n      newBounds = this._adjustedLocalBounds;\n    }\n    if (!oldBounds || oldBounds.left !== newBounds.left || oldBounds.top !== newBounds.top || oldBounds.right !== newBounds.right || oldBounds.bottom !== newBounds.bottom) {\n      const eventType = \"boundschanged\";\n      if (this.events.isEnabled(eventType)) {\n        this.events.dispatch(eventType, {\n          type: eventType,\n          target: this\n        });\n      }\n      if (this.parent) {\n        this.parent.markDirty();\n        this.parent.markDirtyBounds();\n      }\n      // Update tooltip position together with the Sprite\n      if (this.getPrivate(\"showingTooltip\")) {\n        this.showTooltip();\n      }\n    }\n  }\n  _fixMinBounds(bounds) {\n    let minWidth = this.get(\"minWidth\", this.getPrivate(\"minWidth\"));\n    let minHeight = this.get(\"minHeight\", this.getPrivate(\"minHeight\"));\n    if ($type.isNumber(minWidth)) {\n      if (bounds.right - bounds.left < minWidth) {\n        bounds.right = bounds.left + minWidth;\n      }\n    }\n    if ($type.isNumber(minHeight)) {\n      if (bounds.bottom - bounds.top < minHeight) {\n        bounds.bottom = bounds.top + minHeight;\n      }\n    }\n    let privateWidth = this.getPrivate(\"width\");\n    let privateHeight = this.getPrivate(\"height\");\n    if ($type.isNumber(privateWidth)) {\n      if (privateWidth > 0) {\n        bounds.right = bounds.left + privateWidth;\n      } else {\n        bounds.left = bounds.right + privateWidth;\n      }\n    }\n    if ($type.isNumber(privateHeight)) {\n      if (privateHeight > 0) {\n        bounds.bottom = bounds.top + privateHeight;\n      } else {\n        bounds.top = bounds.bottom + privateHeight;\n      }\n    }\n  }\n  _removeParent(parent) {\n    if (parent) {\n      parent.children.removeValue(this);\n      $array.removeFirst(parent._percentageSizeChildren, this);\n      $array.removeFirst(parent._percentagePositionChildren, this);\n    }\n  }\n  _clearDirty() {\n    super._clearDirty();\n    this._sizeDirty = false;\n    this._statesHandled = false;\n  }\n  /**\r\n   * Simulate hover over element.\r\n   */\n  hover() {\n    if (!this.isDisposed()) {\n      this.showTooltip();\n      this._handleOver();\n    }\n  }\n  /**\r\n   * Simulate unhover over element.\r\n   */\n  unhover() {\n    if (!this.isDisposed()) {\n      this.hideTooltip();\n      this._handleOut();\n    }\n  }\n  /**\r\n   * Shows element's [[Tooltip]].\r\n   */\n  showTooltip(point) {\n    if (!this.isDisposed()) {\n      const tooltip = this.getTooltip();\n      const tooltipText = this.get(\"tooltipText\");\n      const tooltipHTML = this.get(\"tooltipHTML\");\n      if ((tooltipText || tooltipHTML) && tooltip) {\n        const tooltipPosition = this.get(\"tooltipPosition\");\n        const tooltipTarget = this.getPrivate(\"tooltipTarget\", this);\n        if (tooltipPosition == \"fixed\" || !point) {\n          this._display._setMatrix();\n          point = this.toGlobal(tooltipTarget._getTooltipPoint());\n        }\n        tooltip.set(\"pointTo\", point);\n        tooltip.set(\"tooltipTarget\", tooltipTarget);\n        if (!tooltip.get(\"x\")) {\n          tooltip.set(\"x\", point.x);\n        }\n        if (!tooltip.get(\"y\")) {\n          tooltip.set(\"y\", point.y);\n        }\n        if (tooltipText) {\n          tooltip.label.set(\"text\", tooltipText);\n        }\n        if (tooltipHTML) {\n          tooltip.label.set(\"html\", tooltipHTML);\n        }\n        const dataItem = this.dataItem;\n        if (dataItem) {\n          tooltip.label._setDataItem(dataItem);\n        }\n        if (this.get(\"showTooltipOn\") == \"always\" && (point.x < 0 || point.x > this._root.width() || point.y < 0 || point.y > this._root.height())) {\n          this.hideTooltip();\n          return;\n        }\n        tooltip.label.text.markDirtyText();\n        const promise = tooltip.show();\n        this.setPrivateRaw(\"showingTooltip\", true);\n        return promise;\n      }\n    }\n  }\n  /**\r\n   * Hides element's [[Tooltip]].\r\n   */\n  hideTooltip() {\n    const tooltip = this.getTooltip();\n    if (tooltip) {\n      if (tooltip.get(\"tooltipTarget\") == this.getPrivate(\"tooltipTarget\", this) || this.get(\"tooltip\") == tooltip) {\n        let timeout = tooltip.get(\"keepTargetHover\") && tooltip.get(\"stateAnimationDuration\", 0) == 0 ? 400 : undefined;\n        const promise = tooltip.hide(timeout);\n        this.setPrivateRaw(\"showingTooltip\", false);\n        return promise;\n      }\n    }\n  }\n  _getTooltipPoint() {\n    const bounds = this._localBounds;\n    if (bounds) {\n      let x = 0;\n      let y = 0;\n      if (!this.get(\"isMeasured\")) {\n        x = $utils.relativeToValue(this.get(\"tooltipX\", 0), this.width());\n        y = $utils.relativeToValue(this.get(\"tooltipY\", 0), this.height());\n      } else {\n        x = bounds.left + $utils.relativeToValue(this.get(\"tooltipX\", 0), bounds.right - bounds.left);\n        y = bounds.top + $utils.relativeToValue(this.get(\"tooltipY\", 0), bounds.bottom - bounds.top);\n      }\n      return {\n        x,\n        y\n      };\n    }\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n  /**\r\n   * Returns [[Tooltip]] used for this element.\r\n   *\r\n   * @return Tooltip\r\n   */\n  getTooltip() {\n    let tooltip = this.get(\"tooltip\");\n    if (!tooltip) {\n      let parent = this.parent;\n      if (parent) {\n        return parent.getTooltip();\n      }\n    } else {\n      return tooltip;\n    }\n  }\n  _updatePosition() {\n    const parent = this.parent;\n    let dx = this.get(\"dx\", 0);\n    let dy = this.get(\"dy\", 0);\n    let x = this.get(\"x\");\n    let _x = this.getPrivate(\"x\");\n    let xx = 0;\n    let yy = 0;\n    const position = this.get(\"position\");\n    if (x instanceof Percent) {\n      if (parent) {\n        x = parent.innerWidth() * x.value + parent.get(\"paddingLeft\", 0);\n      } else {\n        x = 0;\n      }\n    }\n    if ($type.isNumber(x)) {\n      xx = x + dx;\n    } else {\n      if (_x != null) {\n        xx = _x;\n      } else if (parent) {\n        if (position == \"relative\") {\n          xx = parent.get(\"paddingLeft\", 0) + dx;\n        }\n      }\n    }\n    let y = this.get(\"y\");\n    let _y = this.getPrivate(\"y\");\n    if (y instanceof Percent) {\n      if (parent) {\n        y = parent.innerHeight() * y.value + parent.get(\"paddingTop\", 0);\n      } else {\n        y = 0;\n      }\n    }\n    if ($type.isNumber(y)) {\n      yy = y + dy;\n    } else {\n      if (_y != null) {\n        yy = _y;\n      } else if (parent) {\n        if (position == \"relative\") {\n          yy = parent.get(\"paddingTop\", 0) + dy;\n        }\n      }\n    }\n    const display = this._display;\n    if (display.x != xx || display.y != yy) {\n      display.invalidateBounds();\n      display.x = xx;\n      display.y = yy;\n      const eventType = \"positionchanged\";\n      if (this.events.isEnabled(eventType)) {\n        this.events.dispatch(eventType, {\n          type: eventType,\n          target: this\n        });\n      }\n    }\n    // Update tooltip position together with the Sprite\n    if (this.getPrivate(\"showingTooltip\")) {\n      this.showTooltip();\n    }\n  }\n  /**\r\n   * Returns element's actual X position in pixels.\r\n   *\r\n   * @return X (px)\r\n   */\n  x() {\n    let x = this.get(\"x\");\n    let _x = this.getPrivate(\"x\");\n    const parent = this.parent;\n    if (parent) {\n      if (x instanceof Percent) {\n        return $utils.relativeToValue(x, parent.innerWidth()) + parent.get(\"paddingLeft\", 0);\n      } else {\n        if (!$type.isNumber(x)) {\n          if (_x != null) {\n            return _x;\n          } else {\n            return parent.get(\"paddingLeft\", this._display.x);\n          }\n        } else {\n          return x;\n        }\n      }\n    }\n    return this._display.x;\n  }\n  /**\r\n   * Returns element's actual Y position in pixels.\r\n   *\r\n   * @return Y (px)\r\n   */\n  y() {\n    let _y = this.getPrivate(\"y\");\n    if (_y != null) {\n      return _y;\n    }\n    let y = this.get(\"y\");\n    const parent = this.parent;\n    if (parent) {\n      if (y instanceof Percent) {\n        return $utils.relativeToValue(y, parent.innerHeight()) + parent.get(\"paddingTop\", 0);\n      } else {\n        if (!$type.isNumber(y)) {\n          if (_y != null) {\n            return _y;\n          } else {\n            return parent.get(\"paddingTop\", this._display.y);\n          }\n        } else {\n          return y;\n        }\n      }\n    }\n    return this._display.y;\n  }\n  _dispose() {\n    super._dispose();\n    this._display.dispose();\n    this._removeTemplateField();\n    this._removeParent(this.parent);\n    this._root._removeFocusElement(this);\n    const tooltip = this.get(\"tooltip\");\n    if (tooltip) {\n      tooltip.dispose();\n    }\n    this.markDirty();\n  }\n  /**\r\n   * @ignore\r\n   */\n  adjustedLocalBounds() {\n    this._fixMinBounds(this._adjustedLocalBounds);\n    return this._adjustedLocalBounds;\n  }\n  /**\r\n   * Returns local coordinates of the element's bounds.\r\n   *\r\n   * @ignore\r\n   * @return Global bounds\r\n   */\n  localBounds() {\n    return this._localBounds;\n  }\n  /**\r\n   * Returns adjusted local coordinates of the element's bounds.\r\n   *\r\n   * @ignore\r\n   * @return Global bounds\r\n   */\n  bounds() {\n    const bounds = this._adjustedLocalBounds;\n    const x = this.x();\n    const y = this.y();\n    return {\n      left: bounds.left + x,\n      right: bounds.right + x,\n      top: bounds.top + y,\n      bottom: bounds.bottom + y\n    };\n  }\n  /**\r\n   * Returns global coordinates of the element's bounds.\r\n   *\r\n   * @ignore\r\n   * @return Global bounds\r\n   */\n  globalBounds() {\n    const bounds = this.localBounds();\n    const p0 = this.toGlobal({\n      x: bounds.left,\n      y: bounds.top\n    });\n    const p1 = this.toGlobal({\n      x: bounds.right,\n      y: bounds.top\n    });\n    const p2 = this.toGlobal({\n      x: bounds.right,\n      y: bounds.bottom\n    });\n    const p3 = this.toGlobal({\n      x: bounds.left,\n      y: bounds.bottom\n    });\n    return {\n      left: Math.min(p0.x, p1.x, p2.x, p3.x),\n      top: Math.min(p0.y, p1.y, p2.y, p3.y),\n      right: Math.max(p0.x, p1.x, p2.x, p3.x),\n      bottom: Math.max(p0.y, p1.y, p2.y, p3.y)\n    };\n  }\n  _onShow(_duration) {}\n  _onHide(_duration) {}\n  /**\r\n   * Plays initial reveal animation regardless if element is currently hidden\r\n   * or visible.\r\n   *\r\n   * @param   duration  Duration of the animation in milliseconds\r\n   * @param   delay     Delay showing of the element by X milliseconds\r\n   * @return            Promise\r\n   */\n  appear(duration, delay) {\n    return __awaiter(this, void 0, void 0, function* () {\n      yield this.hide(0);\n      if (delay) {\n        return new Promise((success, _error) => {\n          this.setTimeout(() => {\n            success(this.show(duration));\n          }, delay);\n        });\n      } else {\n        return this.show(duration);\n      }\n    });\n  }\n  /**\r\n   * Shows currently hidden element and returns a `Promise` which completes\r\n   * when all showing animations are finished.\r\n   *\r\n   * ```TypeScript\r\n   * series.show().then(function(ev) {\r\n   *   console.log(\"Series is now fully visible\");\r\n   * })\r\n   * ```\r\n   * ```JavaScript\r\n   * series.show().then(function(ev) {\r\n   *   console.log(\"Series is now fully visible\");\r\n   * })\r\n   * ```\r\n   *\r\n   * @return Promise\r\n   */\n  show(duration) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!this._isShowing) {\n        this._isHidden = false;\n        this._isShowing = true;\n        this._isHiding = false;\n        if (this.states.lookup(\"default\").get(\"visible\")) {\n          this.set(\"visible\", true);\n        }\n        this._onShow(duration);\n        const animations = this.states.applyAnimate(\"default\", duration);\n        yield waitForAnimations(animations);\n        this._isShowing = false;\n      }\n    });\n  }\n  /**\r\n   * Hides the element and returns a `Promise` which completes when all hiding\r\n   * animations are finished.\r\n   *\r\n   * ```TypeScript\r\n   * series.hide().then(function(ev) {\r\n   *   console.log(\"Series finished hiding\");\r\n   * })\r\n   * ```\r\n   * ```JavaScript\r\n   * series.hide().then(function(ev) {\r\n   *   console.log(\"Series finished hiding\");\r\n   * })\r\n   * ```\r\n   *\r\n   * @return Promise\r\n   */\n  hide(duration) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!this._isHiding && !this._isHidden) {\n        this._isHiding = true;\n        this._isShowing = false;\n        let state = this.states.lookup(\"hidden\");\n        if (!state) {\n          state = this.states.create(\"hidden\", {\n            \"opacity\": 0,\n            \"visible\": false\n          });\n        }\n        this._isHidden = true;\n        this._onHide(duration);\n        const animations = this.states.applyAnimate(\"hidden\", duration);\n        yield waitForAnimations(animations);\n        this._isHiding = false;\n      }\n    });\n  }\n  /**\r\n   * Returns `true` if this element is currently hidden.\r\n   *\r\n   * @return Is hidden?\r\n   */\n  isHidden() {\n    return this._isHidden;\n  }\n  /**\r\n   * Returns `true` if this element is currently animating to a default state.\r\n   *\r\n   * @return Is showing?\r\n   */\n  isShowing() {\n    return this._isShowing;\n  }\n  /**\r\n   * Returns `true` if this element is currently animating to a hidden state.\r\n   *\r\n   * @return Is hiding?\r\n   */\n  isHiding() {\n    return this._isHiding;\n  }\n  /**\r\n   * Returns `true` if this element is currently hovered by a pointer.\r\n   *\r\n   * @return Is hovered?\r\n   */\n  isHover() {\n    return this._display.hovering();\n  }\n  /**\r\n   * Returns `true` if this element does currently have focus.\r\n   *\r\n   * @return Is focused?\r\n   */\n  isFocus() {\n    return this._root.focused(this);\n  }\n  /**\r\n   * Returns `true` if this element is currently being dragged.\r\n   *\r\n   * @return Is dragged?\r\n   */\n  isDragging() {\n    return this._isDragging;\n  }\n  /**\r\n   * Returns `false` if if either public or private setting `visible` is set\r\n   * to `false`, or `forceHidden` is set to `true`.\r\n   *\r\n   * @return Visible?\r\n   */\n  isVisible() {\n    if (this.get(\"visible\") && this.getPrivate(\"visible\") && !this.get(\"forceHidden\")) {\n      return true;\n    }\n    return false;\n  }\n  /**\r\n   * Same as `isVisible()`, except it checks all ascendants, too.\r\n   *\r\n   * @since 5.2.7\r\n   * @return Visible?\r\n   */\n  isVisibleDeep() {\n    return this._parent ? this._parent.isVisibleDeep() && this.isVisible() : this.isVisible();\n  }\n  /**\r\n   * Returns an actual opacity of the element, taking into account all parents.\r\n   *\r\n   * @return Opacity\r\n   * @since 5.2.11\r\n   */\n  compositeOpacity() {\n    const opacity = this.get(\"opacity\", 1);\n    return this._parent ? this._parent.compositeOpacity() * opacity : opacity;\n  }\n  /**\r\n   * Returns an actual scale of the element, taking into account all parents.\r\n   *\r\n   * @return Opacity\r\n   * @since 5.9.2\r\n   */\n  compositeScale() {\n    const scale = this.get(\"scale\", 1);\n    return this._parent ? this._parent.compositeScale() * scale : scale;\n  }\n  /**\r\n   * Returns an actual roation of the element, taking into account all parents.\r\n   *\r\n   * @return Opacity\r\n   * @since 5.9.2\r\n   */\n  compositeRotation() {\n    const rotation = this.get(\"rotation\", 0);\n    return this._parent ? this._parent.compositeRotation() + rotation : rotation;\n  }\n  /**\r\n   * Returns width of this element in pixels.\r\n   *\r\n   * @return Width (px)\r\n   */\n  width() {\n    let width = this.get(\"width\");\n    let maxWidth = this.get(\"maxWidth\", this.getPrivate(\"maxWidth\"));\n    let minWidth = this.get(\"minWidth\", this.getPrivate(\"minWidth\"));\n    let privateWidth = this.getPrivate(\"width\");\n    let w = 0;\n    if ($type.isNumber(privateWidth)) {\n      w = privateWidth;\n    } else {\n      if (width == null) {\n        if (this._adjustedLocalBounds) {\n          w = this._adjustedLocalBounds.right - this._adjustedLocalBounds.left;\n        }\n      } else {\n        if (width instanceof Percent) {\n          const parent = this.parent;\n          if (parent) {\n            w = parent.innerWidth() * width.value;\n          } else {\n            w = this._root.width() * width.value;\n          }\n        } else if ($type.isNumber(width)) {\n          w = width;\n        }\n      }\n    }\n    if ($type.isNumber(minWidth)) {\n      w = Math.max(minWidth, w);\n    }\n    if ($type.isNumber(maxWidth)) {\n      w = Math.min(maxWidth, w);\n    }\n    return w;\n  }\n  /**\r\n   * Returns maximum allowed width of this element in pixels.\r\n   *\r\n   * @return Maximum width (px)\r\n   */\n  maxWidth() {\n    let maxWidth = this.get(\"maxWidth\", this.getPrivate(\"maxWidth\"));\n    if ($type.isNumber(maxWidth)) {\n      return maxWidth;\n    } else {\n      let width = this.get(\"width\");\n      if ($type.isNumber(width)) {\n        return width;\n      }\n    }\n    const parent = this.parent;\n    if (parent) {\n      return parent.innerWidth();\n    }\n    return this._root.width();\n  }\n  /**\r\n   * Returns maximum allowed height of this element in pixels.\r\n   *\r\n   * @return Maximum height (px)\r\n   */\n  maxHeight() {\n    let maxHeight = this.get(\"maxHeight\", this.getPrivate(\"maxHeight\"));\n    if ($type.isNumber(maxHeight)) {\n      return maxHeight;\n    } else {\n      let height = this.get(\"height\");\n      if ($type.isNumber(height)) {\n        return height;\n      }\n    }\n    const parent = this.parent;\n    if (parent) {\n      return parent.innerHeight();\n    }\n    return this._root.height();\n  }\n  /**\r\n   * Returns height of this element in pixels.\r\n   *\r\n   * @return Height (px)\r\n   */\n  height() {\n    let height = this.get(\"height\");\n    let maxHeight = this.get(\"maxHeight\", this.getPrivate(\"maxHeight\"));\n    let minHeight = this.get(\"minHeight\", this.getPrivate(\"minHeight\"));\n    let privateHeight = this.getPrivate(\"height\");\n    let h = 0;\n    if ($type.isNumber(privateHeight)) {\n      h = privateHeight;\n    } else {\n      if (height == null) {\n        if (this._adjustedLocalBounds) {\n          h = this._adjustedLocalBounds.bottom - this._adjustedLocalBounds.top;\n        }\n      } else {\n        if (height instanceof Percent) {\n          const parent = this.parent;\n          if (parent) {\n            h = parent.innerHeight() * height.value;\n          } else {\n            h = this._root.height() * height.value;\n          }\n        } else if ($type.isNumber(height)) {\n          h = height;\n        }\n      }\n    }\n    if ($type.isNumber(minHeight)) {\n      h = Math.max(minHeight, h);\n    }\n    if ($type.isNumber(maxHeight)) {\n      h = Math.min(maxHeight, h);\n    }\n    return h;\n  }\n  _findStaticTemplate(f) {\n    // templateField overrides template\n    if (this._templateField && f(this._templateField)) {\n      return this._templateField;\n    }\n    return super._findStaticTemplate(f);\n  }\n  _walkParents(f) {\n    if (this._parent) {\n      this._walkParent(f);\n    }\n  }\n  _walkParent(f) {\n    if (this._parent) {\n      this._parent._walkParent(f);\n    }\n    f(this);\n  }\n  /**\r\n   * Parent [[Container]] of this element.\r\n   *\r\n   * @return Parent container\r\n   */\n  get parent() {\n    return this._parent;\n  }\n  _setParent(parent) {\n    let updateChildren = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    const prevParent = this._parent;\n    if (parent !== prevParent) {\n      this.markDirtyBounds();\n      parent.markDirty();\n      this._parent = parent;\n      if (updateChildren) {\n        this._removeParent(prevParent);\n        if (parent) {\n          this._addPercentageSizeChildren();\n          this._addPercentagePositionChildren();\n        }\n      }\n      this.markDirtyPosition();\n      this._applyThemes();\n    }\n  }\n  /**\r\n   * Returns an instance of [[NumberFormatter]] used in this element.\r\n   *\r\n   * If this element does not have it set, global one form [[Root]] is used.\r\n   *\r\n   * @see {@link https://www.amcharts.com/docs/v5/concepts/using-formatters/} for more info\r\n   * @return NumberFormatter instace\r\n   */\n  getNumberFormatter() {\n    return this.get(\"numberFormatter\", this._root.numberFormatter);\n  }\n  /**\r\n   * Returns an instance of [[DateFormatter]] used in this element.\r\n   *\r\n   * If this element does not have it set, global one form [[Root]] is used.\r\n   *\r\n   * @see {@link https://www.amcharts.com/docs/v5/concepts/using-formatters/} for more info\r\n   * @return DateFormatter instace\r\n   */\n  getDateFormatter() {\n    return this.get(\"dateFormatter\", this._root.dateFormatter);\n  }\n  /**\r\n   * Returns an instance of [[DurationFormatter]] used in this element.\r\n   *\r\n   * If this element does not have it set, global one form [[Root]] is used.\r\n   *\r\n   * @see {@link https://www.amcharts.com/docs/v5/concepts/using-formatters/} for more info\r\n   * @return DurationFormatter instace\r\n   */\n  getDurationFormatter() {\n    return this.get(\"durationFormatter\", this._root.durationFormatter);\n  }\n  /**\r\n   * Converts X/Y coordinate within this element to a global coordinate.\r\n   *\r\n   * @param  point  Local coordinate\r\n   * @return        Global coordinate\r\n   */\n  toGlobal(point) {\n    return this._display.toGlobal(point);\n  }\n  /**\r\n   * Converts global X/Y coordinate to a coordinate within this element.\r\n   *\r\n   * @param  point  Global coordinate\r\n   * @return        Local coordinate\r\n   */\n  toLocal(point) {\n    return this._display.toLocal(point);\n  }\n  _getDownPoint() {\n    const id = this._getDownPointId();\n    if (id) {\n      return this._downPoints[id];\n    }\n  }\n  _getDownPointId() {\n    if (this._downPoints) {\n      return $object.keysOrdered(this._downPoints, (a, b) => {\n        if (a > b) {\n          return 1;\n        }\n        if (a < b) {\n          return -1;\n        }\n        return 0;\n      })[0];\n    }\n  }\n  /**\r\n   * Moves sprite to the end of the parent's children array.\r\n   *\r\n   * Depending on `layout` setting of the parten container, it may effect the\r\n   * positioning or overlapping order of the elements.\r\n   */\n  toFront() {\n    const parent = this.parent;\n    if (parent) {\n      parent.children.moveValue(this, parent.children.length - 1);\n    }\n  }\n  /**\r\n   * Moves sprite to the beginning of the parent's children array.\r\n   *\r\n   * Depending on `layout` setting of the parten container, it may effect the\r\n   * positioning or overlapping order of the elements.\r\n   */\n  toBack() {\n    const parent = this.parent;\n    if (parent) {\n      parent.children.moveValue(this, 0);\n    }\n  }\n}\nObject.defineProperty(Sprite, \"className\", {\n  enumerable: true,\n  configurable: true,\n  writable: true,\n  value: \"Sprite\"\n});\nObject.defineProperty(Sprite, \"classNames\", {\n  enumerable: true,\n  configurable: true,\n  writable: true,\n  value: Entity.classNames.concat([Sprite.className])\n});","map":{"version":3,"names":["Entity","Template","Percent","EventDispatcher","MultiDisposer","CounterDisposer","waitForAnimations","$utils","$array","$type","$object","$math","SpriteEventDispatcher","constructor","sprite","Object","defineProperty","_sprite","_makePointerEvent","key","event","type","originalEvent","point","simulated","native","target","_onRenderer","dispatch","set","_display","interactive","events","_rendererDisposers","undefined","disposer","on","e","call","dispose","increment","_on","once","callback","context","shouldClone","info","rendererEvent","RENDERER_EVENTS","stopParentDispatch","_dispatchParents","dispatchParents","old","parent","click","isEnabled","isDragging","_hasDown","_hasMoved","rightclick","middleclick","dblclick","pointerover","getPrivate","_getBounds","bounds","globalBounds","isType","strokeWidth","get","left","right","top","bottom","inBounds","_root","_renderer","removeHovering","pointerout","pointerdown","pointerup","globalpointerup","globalpointermove","wheel","Sprite","_afterNew","setPrivateRaw","markDirtyKey","_markDirtyKey","markDirtyBounds","_addPercentagePositionChildren","markDirtyPosition","_markDirtyPrivateKey","_removeTemplateField","_templateField","_removeObjectTemplate","_createEvents","_processTemplateField","template","field","dataItem","dataContext","new","_setObjectTemplate","_applyTemplates","_setDataItem","oldDataItem","_dataItem","eventType","newDataItem","value","_parent","_addPercentageSizeChildren","pushOne","_percentageSizeChildren","removeFirst","_percentagePositionChildren","_addDirtyPosition","updatePivotPoint","_localBounds","centerX","pivot","x","relativeToValue","centerY","y","_beforeChanged","_handleStates","isDirty","previous","_prevSettings","tooltip","setLayer","markDirtyLayer","tooltipMoveDp","_tooltipMoveDp","tooltipPointerDp","_tooltipPointerDp","isHover","showTooltip","_statesHandled","states","applyAnimate","isHidden","markDirtyAccessibility","_changed","display","draggable","_dragDp","ev","dragStart","dragMove","dragStop","cancelTouch","tooltipText","tooltipHTML","showTooltipOn","_tooltipDp","setTimeout","getTooltip","hideTooltip","addEventListener","document","_ev","_disposers","push","toggleKey","_toggleDp","_isDragging","alpha","Math","max","angle","scale","isPrivateDirty","visible","markDirty","_prevWidth","_sizeDirty","_updateSize","wheelable","_registerTabindexOrder","_unregisterTabindexOrder","filter","blur","saturate","brightness","contrast","sepia","hue","invert","cursorOverStyle","_focusDp","exportable","isDisposed","_hoverDp","isTouchEvent","_handleOver","_handleOut","_isDown","_handleUp","_handleDown","inactive","_dragEvent","_dragPoint","lookup","_downPoint","pointerId","getPointerId","_downPoints","keys","length","downPoint","abs","dragEvent","dragPoint","cos","sin","hypot","getLocalBounds","depth","self","markDirtySize","_addDirtyBounds","isMeasured","invalidateBounds","isFocus","_invalidateAccessibility","_updateBounds","oldBounds","_adjustedLocalBounds","newBounds","_fixMinBounds","getAdjustedBounds","minWidth","minHeight","isNumber","privateWidth","privateHeight","_removeParent","children","removeValue","_clearDirty","hover","unhover","tooltipPosition","tooltipTarget","_setMatrix","toGlobal","_getTooltipPoint","label","width","height","text","markDirtyText","promise","show","timeout","hide","_updatePosition","dx","dy","_x","xx","yy","position","innerWidth","_y","innerHeight","_dispose","_removeFocusElement","adjustedLocalBounds","localBounds","p0","p1","p2","p3","min","_onShow","_duration","_onHide","appear","duration","delay","Promise","success","_error","_isShowing","_isHidden","_isHiding","animations","state","create","isShowing","isHiding","hovering","focused","isVisible","isVisibleDeep","compositeOpacity","opacity","compositeScale","compositeRotation","rotation","maxWidth","w","maxHeight","h","_findStaticTemplate","f","_walkParents","_walkParent","_setParent","updateChildren","arguments","prevParent","_applyThemes","getNumberFormatter","numberFormatter","getDateFormatter","dateFormatter","getDurationFormatter","durationFormatter","toLocal","_getDownPoint","id","_getDownPointId","keysOrdered","a","b","toFront","moveValue","toBack","classNames","concat","className"],"sources":["C:\\Users\\Moham\\Downloads\\Github projects\\Digital-Portfolio-main\\Frontend\\node_modules\\src\\.internal\\core\\render\\Sprite.ts"],"sourcesContent":["import type { IDisplayObject, IRendererEvents, IRendererEvent, IPointerEvent, IMargin } from \"./backend/Renderer\";\nimport type { IBounds } from \"../util/IBounds\";\nimport type { Container } from \"./Container\";\nimport type { IAccessibilitySettings } from \"../util/Accessibility\";\nimport type { NumberFormatter } from \"../util/NumberFormatter\";\nimport type { DateFormatter } from \"../util/DateFormatter\";\nimport type { DurationFormatter } from \"../util/DurationFormatter\";\nimport type { DataItem, IComponentDataItem } from \"./Component\";\nimport type { Graphics } from \"./Graphics\";\nimport type { IPoint } from \"../util/IPoint\";\nimport type { ListTemplate } from \"../util/List\";\n\nimport type { Tooltip } from \"./Tooltip\";\nimport { Entity, IEntitySettings, IEntityPrivate, IEntityEvents } from \"../util/Entity\";\nimport { Template } from \"../util/Template\";\nimport { Percent } from \"../util/Percent\";\nimport { EventDispatcher, Events, EventListener } from \"../util/EventDispatcher\";\nimport { IDisposer, MultiDisposer, CounterDisposer } from \"../util/Disposer\";\nimport { waitForAnimations } from \"../util/Animation\";\n\nimport * as $utils from \"../util/Utils\";\nimport * as $array from \"../util/Array\";\nimport * as $type from \"../util/Type\";\nimport * as $object from \"../util/Object\";\nimport * as $math from \"../util/Math\";\n//import { populateString } from \"../util/PopulateString\";\n\n\n/**\n * An [[EventDispatcher]] for [[Sprite]].\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/events/} for more info\n */\nclass SpriteEventDispatcher<Target, E extends Events<Target, ISpriteEvents>> extends EventDispatcher<E> {\n\tprotected static RENDERER_EVENTS: { [K in keyof IRendererEvents]?: <E extends Events<Sprite, ISpriteEvents>>(this: SpriteEventDispatcher<Sprite, E>, event: IRendererEvents[K]) => void } = {\n\t\t\"click\": function (event) {\n\t\t\tif (this.isEnabled(\"click\") && !this._sprite.isDragging() && this._sprite._hasDown() && !this._sprite._hasMoved(this._makePointerEvent(\"click\", event))) {\n\t\t\t\tthis.dispatch(\"click\", this._makePointerEvent(\"click\", event));\n\t\t\t}\n\t\t},\n\n\t\t\"rightclick\": function (event) {\n\t\t\tif (this.isEnabled(\"rightclick\")) {\n\t\t\t\tthis.dispatch(\"rightclick\", this._makePointerEvent(\"rightclick\", event));\n\t\t\t}\n\t\t},\n\n\t\t\"middleclick\": function (event) {\n\t\t\tif (this.isEnabled(\"middleclick\")) {\n\t\t\t\tthis.dispatch(\"middleclick\", this._makePointerEvent(\"middleclick\", event));\n\t\t\t}\n\t\t},\n\n\t\t\"dblclick\": function (event) {\n\t\t\tthis.dispatchParents(\"dblclick\", this._makePointerEvent(\"dblclick\", event));\n\t\t},\n\n\t\t\"pointerover\": function (event) {\n\n\t\t\tconst sprite = this._sprite;\n\t\t\tlet dispatch = true;\n\n\t\t\tif (sprite.getPrivate(\"trustBounds\")) {\n\t\t\t\tsprite._getBounds()\n\t\t\t\tconst bounds = sprite.globalBounds();\n\n\t\t\t\tif (sprite.isType<Graphics>(\"Graphics\")) {\n\t\t\t\t\tconst strokeWidth = sprite.get(\"strokeWidth\", 1) / 2;\n\t\t\t\t\tif (strokeWidth >= 1) {\n\t\t\t\t\t\tbounds.left -= strokeWidth;\n\t\t\t\t\t\tbounds.right += strokeWidth;\n\t\t\t\t\t\tbounds.top -= strokeWidth;\n\t\t\t\t\t\tbounds.bottom += strokeWidth;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!$math.inBounds(event.point, bounds)) {\n\t\t\t\t\tdispatch = false;\n\t\t\t\t\tsprite._root._renderer.removeHovering(sprite._display);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (dispatch && this.isEnabled(\"pointerover\")) {\n\t\t\t\tthis.dispatch(\"pointerover\", this._makePointerEvent(\"pointerover\", event));\n\t\t\t}\n\t\t},\n\n\t\t\"pointerout\": function (event) {\n\t\t\tif (this.isEnabled(\"pointerout\")) {\n\t\t\t\tthis.dispatch(\"pointerout\", this._makePointerEvent(\"pointerout\", event));\n\t\t\t}\n\t\t},\n\n\t\t\"pointerdown\": function (event) {\n\t\t\tthis.dispatchParents(\"pointerdown\", this._makePointerEvent(\"pointerdown\", event));\n\t\t},\n\n\t\t\"pointerup\": function (event) {\n\t\t\tif (this.isEnabled(\"pointerup\")) {\n\t\t\t\tthis.dispatch(\"pointerup\", this._makePointerEvent(\"pointerup\", event));\n\t\t\t}\n\t\t},\n\n\t\t\"globalpointerup\": function (event) {\n\t\t\tif (this.isEnabled(\"globalpointerup\")) {\n\t\t\t\tthis.dispatch(\"globalpointerup\", this._makePointerEvent(\"globalpointerup\", event));\n\t\t\t}\n\t\t},\n\n\t\t\"globalpointermove\": function (event) {\n\t\t\tif (this.isEnabled(\"globalpointermove\")) {\n\t\t\t\tthis.dispatch(\"globalpointermove\", this._makePointerEvent(\"globalpointermove\", event));\n\t\t\t}\n\t\t},\n\n\t\t\"wheel\": function (event) {\n\t\t\tthis.dispatchParents(\"wheel\", {\n\t\t\t\ttype: \"wheel\",\n\t\t\t\ttarget: this._sprite,\n\t\t\t\toriginalEvent: event.event,\n\t\t\t\tpoint: event.point,\n\t\t\t});\n\t\t},\n\t};\n\n\tprotected _sprite: Sprite;\n\n\tprotected _rendererDisposers: { [K in keyof IRendererEvents]?: CounterDisposer } = {};\n\n\tprotected _dispatchParents: boolean = true;\n\n\tconstructor(sprite: Sprite) {\n\t\tsuper();\n\t\tthis._sprite = sprite;\n\t}\n\n\tprotected _makePointerEvent<K extends keyof E>(key: K, event: IRendererEvent<IPointerEvent>): ISpritePointerEvent & { type: K } {\n\t\treturn {\n\t\t\ttype: key,\n\t\t\toriginalEvent: event.event,\n\t\t\tpoint: event.point,\n\t\t\tsimulated: event.simulated,\n\t\t\tnative: event.native,\n\t\t\ttarget: this._sprite\n\t\t};\n\t}\n\n\tprotected _onRenderer<Key extends keyof IRendererEvents>(key: Key, dispatch: (this: this, event: IRendererEvents[Key]) => void): IDisposer {\n\t\t// TODO: is this OK? it'd be good not to require to set this on each individual element\n\t\tthis._sprite.set(\"interactive\", true);\n\t\tthis._sprite._display.interactive = true;\n\n\t\tlet events = this._rendererDisposers[key];\n\n\t\tif (events === undefined) {\n\t\t\tconst disposer = this._sprite._display.on(key, (e) => {\n\t\t\t\tdispatch.call(this, e);\n\t\t\t});\n\n\t\t\tevents = this._rendererDisposers[key] = new CounterDisposer(() => {\n\t\t\t\tdelete this._rendererDisposers[key];\n\t\t\t\tdisposer.dispose();\n\t\t\t});\n\t\t}\n\n\t\treturn events.increment();\n\t}\n\n\tprotected _on<C, Key extends keyof E>(once: boolean, type: Key | null, callback: any, context: C, shouldClone: boolean, dispatch: (type: Key, event: E[Key]) => void): EventListener {\n\t\tconst info = super._on(once, type, callback, context, shouldClone, dispatch);\n\n\t\tconst rendererEvent = (SpriteEventDispatcher.RENDERER_EVENTS as any)[type];\n\t\tif (rendererEvent !== undefined) {\n\t\t\tinfo.disposer = new MultiDisposer([\n\t\t\t\tinfo.disposer,\n\t\t\t\tthis._onRenderer(type as any, rendererEvent),\n\t\t\t]);\n\t\t}\n\n\t\treturn info;\n\t}\n\n\t/**\n\t * Will stop any bubbling up of the event to element's parents.\n\t *\n\t * Should be called in an event handler, e.g.:\n\t *\n\t * ```TypeScript\n\t * element.events.on(\"pointerdown\", function(ev) {\n\t *   // Do something here and prevent from \"pointerdown\" bubbling up\n\t *   // ...\n\t *   ev.target.events.stopParentDispatch();\n\t * });\n\t * ```\n\t * ```JavaScript\n\t * element.events.on(\"pointerdown\", function(ev) {\n\t *   // Do something here and prevent from \"pointerdown\" bubbling up\n\t *   // ...\n\t *   ev.target.events.stopParentDispatch();\n\t * });\n\t * ```\n\t */\n\tpublic stopParentDispatch() {\n\t\tthis._dispatchParents = false;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic dispatchParents<Key extends keyof E>(type: Key, event: E[Key]): void {\n\t\tconst old = this._dispatchParents;\n\n\t\tthis._dispatchParents = true;\n\n\t\ttry {\n\t\t\tthis.dispatch(type, event);\n\n\t\t\tif (this._dispatchParents && this._sprite.parent) {\n\t\t\t\tthis._sprite.parent.events.dispatchParents(type as any, event);\n\t\t\t}\n\n\t\t} finally {\n\t\t\tthis._dispatchParents = old;\n\t\t}\n\t}\n}\n\n\nexport interface ISpriteSettings extends IEntitySettings, IAccessibilitySettings {\n\n\t/**\n\t * X position relative to parent.\n\t */\n\tx?: number | Percent | null;\n\n\t/**\n\t * Y position relative to parent.\n\t */\n\ty?: number | Percent | null;\n\n\t/**\n\t * Element's absolute width in pixels (numeric value) or relative width to\n\t * parent ([[Percent]]);\n\t */\n\twidth?: number | Percent | null;\n\n\t/**\n\t * Element's absolute height in pixels (numeric value) or relative height to\n\t * parent ([[Percent]]);\n\t */\n\theight?: number | Percent | null;\n\n\t/**\n\t * Maximum allowed width in pixels.\n\t */\n\tmaxWidth?: number | null;\n\n\t/**\n\t * Maximum allowed height in pixels.\n\t */\n\tmaxHeight?: number | null;\n\n\t/**\n\t * Minimum allowed width in pixels.\n\t */\n\tminWidth?: number | null;\n\n\t/**\n\t * Minimum allowed height in pixels.\n\t */\n\tminHeight?: number | null;\n\n\t/**\n\t * Opacity. 0 - fully transparent; 1 - fully opaque.\n\t */\n\topacity?: number;\n\n\t/**\n\t * Rotation in degrees.\n\t */\n\trotation?: number;\n\n\t/**\n\t * Scale.\n\t *\n\t * Setting to a value less than 1 will shrink object.\n\t */\n\tscale?: number;\n\n\t/**\n\t * X coordinate of the center of the element relative to itself.\n\t *\n\t * Center coordinates will affect placement as well as rotation pivot point.\n\t */\n\tcenterX?: number | Percent;\n\n\t/**\n\t * Y coordinate of the center of the element relative to itself.\n\t *\n\t * Center coordinates will affect placement as well as rotation pivot point.\n\t */\n\tcenterY?: number | Percent;\n\n\t/**\n\t * Left margin in pixels.\n\t */\n\tmarginLeft?: number;\n\n\t/**\n\t * Right margin in pixels.\n\t */\n\tmarginRight?: number;\n\n\t/**\n\t * Top margin in pixels.\n\t */\n\tmarginTop?: number;\n\n\t/**\n\t * Bottom margin in pixels.\n\t */\n\tmarginBottom?: number;\n\n\t/**\n\t * Is element visible?\n\t */\n\tvisible?: boolean;\n\n\t/**\n\t * Positioning of the element.\n\t *\n\t * `\"absolute\"` means element will not participate in parent layout scheme,\n\t * and will be positioned solely accoridng its `x` and `y` settings.\n\t */\n\tposition?: \"absolute\" | \"relative\";\n\n\t/**\n\t * Horizontal shift in pixels. Can be negative to shift leftward.\n\t */\n\tdx?: number;\n\n\t/**\n\t * Vertical shift in pixels. Can be negative to shift upward.\n\t */\n\tdy?: number;\n\n\t/**\n\t * Should this element accept user interaction events?\n\t */\n\tinteractive?: boolean;\n\n\t/**\n\t * Text to show in a tooltip when hovered.\n\t */\n\ttooltipText?: string;\n\n\t/**\n\t * HTML content to show in a tooltip when hovered.\n\t *\n\t * @since 5.2.11\n\t */\n\ttooltipHTML?: string;\n\n\t/**\n\t * Tooltip pointer X coordinate relative to the element itself.\n\t */\n\ttooltipX?: number | Percent;\n\n\t/**\n\t * Tooltip pointer Y coordinate relative to the element itself.\n\t */\n\ttooltipY?: number | Percent;\n\n\t/**\n\t * [[Tooltip]] instance.\n\t */\n\ttooltip?: Tooltip;\n\n\t/**\n\t * Tooltip position.\n\t */\n\ttooltipPosition?: \"fixed\" | \"pointer\";\n\n\t/**\n\t * If set to `false` element will not be measured and cannot participate in\n\t * layout schemes.\n\t */\n\tisMeasured?: boolean;\n\n\t/**\n\t * Allows binding element's settings to data.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/settings/template-fields/} for more info\n\t */\n\ttemplateField?: string;\n\n\t/**\n\t * If set to `true`, user will be able to drag this element. It will also\n\t * disable default drag events over the area of this element.\n\t */\n\tdraggable?: boolean;\n\n\t/**\n\t * If set to `true`, mouse wheel events will be triggered over the element. It\n\t * will also disable page scrolling using mouse wheel when pointer is over\n\t * the element.\n\t */\n\twheelable?: boolean;\n\n\t/**\n\t * An instance of [[NumberFormatter]] that should be used instead of global\n\t * formatter object.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/using-formatters/} for more info\n\t */\n\tnumberFormatter?: NumberFormatter | undefined;\n\n\t/**\n\t * An instance of [[DateFormatter]] that should be used instead of global\n\t * formatter object.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/using-formatters/} for more info\n\t */\n\tdateFormatter?: DateFormatter | undefined;\n\n\t/**\n\t * An instance of [[DurationFormatter]] that should be used instead of global\n\t * formatter object.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/using-formatters/} for more info\n\t */\n\tdurationFormatter?: DurationFormatter | undefined;\n\n\t/**\n\t * If set, element will toggle specified boolean setting between `true` and\n\t * `false` when clicked/touched.\n\t */\n\ttoggleKey?: \"disabled\" | \"active\" | \"none\" | undefined;\n\n\t/**\n\t * Indicates if element is currently active.\n\t */\n\tactive?: boolean;\n\n\t/**\n\t * Indicates if element is disabled.\n\t */\n\tdisabled?: boolean;\n\n\t/**\n\t * An SVG filter to apply to the element.\n\t *\n\t * IMPORTANT: SVG filters are not supported in some browsers, e.g. Safari.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/filters/#SVG_filters} for more info\n\t * @ignore todo: figure out if we still need this\n\t */\n\tfilter?: string;\n\n\t/**\n\t * A named mouse cursor style to show when hovering this element.\n\t *\n\t * @see {@link https://developer.mozilla.org/en-US/docs/Web/CSS/cursor} for more info\n\t */\n\tcursorOverStyle?: string;\n\n\t/**\n\t * If set to `false` this element will not appear in exported snapshots of\n\t * the chart.\n\t */\n\texportable?: boolean;\n\n\t/**\n\t * Numeric layer to put element in.\n\t *\n\t * Elements with higher number will appear in front of the ones with lower\n\t * numer.\n\t *\n\t * If not set, will inherit layer from its ascendants.\n\t */\n\tlayer?: number;\n\n\t/**\n\t * Margins for the layer.\n\t *\n\t * Can be used to make the layer larger/or smaller than default chart size.\n\t *\n\t * @since @5.2.39\n\t */\n\tlayerMargin?: IMargin;\n\n\t/**\n\t * If set to `true` the element will be hidden regardless of `visible` or\n\t * even if `show()` is called.\n\t */\n\tforceHidden?: boolean;\n\n\t/**\n\t * If set to `true` the element will be inactive - absolutely oblivious\n\t * to all interactions, even if there are related events set, or\n\t * the `interactive: true` is set.\n\t *\n\t * @since 5.0.21\n\t */\n\tforceInactive?: boolean;\n\n\t/**\n\t * Defines when tooltip is shown over the element.\n\t *\n\t * Available options:\n\t * * `\"hover\"` (default) - tooltip is shown when element is hovered by a pointer or touched. It is hidden as soon as element is not hovered anymore, or touch occurs outside it.\n\t * * `\"always\"` - a tooltip will always be shown over the element, without any interactions. Please note that if you need to show tooltips for multiple elements at the same time, you need to explicitly create a `Tooltip` instance and set element's `tooltip` setting with it.\n\t * * '\"click\"' - a tooltip will only appear when target element is clicked/tapped. Tooltip will hide when clicking anywhere else on the page.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Sticky_tooltips} for more info\n\t * @default \"hover\"\n\t * @since 5.0.16\n\t */\n\tshowTooltipOn?: \"hover\" | \"always\" | \"click\";\n\n\t/**\n\t * If set to `true`, an element will try to draw itself in such way, that it\n\t * looks crisp on screen, with minimal anti-aliasing.\n\t *\n\t * It will round x/y position so it is positioned fine \"on pixel\".\n\t *\n\t * It will also adjust `strokeWidth` based on device pixel ratio or zoom,\n\t * so the line might look thinner than expected.\n\t *\n\t * NOTE: this is might not universally work, especially when set on several\n\t * objects that are supposed to fit perfectly with each other.\n\t *\n\t * @default false\n\t * @since 5.3.0\n\t */\n\tcrisp?: boolean;\n\n\t/**\n\t * Apply blur filter.\n\t *\n\t * Ranges of values in pixels: `0` to `X`.\n\t *\n\t * IMPORTANT: This setting is not supported in Safari browsers.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/filters/} for more info\n\t * @since 5.5.0\n\t */\n\tblur?: number;\n\n\t/**\n\t * Modifty visual brightness.\n\t *\n\t * Range of values: `0` to `1`.\n\t *\n\t * IMPORTANT: This setting is not supported in Safari browsers.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/filters/} for more info\n\t * @since 5.5.0\n\t */\n\tbrightness?: number;\n\n\t/**\n\t * Modify contrast.\n\t *\n\t * Range of values: `0` to `1`.\n\t *\n\t * IMPORTANT: This setting is not supported in Safari browsers.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/filters/} for more info\n\t * @since 5.5.0\n\t */\n\tcontrast?: number;\n\n\t/**\n\t * Modify saturation.\n\t *\n\t * Range of values in pixels: `0` to `X`.\n\t *\n\t * * `0` - grayscale\n\t * * `1` - no changes\n\t * * `>1` - more saturated\n\t *\n\t * IMPORTANT: This setting is not supported in Safari browsers.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/filters/} for more info\n\t * @since 5.5.0\n\t */\n\tsaturate?: number;\n\n\t/**\n\t * Apply sepia filter.\n\t *\n\t * Range of values: `0` (no changes) to `1` (complete sepia).\n\t *\n\t * IMPORTANT: This setting is not supported in Safari browsers.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/filters/} for more info\n\t * @since 5.5.0\n\t */\n\tsepia?: number;\n\n\t/**\n\t * Invert colors.\n\t *\n\t * Range of values: `0` (no changes) to `1` (completely inverted colors).\n\t *\n\t * IMPORTANT: This setting is not supported in Safari browsers.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/filters/} for more info\n\t * @since 5.5.0\n\t */\n\tinvert?: number;\n\n\t/**\n\t * Rotate HUE colors in degrees.\n\t *\n\t * Range of values: `0` to `360`.\n\t *\n\t * IMPORTANT: This setting is not supported in Safari browsers.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/filters/} for more info\n\t * @since 5.5.0\n\t */\n\thue?: number;\n\n}\n\nexport interface ISpritePrivate extends IEntityPrivate {\n\t/**\n\t * @ignore\n\t */\n\tcustomData?: any;\n\n\t/**\n\t * @ignore\n\t */\n\tx?: number;\n\n\t/**\n\t * @ignore\n\t */\n\ty?: number;\n\n\t/**\n\t * @ignore\n\t */\n\twidth?: number;\n\n\t/**\n\t * @ignore\n\t */\n\theight?: number;\n\n\t/**\n\t * @ignore\n\t */\n\tvisible?: boolean;\n\n\t/**\n\t * Is element currently showing a tooltip?\n\t */\n\tshowingTooltip?: boolean;\n\n\t/**\n\t * @ignore\n\t */\n\ttouchHovering?: boolean;\n\n\t/**\n\t * @ignore\n\t */\n\tfocusElement?: {\n\t\tdom: HTMLDivElement,\n\t\tdisposers: Array<IDisposer>,\n\t};\n\n\t/**\n\t * An element tooltip should inherit its colors from.\n\t */\n\ttooltipTarget?: Graphics;\n\n\t/**\n\t * @ignore\n\t */\n\tlist?: ListTemplate<Sprite>;\n\n\t/**\n\t * @ignore\n\t */\n\tmaxWidth?: number | null;\n\n\t/**\n\t * @ignore\n\t */\n\tmaxHeight?: number | null;\n\n\t/**\n\t * @ignore\n\t */\n\tminWidth?: number | null;\n\n\t/**\n\t * @ignore\n\t */\n\tminHeight?: number | null;\n\n\t/**\n\t * If set to `false`, its tabindex will be set to -1, so it does not get\n\t * focused with TAB, regardless whether its public setting `focusable` is\n\t * set to `true`.\n\t *\n\t * @since 5.3.16\n\t */\n\tfocusable?: boolean;\n\n\t/**\n\t * If set to `true`, the sprite will check if a mouse pointer is within\n\t * its bounds before dispatching pointer events.\n\t *\n\t * This helps to solve ghost tooltips problem that sometimes appear while\n\t * moving the pointer over interactive objects.\n\t *\n\t * This is set to `true` by default on `Rectangle` and `Circle`.\n\t *\n\t * @since 5.5.0\n\t */\n\ttrustBounds?: boolean;\n\n}\n\n/**\n * An interface defining event objects that originate from pinter interactions.\n */\nexport interface ISpritePointerEvent {\n\n\t/**\n\t * Original event object that caused the interaction, e.g. [[MouseEvent]].\n\t */\n\toriginalEvent: IPointerEvent;\n\n\t/**\n\t * A point where event originated.\n\t */\n\tpoint: IPoint;\n\n\t/**\n\t * Is it a simulated event, e.g. if the event was generated by code rather\n\t * then actual user interaction.\n\t */\n\tsimulated: boolean;\n\n\t/**\n\t * Whether event originated in chart's container or its children.\n\t */\n\tnative?: boolean;\n\n\t/**\n\t * The element on which the event occurred.\n\t */\n\ttarget: Sprite;\n\n}\n\nexport interface ISpriteEvents extends IEntityEvents {\n\n\t/**\n\t * Invoked when element's data item changes.\n\t */\n\tdataitemchanged: {\n\t\toldDataItem: DataItem<IComponentDataItem> | undefined,\n\t\tnewDataItem: DataItem<IComponentDataItem> | undefined\n\t};\n\n\t/**\n\t * Invoked when element's position (X/Y) changes.\n\t */\n\tpositionchanged: {};\n\n\t/**\n\t * Invoked when element's bounds change due to any manipulation to it.\n\t */\n\tboundschanged: {};\n\n\t/**\n\t * Invoked when element dragging starts.\n\t */\n\tdragstart: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when element dragging stops.\n\t */\n\tdragstop: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when element ois being dragged.\n\t */\n\tdragged: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when element is clicked or tapped.\n\t */\n\tclick: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when element is clicked width the right mouse button.\n\t */\n\trightclick: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when element is clicked with the middle mouse button.\n\t */\n\tmiddleclick: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when element is doubleclicked or tapped twice quickly.\n\t */\n\tdblclick: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when pointer moves over the element.\n\t */\n\tpointerover: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when pointer moves outside the element.\n\t */\n\tpointerout: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when pointer button is pressed or touch starts over the element.\n\t */\n\tpointerdown: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when pointer button is released or touch stops over the element.\n\t */\n\tpointerup: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when pointer button is released or touch stops in the window, even\n\t * outside of the element or even chart area.\n\t */\n\tglobalpointerup: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when pointer is moving anywhere in the window, even outside of the\n\t * element or even chart area.\n\t */\n\tglobalpointermove: ISpritePointerEvent;\n\n\t/**\n\t * Invoked when mouse wheel is spinned while pointer is over the element.\n\t */\n\twheel: {\n\t\toriginalEvent: WheelEvent;\n\t\tpoint: IPoint;\n\t};\n\n\t/**\n\t * Invoked when element gains focus.\n\t */\n\tfocus: {\n\t\toriginalEvent: FocusEvent;\n\t\ttarget: Sprite;\n\t};\n\n\t/**\n\t * Invoked when element loses focus.\n\t */\n\tblur: {\n\t\toriginalEvent: FocusEvent;\n\t\ttarget: Sprite;\n\t};\n\n}\n\n/**\n * A base class for all visual elements.\n *\n * @important\n */\nexport abstract class Sprite extends Entity {\n\tdeclare public _settings: ISpriteSettings;\n\tdeclare public _privateSettings: ISpritePrivate;\n\tdeclare public _events: ISpriteEvents;\n\n\tdeclare public events: SpriteEventDispatcher<this, Events<this, this[\"_events\"]>>;\n\n\tpublic abstract _display: IDisplayObject;\n\n\tpublic _adjustedLocalBounds: IBounds = { left: 0, right: 0, top: 0, bottom: 0 };\n\n\tpublic _localBounds: IBounds = { left: 0, right: 0, top: 0, bottom: 0 };\n\n\tpublic static className: string = \"Sprite\";\n\tpublic static classNames: Array<string> = Entity.classNames.concat([Sprite.className]);\n\n\tpublic _parent: Container | undefined;\n\tprotected _dataItem: DataItem<IComponentDataItem> | undefined;\n\n\tprotected _templateField: Template<this> | undefined;\n\n\tprotected _sizeDirty: boolean = false;\n\n\t// Will be true only when dragging\n\tpublic _isDragging: boolean = false;\n\n\t// The event when the dragging starts\n\tprotected _dragEvent: ISpritePointerEvent | undefined;\n\n\t// The position when dragging starts\n\tprotected _dragPoint: IPoint | undefined;\n\n\tprotected _isHidden: boolean = false;\n\n\tprotected _isShowing: boolean = false;\n\n\tprotected _isHiding: boolean = false;\n\n\tprotected _isDown: boolean = false;\n\tpublic _downPoint: IPoint | undefined;\n\n\tpublic _downPoints: { [index: number]: IPoint } = {};\n\n\tpublic _toggleDp: IDisposer | undefined;\n\n\tprotected _dragDp: MultiDisposer | undefined;\n\n\tprotected _tooltipDp: MultiDisposer | undefined;\n\n\tprotected _hoverDp: MultiDisposer | undefined;\n\n\tprotected _focusDp: MultiDisposer | undefined;\n\n\tprotected _tooltipMoveDp: IDisposer | undefined;\n\n\tprotected _tooltipPointerDp: MultiDisposer | undefined;\n\n\tprotected _statesHandled: boolean = false;\n\n\tprotected _afterNew() {\n\t\tthis.setPrivateRaw(\"visible\", true);\n\t\tsuper._afterNew();\n\t}\n\n\t/**\n\t * Marks some setting as dirty. Could be used to trigger adapter.\n\t * @param key \n\t */\n\tpublic markDirtyKey<Key extends keyof this[\"_settings\"]>(key: Key) {\n\t\tthis._markDirtyKey(key);\n\t}\n\n\tpublic _markDirtyKey<Key extends keyof this[\"_settings\"]>(key: Key) {\n\t\tsuper._markDirtyKey(key);\n\t\tif (key == \"x\" || key == \"y\" || key == \"dx\" || key == \"dy\") {\n\t\t\tthis.markDirtyBounds();\n\t\t\tthis._addPercentagePositionChildren();\n\t\t\tthis.markDirtyPosition();\n\t\t}\n\t}\n\n\tpublic _markDirtyPrivateKey<Key extends keyof this[\"_privateSettings\"]>(key: Key) {\n\t\tsuper._markDirtyPrivateKey(key);\n\t\tif (key == \"x\" || key == \"y\") {\n\t\t\tthis.markDirtyPosition();\n\t\t}\n\t}\n\n\tprotected _removeTemplateField(): void {\n\t\tif (this._templateField) {\n\t\t\tthis._templateField._removeObjectTemplate(this);\n\t\t}\n\t}\n\n\tprotected _createEvents(): SpriteEventDispatcher<this, Events<this, this[\"_events\"]>> {\n\t\treturn new SpriteEventDispatcher(this);\n\t}\n\n\tpublic _processTemplateField(): void {\n\t\tlet template;\n\n\t\tconst field = this.get(\"templateField\");\n\n\t\tif (field) {\n\t\t\tconst dataItem = this.dataItem;\n\t\t\tif (dataItem) {\n\t\t\t\tconst context = dataItem.dataContext;\n\t\t\t\tif (context) {\n\t\t\t\t\ttemplate = (context as any)[field];\n\n\t\t\t\t\tif (!(template instanceof Template) && template) {\n\t\t\t\t\t\ttemplate = Template.new(template);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._templateField !== template) {\n\t\t\tthis._removeTemplateField();\n\n\t\t\tthis._templateField = template;\n\n\t\t\tif (template) {\n\t\t\t\ttemplate._setObjectTemplate(this);\n\t\t\t}\n\n\t\t\tthis._applyTemplates();\n\t\t}\n\t}\n\n\t// TODO change this to run before the element is added to the parent, so that way\n\t//      it doesn't need to apply the themes twice\n\tpublic _setDataItem(dataItem?: DataItem<IComponentDataItem>): void {\n\t\tconst oldDataItem = this._dataItem\n\t\tthis._dataItem = dataItem;\n\t\tthis._processTemplateField();\n\t\tconst eventType = \"dataitemchanged\";\n\t\tif (dataItem != oldDataItem) {\n\t\t\tif (this.events.isEnabled(eventType)) {\n\t\t\t\tthis.events.dispatch(eventType, {\n\t\t\t\t\ttype: eventType,\n\t\t\t\t\ttarget: this,\n\t\t\t\t\toldDataItem: oldDataItem,\n\t\t\t\t\tnewDataItem: dataItem\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * A [[DataItem]] used for this element.\n\t *\n\t * NOTE: data item is being assigned automatically in most cases where it\n\t * matters. Use this accessor to set data item only if you know what you're\n\t * doing.\n\t *\n\t * @param  value  Data item\n\t */\n\tpublic set dataItem(value: DataItem<IComponentDataItem> | undefined) {\n\t\tthis._setDataItem(value);\n\t}\n\n\t/**\n\t * @return DataItem\n\t */\n\tpublic get dataItem(): DataItem<IComponentDataItem> | undefined {\n\t\tif (this._dataItem) {\n\t\t\treturn this._dataItem;\n\n\t\t} else {\n\t\t\tlet parent = this._parent;\n\n\t\t\twhile (parent) {\n\t\t\t\tif (parent._dataItem) {\n\t\t\t\t\treturn parent._dataItem;\n\n\t\t\t\t} else {\n\t\t\t\t\tparent = parent._parent;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _addPercentageSizeChildren() {\n\t\tlet parent = this.parent;\n\t\tif (parent) {\n\t\t\tif (this.get(\"width\") instanceof Percent || this.get(\"height\") instanceof Percent) {\n\t\t\t\t$array.pushOne(parent._percentageSizeChildren, this);\n\t\t\t} else {\n\t\t\t\t$array.removeFirst(parent._percentageSizeChildren, this);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _addPercentagePositionChildren() {\n\t\tlet parent = this.parent;\n\t\tif (parent) {\n\t\t\tif (this.get(\"x\") instanceof Percent || this.get(\"y\") instanceof Percent) {\n\t\t\t\t$array.pushOne(parent._percentagePositionChildren, this);\n\t\t\t} else {\n\t\t\t\t$array.removeFirst(parent._percentagePositionChildren, this);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic markDirtyPosition() {\n\t\tthis._root._addDirtyPosition(this);\n\t}\n\n\tprotected updatePivotPoint() {\n\t\tconst bounds = this._localBounds;\n\t\tif (bounds) {\n\t\t\tconst centerX = this.get(\"centerX\");\n\t\t\tif (centerX != null) {\n\t\t\t\tthis._display.pivot.x = bounds.left + $utils.relativeToValue(centerX!, bounds.right - bounds.left);\n\t\t\t}\n\n\t\t\tconst centerY = this.get(\"centerY\");\n\t\t\tif (centerY != null) {\n\t\t\t\tthis._display.pivot.y = bounds.top + $utils.relativeToValue(centerY!, bounds.bottom - bounds.top);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _beforeChanged() {\n\t\tsuper._beforeChanged();\n\n\t\t// handling states in beforeChanged, otherwise states is not applied without animated theme\n\t\tthis._handleStates();\n\n\t\tif (this.isDirty(\"tooltip\")) {\n\t\t\tconst previous = this._prevSettings.tooltip;\n\t\t\tif (previous) {\n\t\t\t\tprevious.dispose();\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"layer\") || this.isDirty(\"layerMargin\")) {\n\t\t\tthis._display.setLayer(this.get(\"layer\"), this.get(\"layerMargin\"));\n\t\t\tthis.markDirtyLayer();\n\t\t}\n\n\t\tif (this.isDirty(\"tooltipPosition\")) {\n\t\t\tconst tooltipMoveDp = this._tooltipMoveDp;\n\t\t\tif (tooltipMoveDp) {\n\t\t\t\ttooltipMoveDp.dispose();\n\t\t\t\tthis._tooltipMoveDp = undefined;\n\t\t\t}\n\n\t\t\tconst tooltipPointerDp = this._tooltipPointerDp;\n\t\t\tif (tooltipPointerDp) {\n\t\t\t\ttooltipPointerDp.dispose();\n\t\t\t\tthis._tooltipPointerDp = undefined;\n\t\t\t}\n\n\t\t\tif (this.get(\"tooltipPosition\") == \"pointer\") {\n\n\t\t\t\tif (this.isHover()) {\n\t\t\t\t\tthis._tooltipMoveDp = this.events.on(\"globalpointermove\", (e) => {\n\t\t\t\t\t\tthis.showTooltip(e.point);\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tthis._tooltipPointerDp = new MultiDisposer([\n\t\t\t\t\tthis.events.on(\"pointerover\", () => {\n\t\t\t\t\t\tthis._tooltipMoveDp = this.events.on(\"globalpointermove\", (e) => {\n\t\t\t\t\t\t\tthis.showTooltip(e.point);\n\t\t\t\t\t\t})\n\t\t\t\t\t}),\n\n\t\t\t\t\tthis.events.on(\"pointerout\", () => {\n\t\t\t\t\t\tconst tooltipMoveDp = this._tooltipMoveDp;\n\t\t\t\t\t\tif (tooltipMoveDp) {\n\t\t\t\t\t\t\ttooltipMoveDp.dispose();\n\t\t\t\t\t\t\tthis._tooltipMoveDp = undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t})])\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _handleStates() {\n\t\tif (!this._statesHandled) {\n\t\t\tif (this.isDirty(\"active\")) {\n\t\t\t\tif (this.get(\"active\")) {\n\t\t\t\t\tthis.states.applyAnimate(\"active\");\n\t\t\t\t\tthis.set(\"ariaChecked\", true);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (!this.isHidden()) {\n\t\t\t\t\t\tthis.states.applyAnimate(\"default\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.set(\"ariaChecked\", false);\n\t\t\t\t}\n\t\t\t\tthis.markDirtyAccessibility();\n\t\t\t}\n\n\t\t\tif (this.isDirty(\"disabled\")) {\n\t\t\t\tif (this.get(\"disabled\")) {\n\t\t\t\t\tthis.states.applyAnimate(\"disabled\");\n\t\t\t\t\tthis.set(\"ariaChecked\", false);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (!this.isHidden()) {\n\t\t\t\t\t\tthis.states.applyAnimate(\"default\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.set(\"ariaChecked\", true);\n\t\t\t\t}\n\t\t\t\tthis.markDirtyAccessibility();\n\t\t\t}\n\t\t\tthis._statesHandled = true;\n\t\t}\n\t}\n\n\tpublic _changed() {\n\t\tsuper._changed();\n\n\t\tconst display = this._display;\n\t\tconst events = this.events;\n\n\t\tif (this.isDirty(\"draggable\")) {\n\t\t\tconst draggable = this.get(\"draggable\");\n\t\t\tif (draggable) {\n\t\t\t\tthis.set(\"interactive\", true);\n\n\t\t\t\tthis._dragDp = new MultiDisposer([\n\t\t\t\t\tevents.on(\"pointerdown\", (ev) => {\n\t\t\t\t\t\tthis.dragStart(ev);\n\t\t\t\t\t}),\n\n\t\t\t\t\tevents.on(\"globalpointermove\", (ev) => {\n\t\t\t\t\t\tthis.dragMove(ev);\n\t\t\t\t\t}),\n\n\t\t\t\t\tevents.on(\"globalpointerup\", (ev) => {\n\t\t\t\t\t\tthis.dragStop(ev);\n\t\t\t\t\t})])\n\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this._dragDp) {\n\t\t\t\t\tthis._dragDp.dispose();\n\t\t\t\t\tthis._dragDp = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdisplay.cancelTouch = draggable ? true : false;\n\t\t}\n\n\t\tif (this.isDirty(\"tooltipText\") || this.isDirty(\"tooltipHTML\") || this.isDirty(\"showTooltipOn\")) {\n\t\t\tconst tooltipText = this.get(\"tooltipText\");\n\t\t\tconst tooltipHTML = this.get(\"tooltipHTML\");\n\t\t\tconst showTooltipOn = this.get(\"showTooltipOn\", \"hover\");\n\t\t\tif (this._tooltipDp) {\n\t\t\t\tthis._tooltipDp.dispose();\n\t\t\t\tthis._tooltipDp = undefined;\n\t\t\t}\n\t\t\tif (tooltipText || tooltipHTML) {\n\t\t\t\tif (showTooltipOn == \"click\") {\n\t\t\t\t\tthis._tooltipDp = new MultiDisposer([\n\t\t\t\t\t\tevents.on(\"click\", () => {\n\t\t\t\t\t\t\tthis.setTimeout(() => {\n\t\t\t\t\t\t\t\tconst tooltip = this.getTooltip();\n\t\t\t\t\t\t\t\tif (tooltip && !tooltip.isHidden() && tooltip.get(\"tooltipTarget\") === this) {\n\t\t\t\t\t\t\t\t\tthis.hideTooltip();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tthis.showTooltip();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 10);\n\t\t\t\t\t\t}),\n\t\t\t\t\t\t$utils.addEventListener(document, \"click\", (_ev: MouseEvent) => {\n\t\t\t\t\t\t\tthis.hideTooltip();\n\t\t\t\t\t\t})\n\t\t\t\t\t]);\n\t\t\t\t\tthis._disposers.push(this._tooltipDp);\n\t\t\t\t}\n\t\t\t\telse if (showTooltipOn == \"always\") {\n\t\t\t\t\t// nothing\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._tooltipDp = new MultiDisposer([\n\t\t\t\t\t\tevents.on(\"pointerover\", () => {\n\t\t\t\t\t\t\tthis.showTooltip();\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tevents.on(\"pointerout\", () => {\n\t\t\t\t\t\t\tthis.hideTooltip();\n\t\t\t\t\t\t})\n\t\t\t\t\t]);\n\t\t\t\t\tthis._disposers.push(this._tooltipDp);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"toggleKey\")) {\n\t\t\tlet toggleKey = this.get(\"toggleKey\") as any;\n\t\t\tif (toggleKey && toggleKey != \"none\") {\n\t\t\t\tthis._toggleDp = events.on(\"click\", () => {\n\t\t\t\t\tif (!this._isDragging) {\n\t\t\t\t\t\tthis.set(toggleKey, !this.get(toggleKey));\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this._toggleDp) {\n\t\t\t\t\tthis._toggleDp.dispose();\n\t\t\t\t\tthis._toggleDp = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tif (this.isDirty(\"opacity\")) {\n\t\t\tdisplay.alpha = Math.max(0, this.get(\"opacity\", 1));\n\t\t\tif (this.get(\"focusable\")) {\n\t\t\t\tthis.markDirtyAccessibility();\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"rotation\")) {\n\t\t\tthis.markDirtyBounds();\n\t\t\tdisplay.angle = this.get(\"rotation\", 0);\n\t\t}\n\n\t\tif (this.isDirty(\"scale\")) {\n\t\t\tthis.markDirtyBounds();\n\t\t\tdisplay.scale = this.get(\"scale\", 0);\n\t\t}\n\n\t\tif (this.isDirty(\"centerX\") || this.isDirty(\"centerY\")) {\n\t\t\tthis.markDirtyBounds();\n\t\t\tthis.updatePivotPoint();\n\t\t}\n\n\t\tif (this.isDirty(\"visible\") || this.isPrivateDirty(\"visible\") || this.isDirty(\"forceHidden\")) {\n\t\t\tif (!this.get(\"visible\") || !this.getPrivate(\"visible\") || this.get(\"forceHidden\")) {\n\t\t\t\tdisplay.visible = false;\n\t\t\t\tthis.hideTooltip();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdisplay.visible = true;\n\t\t\t}\n\n\t\t\tthis.markDirtyBounds();\n\t\t\tif (this.get(\"focusable\")) {\n\t\t\t\tthis.markDirtyAccessibility();\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"width\") || this.isDirty(\"height\")) {\n\t\t\tthis.markDirtyBounds();\n\t\t\tthis._addPercentageSizeChildren();\n\n\t\t\tconst parent = this.parent;\n\t\t\tif (parent) {\n\t\t\t\tif ((this.isDirty(\"width\") && this.get(\"width\") instanceof Percent) || (this.isDirty(\"height\") && this.get(\"height\") instanceof Percent)) {\n\t\t\t\t\tparent.markDirty();\n\t\t\t\t\tparent._prevWidth = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._sizeDirty = true;\n\t\t}\n\n\t\tif (this.isDirty(\"maxWidth\") || this.isDirty(\"maxHeight\") || this.isPrivateDirty(\"width\") || this.isPrivateDirty(\"height\") || this.isDirty(\"minWidth\") || this.isDirty(\"minHeight\") || this.isPrivateDirty(\"maxWidth\") || this.isPrivateDirty(\"maxHeight\") || this.isPrivateDirty(\"minWidth\") || this.isPrivateDirty(\"minHeight\") || this.isDirty(\"marginLeft\") || this.isDirty(\"marginTop\") || this.isDirty(\"marginRight\") || this.isDirty(\"marginBottom\")) {\n\t\t\tthis.markDirtyBounds();\n\t\t\tthis._sizeDirty = true;\n\t\t}\n\n\t\tif (this._sizeDirty) {\n\t\t\tthis._updateSize();\n\t\t}\n\n\t\tif (this.isDirty(\"wheelable\")) {\n\t\t\tconst wheelable = this.get(\"wheelable\");\n\t\t\tif (wheelable) {\n\t\t\t\tthis.set(\"interactive\", true);\n\t\t\t}\n\t\t\tdisplay.wheelable = wheelable ? true : false;\n\t\t}\n\n\t\t// Accessibility\n\t\tif (this.isDirty(\"tabindexOrder\") || this.isDirty(\"focusableGroup\")) {\n\t\t\tif (this.get(\"focusable\")) {\n\t\t\t\tthis._root._registerTabindexOrder(this);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._root._unregisterTabindexOrder(this);\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"filter\")) {\n\t\t\t//this.markDirtyBounds();\n\t\t\tdisplay.filter = this.get(\"filter\");\n\t\t}\n\n\t\tlet filter = this.get(\"filter\", \"\");\n\n\t\tif (this.isDirty(\"blur\")) {\n\t\t\tconst blur = this.get(\"blur\", 0);\n\t\t\tif (blur != 0) {\n\t\t\t\tfilter += \" blur(\" + blur + \"px)\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"saturate\")) {\n\t\t\tconst saturate = this.get(\"saturate\", 1);\n\t\t\tif (saturate != 1) {\n\t\t\t\tfilter += \" saturate(\" + saturate + \")\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"brightness\")) {\n\t\t\tconst brightness = this.get(\"brightness\", 1);\n\t\t\tif (brightness != 1) {\n\t\t\t\tfilter += \" brightness(\" + brightness + \")\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"contrast\")) {\n\t\t\tconst contrast = this.get(\"contrast\", 1);\n\t\t\tif (contrast != 1) {\n\t\t\t\tfilter += \" contrast(\" + contrast + \")\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"sepia\")) {\n\t\t\tconst sepia = this.get(\"sepia\", 0);\n\t\t\tif (sepia != 0) {\n\t\t\t\tfilter += \" sepia(\" + sepia + \")\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"hue\")) {\n\t\t\tconst hue = this.get(\"hue\", 0);\n\t\t\tif (hue != 0) {\n\t\t\t\tfilter += \" hue-rotate(\" + hue + \"deg)\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"invert\")) {\n\t\t\tconst invert = this.get(\"invert\", 0);\n\t\t\tif (invert != 0) {\n\t\t\t\tfilter += \" invert(\" + invert + \")\";\n\t\t\t}\n\t\t}\n\n\n\t\tif (filter) {\n\t\t\tdisplay.filter = filter;\n\t\t}\n\n\t\tif (this.isDirty(\"cursorOverStyle\")) {\n\t\t\tdisplay.cursorOverStyle = this.get(\"cursorOverStyle\");\n\t\t}\n\n\t\tif (this.isDirty(\"hoverOnFocus\")) {\n\t\t\tif (this.get(\"hoverOnFocus\")) {\n\t\t\t\tthis._focusDp = new MultiDisposer([\n\t\t\t\t\tevents.on(\"focus\", () => {\n\t\t\t\t\t\t// TODO: proper hover, not just tooltip\n\t\t\t\t\t\tthis.showTooltip();\n\t\t\t\t\t}),\n\n\t\t\t\t\tevents.on(\"blur\", () => {\n\t\t\t\t\t\t// TODO: proper hover, not just tooltip\n\t\t\t\t\t\tthis.hideTooltip();\n\t\t\t\t\t})]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this._focusDp) {\n\t\t\t\t\tthis._focusDp.dispose();\n\t\t\t\t\tthis._focusDp = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"focusable\")) {\n\t\t\tif (this.get(\"focusable\")) {\n\t\t\t\tthis._root._registerTabindexOrder(this);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._root._unregisterTabindexOrder(this);\n\t\t\t}\n\t\t\tthis.markDirtyAccessibility();\n\t\t\tthis._disposers.push(events.on(\"blur\", () => {\n\t\t\t\tthis.setPrivateRaw(\"touchHovering\", false);\n\t\t\t}));\n\t\t}\n\n\t\tif (this.isPrivateDirty(\"focusable\")) {\n\t\t\tthis.markDirtyAccessibility();\n\t\t}\n\n\t\tif (this.isDirty(\"role\") || this.isDirty(\"ariaLive\") || this.isDirty(\"ariaChecked\") || this.isDirty(\"ariaHidden\") || this.isDirty(\"ariaOrientation\") || this.isDirty(\"ariaValueNow\") || this.isDirty(\"ariaValueMin\") || this.isDirty(\"ariaValueMax\") || this.isDirty(\"ariaValueText\") || this.isDirty(\"ariaLabel\") || this.isDirty(\"ariaControls\")) {\n\t\t\t// display.accessibility.ariaLabel = populateString(this, this.get(\"ariaLabel\", \"\"));\n\t\t\t// @todo make sure ariaLabel gets populated in Root\n\t\t\tthis.markDirtyAccessibility();\n\t\t}\n\n\t\tif (this.isDirty(\"exportable\")) {\n\t\t\tdisplay.exportable = this.get(\"exportable\");\n\t\t}\n\n\t\tif (this.isDirty(\"interactive\")) {\n\t\t\tconst events = this.events;\n\t\t\tif (this.get(\"interactive\") && !events.isDisposed()) {\n\t\t\t\tthis._hoverDp = new MultiDisposer([\n\t\t\t\t\tevents.on(\"click\", (ev) => {\n\t\t\t\t\t\tif ($utils.isTouchEvent(ev.originalEvent)) {\n\t\t\t\t\t\t\tif (!this.getPrivate(\"touchHovering\")) {\n\t\t\t\t\t\t\t\tthis.setTimeout(() => {\n\t\t\t\t\t\t\t\t\tthis._handleOver();\n\t\t\t\t\t\t\t\t\tif (this.get(\"tooltipText\") || this.get(\"tooltipHTML\")) {\n\t\t\t\t\t\t\t\t\t\tthis.showTooltip();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthis.setPrivateRaw(\"touchHovering\", true);\n\t\t\t\t\t\t\t\t\tthis.events.dispatch(\"pointerover\", {\n\t\t\t\t\t\t\t\t\t\ttype: \"pointerover\",\n\t\t\t\t\t\t\t\t\t\ttarget: ev.target,\n\t\t\t\t\t\t\t\t\t\toriginalEvent: ev.originalEvent,\n\t\t\t\t\t\t\t\t\t\tpoint: ev.point,\n\t\t\t\t\t\t\t\t\t\tsimulated: ev.simulated\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}, 10)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\n\t\t\t\t\tevents.on(\"globalpointerup\", (ev) => {\n\t\t\t\t\t\tif ($utils.isTouchEvent(ev.originalEvent)) {\n\t\t\t\t\t\t\tif (this.getPrivate(\"touchHovering\")) {\n\t\t\t\t\t\t\t\tthis._handleOut();\n\t\t\t\t\t\t\t\tif (this.get(\"tooltipText\") || this.get(\"tooltipHTML\")) {\n\t\t\t\t\t\t\t\t\tthis.hideTooltip();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.setPrivateRaw(\"touchHovering\", false);\n\t\t\t\t\t\t\t\tthis.events.dispatch(\"pointerout\", {\n\t\t\t\t\t\t\t\t\ttype: \"pointerout\",\n\t\t\t\t\t\t\t\t\ttarget: ev.target,\n\t\t\t\t\t\t\t\t\toriginalEvent: ev.originalEvent,\n\t\t\t\t\t\t\t\t\tpoint: ev.point,\n\t\t\t\t\t\t\t\t\tsimulated: ev.simulated\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this._isDown) {\n\t\t\t\t\t\t\tthis._handleUp(ev);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//this._isDown = false;\n\t\t\t\t\t}),\n\n\t\t\t\t\tevents.on(\"pointerover\", () => {\n\t\t\t\t\t\tthis._handleOver();\n\t\t\t\t\t}),\n\n\t\t\t\t\tevents.on(\"pointerout\", () => {\n\t\t\t\t\t\tthis._handleOut();\n\t\t\t\t\t}),\n\n\t\t\t\t\tevents.on(\"pointerdown\", (e) => {\n\t\t\t\t\t\tthis._handleDown(e);\n\t\t\t\t\t})\n\t\t\t\t])\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._display.interactive = false;\n\t\t\t\tif (this._hoverDp) {\n\t\t\t\t\tthis._hoverDp.dispose();\n\t\t\t\t\tthis._hoverDp = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"forceInactive\")) {\n\t\t\tthis._display.inactive = this.get(\"forceInactive\", null);\n\t\t}\n\n\t\tif (this.get(\"showTooltipOn\") == \"always\" && this._display.visible) {\n\t\t\tthis.showTooltip();\n\t\t}\n\t}\n\n\t/**\n\t * @ignore\n\t * @todo should this be user-accessible?\n\t */\n\tpublic dragStart(e: ISpritePointerEvent) {\n\t\tthis._dragEvent = e;\n\t\tthis.events.stopParentDispatch();\n\t}\n\n\t/**\n\t * @ignore\n\t * @todo should this be user-accessible?\n\t */\n\tpublic dragStop(e: ISpritePointerEvent) {\n\t\tthis._dragEvent = undefined;\n\t\tthis._dragPoint = undefined;\n\t\tthis.events.stopParentDispatch();\n\n\t\tif (this._isDragging) {\n\t\t\tthis._isDragging = false;\n\n\t\t\tconst type = \"dragstop\";\n\t\t\tif (this.events.isEnabled(type)) {\n\t\t\t\tthis.events.dispatch(type, {\n\t\t\t\t\ttype: type,\n\t\t\t\t\ttarget: this,\n\t\t\t\t\toriginalEvent: e.originalEvent,\n\t\t\t\t\tpoint: e.point,\n\t\t\t\t\tsimulated: e.simulated,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _handleOver() {\n\t\tif (!this.isHidden()) {\n\t\t\tif (this.get(\"active\") && this.states.lookup(\"hoverActive\")) {\n\t\t\t\tthis.states.applyAnimate(\"hoverActive\");\n\t\t\t}\n\t\t\telse if (this.get(\"disabled\") && this.states.lookup(\"hoverDisabled\")) {\n\t\t\t\tthis.states.applyAnimate(\"hoverDisabled\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.states.applyAnimate(\"hover\");\n\t\t\t}\n\t\t\tif (this.get(\"draggable\") && this._isDown && this.states.lookup(\"down\")) {\n\t\t\t\tthis.states.applyAnimate(\"down\");\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _handleOut() {\n\t\tif (!this.isHidden()) {\n\t\t\tif (this.get(\"active\") && this.states.lookup(\"active\")) {\n\t\t\t\tthis.states.applyAnimate(\"active\");\n\t\t\t}\n\t\t\telse if (this.get(\"disabled\") && this.states.lookup(\"disabled\")) {\n\t\t\t\tthis.states.applyAnimate(\"disabled\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this.states.lookup(\"hover\") || this.states.lookup(\"hoverActive\")) {\n\t\t\t\t\tthis.states.applyAnimate(\"default\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.get(\"draggable\") && this._isDown && this.states.lookup(\"down\")) {\n\t\t\t\tthis.states.applyAnimate(\"down\");\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _handleUp(e: ISpritePointerEvent) {\n\t\tif (!this.isHidden()) {\n\t\t\tif (this.get(\"active\") && this.states.lookup(\"active\")) {\n\t\t\t\tthis.states.applyAnimate(\"active\");\n\t\t\t}\n\t\t\telse if (this.get(\"disabled\") && this.states.lookup(\"disabled\")) {\n\t\t\t\tthis.states.applyAnimate(\"disabled\");\n\t\t\t}\n\t\t\telse if (this.states.lookup(\"down\")) {\n\t\t\t\tif (this.isHover()) {\n\t\t\t\t\tthis.states.applyAnimate(\"hover\");\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.states.applyAnimate(\"default\");\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\t// @todo remove this once migrated to _downPoints\n\t\t\tthis._downPoint = undefined;\n\n\t\t\tconst pointerId = $utils.getPointerId(e.originalEvent);\n\t\t\tdelete this._downPoints[pointerId];\n\n\t\t\tif ($object.keys(this._downPoints).length == 0) {\n\t\t\t\tthis._isDown = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _hasMoved(e: ISpritePointerEvent): boolean {\n\t\t// @todo remove this once migrated to _downPoints\n\t\t// if (this._downPoint) {\n\t\t// \tconst x = Math.abs(this._downPoint.x - e.point.x);\n\t\t// \tconst y = Math.abs(this._downPoint.y - e.point.y);\n\t\t// \treturn (x > 5) || (y > 5);\n\t\t// }\n\n\t\tconst pointerId = $utils.getPointerId(e.originalEvent);\n\t\tconst downPoint = this._downPoints[pointerId];\n\t\tif (downPoint) {\n\t\t\tconst x = Math.abs(downPoint.x - e.point.x);\n\t\t\tconst y = Math.abs(downPoint.y - e.point.y);\n\t\t\treturn (x > 5) || (y > 5);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic _hasDown(): boolean {\n\t\treturn $object.keys(this._downPoints).length > 0;\n\t}\n\n\tprotected _handleDown(e: ISpritePointerEvent) {\n\n\t\tconst parent = this.parent;\n\t\tif (parent && !this.get(\"draggable\")) {\n\t\t\tparent._handleDown(e);\n\t\t}\n\n\t\tif (this.get(\"interactive\") && !this.isHidden()) {\n\t\t\tif (this.states.lookup(\"down\")) {\n\t\t\t\tthis.states.applyAnimate(\"down\");\n\t\t\t}\n\t\t\tthis._downPoint = {\n\t\t\t\tx: e.point.x,\n\t\t\t\ty: e.point.y\n\t\t\t};\n\n\n\t\t\t// @todo remove this once migrated to _downPoints\n\t\t\tthis._isDown = true;\n\n\t\t\tconst pointerId = $utils.getPointerId(e.originalEvent);\n\t\t\tthis._downPoints[pointerId] = {\n\t\t\t\tx: e.point.x,\n\t\t\t\ty: e.point.y\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * @ignore\n\t * @todo should this be user-accessible?\n\t */\n\tpublic dragMove(e: ISpritePointerEvent) {\n\t\tlet dragEvent = this._dragEvent;\n\n\t\tif (dragEvent) {\n\n\t\t\tif (dragEvent.simulated && !e.simulated) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tlet angle = 0;\n\n\t\t\tlet parent = this.parent;\n\t\t\tlet scale = 1;\n\n\t\t\twhile (parent != null) {\n\t\t\t\tangle += parent.get(\"rotation\", 0);\n\t\t\t\tparent = parent.parent;\n\t\t\t\tif (parent) {\n\t\t\t\t\tscale *= parent.get(\"scale\", 1);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet x = (e.point.x - dragEvent.point.x) / scale;\n\t\t\tlet y = (e.point.y - dragEvent.point.y) / scale;\n\n\t\t\tconst events = this.events;\n\n\t\t\tif (dragEvent.simulated && !this._isDragging) {\n\t\t\t\tthis._isDragging = true;\n\t\t\t\tthis._dragEvent = e;\n\n\t\t\t\tthis._dragPoint = {\n\t\t\t\t\tx: this.x(),\n\t\t\t\t\ty: this.y()\n\t\t\t\t};\n\n\t\t\t\tconst type = \"dragstart\";\n\t\t\t\tif (events.isEnabled(type)) {\n\t\t\t\t\tevents.dispatch(type, {\n\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\ttarget: this,\n\t\t\t\t\t\toriginalEvent: e.originalEvent,\n\t\t\t\t\t\tpoint: e.point,\n\t\t\t\t\t\tsimulated: e.simulated,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this._isDragging) {\n\t\t\t\tlet dragPoint = this._dragPoint!;\n\n\t\t\t\tthis.set(\"x\", dragPoint.x + x * $math.cos(angle) + y * $math.sin(angle));\n\t\t\t\tthis.set(\"y\", dragPoint.y + y * $math.cos(angle) - x * $math.sin(angle));\n\n\t\t\t\tconst type = \"dragged\";\n\t\t\t\tif (events.isEnabled(type)) {\n\t\t\t\t\tevents.dispatch(type, {\n\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\ttarget: this,\n\t\t\t\t\t\toriginalEvent: e.originalEvent,\n\t\t\t\t\t\tpoint: e.point,\n\t\t\t\t\t\tsimulated: e.simulated,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tif (Math.hypot(x, y) > 5) {\n\t\t\t\t\tthis._isDragging = true;\n\t\t\t\t\tthis._dragEvent = e;\n\n\t\t\t\t\tthis._dragPoint = {\n\t\t\t\t\t\tx: this.x(),\n\t\t\t\t\t\ty: this.y()\n\t\t\t\t\t};\n\n\t\t\t\t\tconst type = \"dragstart\";\n\t\t\t\t\tif (events.isEnabled(type)) {\n\t\t\t\t\t\tevents.dispatch(type, {\n\t\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\t\ttarget: this,\n\t\t\t\t\t\t\toriginalEvent: e.originalEvent,\n\t\t\t\t\t\t\tpoint: e.point,\n\t\t\t\t\t\t\tsimulated: e.simulated\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _updateSize() {\n\n\t}\n\n\tpublic _getBounds() {\n\t\tthis._localBounds = this._display.getLocalBounds();\n\t}\n\n\t/**\n\t * Returns depth (how deep in the hierachy of the content tree) of this\n\t * element.\n\t *\n\t * @return Depth\n\t */\n\tpublic depth(): number {\n\t\tlet self: Container | undefined = this.parent;\n\t\tlet depth = 0;\n\n\t\twhile (true) {\n\t\t\tif (self) {\n\t\t\t\t++depth;\n\t\t\t\tself = self.parent;\n\n\t\t\t} else {\n\t\t\t\treturn depth;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic markDirtySize(): void {\n\t\tthis._sizeDirty = true;\n\t\tthis.markDirty();\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic markDirtyBounds(): void {\n\t\tconst display = this._display;\n\t\tif (this.get(\"isMeasured\")) {\n\t\t\tthis._root._addDirtyBounds(this);\n\t\t\tdisplay.isMeasured = true;\n\t\t\tdisplay.invalidateBounds();\n\n\t\t\tconst parent = this.parent;\n\n\t\t\tif (parent && this.get(\"position\") != \"absolute\") {\n\t\t\t\tif (parent.get(\"width\") == null || parent.get(\"height\") == null || parent.get(\"layout\")) {\n\t\t\t\t\tparent.markDirtyBounds();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.get(\"focusable\") && this.isFocus()) {\n\t\t\t\tthis.markDirtyAccessibility();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic markDirtyAccessibility(): void {\n\t\t//if (this._root.focused(this)) {\n\t\tthis._root._invalidateAccessibility(this);\n\t\t//}\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic markDirtyLayer() {\n\t\t//this._display.markDirtyLayer(this.isDirty(\"opacity\") || this.isDirty(\"visible\")); https://codepen.io/team/amcharts/pen/gOWZPmP <- problems\n\t\tthis._display.markDirtyLayer(true);\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic markDirty() {\n\t\tsuper.markDirty();\n\t\tthis.markDirtyLayer();\n\t}\n\n\tpublic _updateBounds() {\n\t\tconst oldBounds = this._adjustedLocalBounds;\n\n\t\tlet newBounds: IBounds;\n\n\t\t// if display.visible == false, it still returns bounds\n\t\tif (!this.get(\"visible\") || !this.getPrivate(\"visible\") || this.get(\"forceHidden\")) {\n\t\t\tnewBounds = {\n\t\t\t\tleft: 0,\n\t\t\t\tright: 0,\n\t\t\t\ttop: 0,\n\t\t\t\tbottom: 0\n\t\t\t};\n\t\t\tthis._localBounds = newBounds;\n\t\t\tthis._adjustedLocalBounds = newBounds;\n\t\t}\n\t\telse {\n\t\t\tthis._getBounds();\n\t\t\tthis._fixMinBounds(this._localBounds);\n\t\t\tthis.updatePivotPoint();\n\t\t\tthis._adjustedLocalBounds = this._display.getAdjustedBounds(this._localBounds);\n\t\t\tnewBounds = this._adjustedLocalBounds!;\n\t\t}\n\n\t\tif (!oldBounds || (oldBounds.left !== newBounds.left || oldBounds.top !== newBounds.top || oldBounds.right !== newBounds.right || oldBounds.bottom !== newBounds.bottom)) {\n\t\t\tconst eventType = \"boundschanged\";\n\t\t\tif (this.events.isEnabled(eventType)) {\n\t\t\t\tthis.events.dispatch(eventType, { type: eventType, target: this });\n\t\t\t}\n\t\t\tif (this.parent) {\n\t\t\t\tthis.parent.markDirty();\n\t\t\t\tthis.parent.markDirtyBounds();\n\t\t\t}\n\n\t\t\t// Update tooltip position together with the Sprite\n\t\t\tif (this.getPrivate(\"showingTooltip\")) {\n\t\t\t\tthis.showTooltip();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _fixMinBounds(bounds: IBounds) {\n\t\tlet minWidth = this.get(\"minWidth\", this.getPrivate(\"minWidth\"));\n\t\tlet minHeight = this.get(\"minHeight\", this.getPrivate(\"minHeight\"));\n\n\t\tif ($type.isNumber(minWidth)) {\n\t\t\tif (bounds.right - bounds.left < minWidth) {\n\t\t\t\tbounds.right = bounds.left + minWidth;\n\t\t\t}\n\t\t}\n\n\t\tif ($type.isNumber(minHeight)) {\n\t\t\tif (bounds.bottom - bounds.top < minHeight) {\n\t\t\t\tbounds.bottom = bounds.top + minHeight;\n\t\t\t}\n\t\t}\n\n\t\tlet privateWidth = this.getPrivate(\"width\");\n\t\tlet privateHeight = this.getPrivate(\"height\");\n\n\t\tif ($type.isNumber(privateWidth)) {\n\t\t\tif (privateWidth > 0) {\n\t\t\t\tbounds.right = bounds.left + privateWidth;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbounds.left = bounds.right + privateWidth;\n\t\t\t}\n\t\t}\n\n\t\tif ($type.isNumber(privateHeight)) {\n\t\t\tif (privateHeight > 0) {\n\t\t\t\tbounds.bottom = bounds.top + privateHeight;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbounds.top = bounds.bottom + privateHeight;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _removeParent(parent: Container | undefined) {\n\t\tif (parent) {\n\t\t\tparent.children.removeValue(this);\n\t\t\t$array.removeFirst(parent._percentageSizeChildren, this);\n\t\t\t$array.removeFirst(parent._percentagePositionChildren, this);\n\t\t}\n\t}\n\n\tpublic _clearDirty() {\n\t\tsuper._clearDirty();\n\t\tthis._sizeDirty = false;\n\t\tthis._statesHandled = false;\n\t}\n\n\t/**\n\t * Simulate hover over element.\n\t */\n\tpublic hover() {\n\t\tif (!this.isDisposed()) {\n\t\t\tthis.showTooltip();\n\t\t\tthis._handleOver();\n\t\t}\n\t}\n\n\t/**\n\t * Simulate unhover over element.\n\t */\n\tpublic unhover(): void {\n\t\tif (!this.isDisposed()) {\n\t\t\tthis.hideTooltip();\n\t\t\tthis._handleOut();\n\t\t}\n\t}\n\n\t/**\n\t * Shows element's [[Tooltip]].\n\t */\n\tpublic showTooltip(point?: IPoint): Promise<void> | undefined {\n\t\tif (!this.isDisposed()) {\n\t\t\tconst tooltip = this.getTooltip();\n\t\t\tconst tooltipText = this.get(\"tooltipText\");\n\t\t\tconst tooltipHTML = this.get(\"tooltipHTML\");\n\n\t\t\tif ((tooltipText || tooltipHTML) && tooltip) {\n\t\t\t\tconst tooltipPosition = this.get(\"tooltipPosition\");\n\t\t\t\tconst tooltipTarget = this.getPrivate(\"tooltipTarget\", this);\n\n\t\t\t\tif (tooltipPosition == \"fixed\" || !point) {\n\t\t\t\t\tthis._display._setMatrix();\n\t\t\t\t\tpoint = this.toGlobal(tooltipTarget._getTooltipPoint());\n\t\t\t\t}\n\n\t\t\t\ttooltip.set(\"pointTo\", point);\n\t\t\t\ttooltip.set(\"tooltipTarget\", tooltipTarget);\n\n\t\t\t\tif (!tooltip.get(\"x\")) {\n\t\t\t\t\ttooltip.set(\"x\", point.x);\n\t\t\t\t}\n\t\t\t\tif (!tooltip.get(\"y\")) {\n\t\t\t\t\ttooltip.set(\"y\", point.y);\n\t\t\t\t}\n\n\t\t\t\tif (tooltipText) {\n\t\t\t\t\ttooltip.label.set(\"text\", tooltipText);\n\t\t\t\t}\n\t\t\t\tif (tooltipHTML) {\n\t\t\t\t\ttooltip.label.set(\"html\", tooltipHTML);\n\t\t\t\t}\n\t\t\t\tconst dataItem = this.dataItem;\n\t\t\t\tif (dataItem) {\n\t\t\t\t\ttooltip.label._setDataItem(dataItem);\n\t\t\t\t}\n\n\t\t\t\tif (this.get(\"showTooltipOn\") == \"always\" && (point.x < 0 || point.x > this._root.width() || point.y < 0 || point.y > this._root.height())) {\n\t\t\t\t\tthis.hideTooltip();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttooltip.label.text.markDirtyText();\n\t\t\t\tconst promise = tooltip.show();\n\t\t\t\tthis.setPrivateRaw(\"showingTooltip\", true);\n\t\t\t\treturn promise;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Hides element's [[Tooltip]].\n\t */\n\tpublic hideTooltip(): Promise<void> | undefined {\n\t\tconst tooltip = this.getTooltip();\n\t\tif (tooltip) {\n\t\t\tif (tooltip.get(\"tooltipTarget\") == this.getPrivate(\"tooltipTarget\", this) || this.get(\"tooltip\") == tooltip) {\n\t\t\t\tlet timeout = tooltip.get(\"keepTargetHover\") && tooltip.get(\"stateAnimationDuration\", 0) == 0 ? 400 : undefined;\n\t\t\t\tconst promise = tooltip.hide(timeout);\n\t\t\t\tthis.setPrivateRaw(\"showingTooltip\", false);\n\t\t\t\treturn promise;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _getTooltipPoint(): IPoint {\n\t\tconst bounds = this._localBounds!;\n\n\t\tif (bounds) {\n\t\t\tlet x = 0;\n\t\t\tlet y = 0;\n\n\t\t\tif (!this.get(\"isMeasured\")) {\n\t\t\t\tx = $utils.relativeToValue(this.get(\"tooltipX\", 0), this.width());\n\t\t\t\ty = $utils.relativeToValue(this.get(\"tooltipY\", 0), this.height());\n\t\t\t}\n\t\t\telse {\n\t\t\t\tx = bounds.left + $utils.relativeToValue(this.get(\"tooltipX\", 0), bounds.right - bounds.left);\n\t\t\t\ty = bounds.top + $utils.relativeToValue(this.get(\"tooltipY\", 0), bounds.bottom - bounds.top);\n\t\t\t}\n\n\t\t\treturn { x, y };\n\t\t}\n\t\treturn { x: 0, y: 0 };\n\t}\n\n\t/**\n\t * Returns [[Tooltip]] used for this element.\n\t *\n\t * @return Tooltip\n\t */\n\tpublic getTooltip(): Tooltip | undefined {\n\t\tlet tooltip = this.get(\"tooltip\");\n\t\tif (!tooltip) {\n\t\t\tlet parent = this.parent;\n\t\t\tif (parent) {\n\t\t\t\treturn parent.getTooltip();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn tooltip;\n\t\t}\n\t}\n\n\tpublic _updatePosition() {\n\n\t\tconst parent = this.parent;\n\n\t\tlet dx = this.get(\"dx\", 0);\n\t\tlet dy = this.get(\"dy\", 0);\n\n\t\tlet x = this.get(\"x\");\n\t\tlet _x = this.getPrivate(\"x\");\n\n\t\tlet xx = 0;\n\t\tlet yy = 0;\n\n\t\tconst position = this.get(\"position\");\n\n\t\tif (x instanceof Percent) {\n\t\t\tif (parent) {\n\t\t\t\tx = parent.innerWidth() * x.value + parent.get(\"paddingLeft\", 0);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tx = 0;\n\t\t\t}\n\t\t}\n\t\tif ($type.isNumber(x)) {\n\t\t\txx = x + dx;\n\t\t}\n\t\telse {\n\t\t\tif (_x != null) {\n\t\t\t\txx = _x;\n\t\t\t}\n\t\t\telse if (parent) {\n\t\t\t\tif (position == \"relative\") {\n\t\t\t\t\txx = parent.get(\"paddingLeft\", 0) + dx;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tlet y = this.get(\"y\");\n\t\tlet _y = this.getPrivate(\"y\");\n\n\t\tif (y instanceof Percent) {\n\t\t\tif (parent) {\n\t\t\t\ty = parent.innerHeight() * y.value + parent.get(\"paddingTop\", 0);\n\t\t\t}\n\t\t\telse {\n\t\t\t\ty = 0;\n\t\t\t}\n\t\t}\n\t\tif ($type.isNumber(y)) {\n\t\t\tyy = y + dy;\n\t\t}\n\t\telse {\n\t\t\tif (_y != null) {\n\t\t\t\tyy = _y;\n\t\t\t}\n\t\t\telse if (parent) {\n\t\t\t\tif (position == \"relative\") {\n\t\t\t\t\tyy = parent.get(\"paddingTop\", 0) + dy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst display = this._display;\n\n\t\tif (display.x != xx || display.y != yy) {\n\t\t\tdisplay.invalidateBounds();\n\t\t\tdisplay.x = xx;\n\t\t\tdisplay.y = yy;\n\n\t\t\tconst eventType = \"positionchanged\";\n\t\t\tif (this.events.isEnabled(eventType)) {\n\t\t\t\tthis.events.dispatch(eventType, { type: eventType, target: this });\n\t\t\t}\n\t\t}\n\n\t\t// Update tooltip position together with the Sprite\n\t\tif (this.getPrivate(\"showingTooltip\")) {\n\t\t\tthis.showTooltip();\n\t\t}\n\t}\n\n\t/**\n\t * Returns element's actual X position in pixels.\n\t *\n\t * @return X (px)\n\t */\n\tpublic x(): number {\n\t\tlet x = this.get(\"x\");\n\t\tlet _x = this.getPrivate(\"x\");\n\n\t\tconst parent = this.parent;\n\t\tif (parent) {\n\t\t\tif (x instanceof Percent) {\n\t\t\t\treturn $utils.relativeToValue(x, parent.innerWidth()) + parent.get(\"paddingLeft\", 0);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!$type.isNumber(x)) {\n\t\t\t\t\tif (_x != null) {\n\t\t\t\t\t\treturn _x;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn parent.get(\"paddingLeft\", this._display.x)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn x;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this._display.x;\n\t}\n\n\t/**\n\t * Returns element's actual Y position in pixels.\n\t *\n\t * @return Y (px)\n\t */\n\tpublic y(): number {\n\n\t\tlet _y = this.getPrivate(\"y\");\n\n\t\tif (_y != null) {\n\t\t\treturn _y;\n\t\t}\n\n\t\tlet y = this.get(\"y\");\n\t\tconst parent = this.parent;\n\n\t\tif (parent) {\n\t\t\tif (y instanceof Percent) {\n\t\t\t\treturn $utils.relativeToValue(y, parent.innerHeight()) + parent.get(\"paddingTop\", 0);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!$type.isNumber(y)) {\n\t\t\t\t\tif (_y != null) {\n\t\t\t\t\t\treturn _y;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn parent.get(\"paddingTop\", this._display.y)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn y;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this._display.y;\n\t}\n\n\tprotected _dispose() {\n\t\tsuper._dispose();\n\t\tthis._display.dispose();\n\t\tthis._removeTemplateField();\n\t\tthis._removeParent(this.parent);\n\t\tthis._root._removeFocusElement(this);\n\n\t\tconst tooltip = this.get(\"tooltip\");\n\t\tif (tooltip) {\n\t\t\ttooltip.dispose();\n\t\t}\n\n\t\tthis.markDirty();\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic adjustedLocalBounds(): IBounds {\n\t\tthis._fixMinBounds(this._adjustedLocalBounds);\n\t\treturn this._adjustedLocalBounds;\n\t}\n\n\t/**\n\t * Returns local coordinates of the element's bounds.\n\t *\n\t * @ignore\n\t * @return Global bounds\n\t */\n\tpublic localBounds(): IBounds {\n\t\treturn this._localBounds;\n\t}\n\n\t/**\n\t * Returns adjusted local coordinates of the element's bounds.\n\t *\n\t * @ignore\n\t * @return Global bounds\n\t */\n\tpublic bounds(): IBounds {\n\t\tconst bounds = this._adjustedLocalBounds;\n\t\tconst x = this.x();\n\t\tconst y = this.y();\n\t\treturn { left: bounds.left + x, right: bounds.right + x, top: bounds.top + y, bottom: bounds.bottom + y };\n\t}\n\n\t/**\n\t * Returns global coordinates of the element's bounds.\n\t *\n\t * @ignore\n\t * @return Global bounds\n\t */\n\tpublic globalBounds(): IBounds {\n\t\tconst bounds = this.localBounds();\n\n\t\tconst p0 = this.toGlobal({ x: bounds.left, y: bounds.top });\n\t\tconst p1 = this.toGlobal({ x: bounds.right, y: bounds.top });\n\t\tconst p2 = this.toGlobal({ x: bounds.right, y: bounds.bottom });\n\t\tconst p3 = this.toGlobal({ x: bounds.left, y: bounds.bottom });\n\n\t\treturn {\n\t\t\tleft: Math.min(p0.x, p1.x, p2.x, p3.x),\n\t\t\ttop: Math.min(p0.y, p1.y, p2.y, p3.y),\n\t\t\tright: Math.max(p0.x, p1.x, p2.x, p3.x),\n\t\t\tbottom: Math.max(p0.y, p1.y, p2.y, p3.y)\n\t\t}\n\t}\n\n\tprotected _onShow(_duration?: number) {\n\n\t}\n\n\tprotected _onHide(_duration?: number) {\n\n\t}\n\n\t/**\n\t * Plays initial reveal animation regardless if element is currently hidden\n\t * or visible.\n\t *\n\t * @param   duration  Duration of the animation in milliseconds\n\t * @param   delay     Delay showing of the element by X milliseconds\n\t * @return            Promise\n\t */\n\tpublic async appear(duration?: number, delay?: number): Promise<void> {\n\t\tawait this.hide(0);\n\t\tif (delay) {\n\t\t\treturn new Promise<void>((success, _error) => {\n\t\t\t\tthis.setTimeout(() => {\n\t\t\t\t\tsuccess(this.show(duration));\n\t\t\t\t}, delay);\n\t\t\t});\n\n\t\t}\n\t\telse {\n\t\t\treturn this.show(duration);\n\t\t}\n\t}\n\n\t/**\n\t * Shows currently hidden element and returns a `Promise` which completes\n\t * when all showing animations are finished.\n\t *\n\t * ```TypeScript\n\t * series.show().then(function(ev) {\n\t *   console.log(\"Series is now fully visible\");\n\t * })\n\t * ```\n\t * ```JavaScript\n\t * series.show().then(function(ev) {\n\t *   console.log(\"Series is now fully visible\");\n\t * })\n\t * ```\n\t *\n\t * @return Promise\n\t */\n\tpublic async show(duration?: number): Promise<void> {\n\t\tif (!this._isShowing) {\n\t\t\tthis._isHidden = false;\n\t\t\tthis._isShowing = true;\n\t\t\tthis._isHiding = false;\n\n\t\t\tif (this.states.lookup(\"default\")!.get(\"visible\")) {\n\t\t\t\tthis.set(\"visible\", true);\n\t\t\t}\n\t\t\tthis._onShow(duration);\n\n\t\t\tconst animations = this.states.applyAnimate(\"default\", duration);\n\t\t\tawait waitForAnimations(animations);\n\n\t\t\tthis._isShowing = false;\n\t\t}\n\t}\n\n\t/**\n\t * Hides the element and returns a `Promise` which completes when all hiding\n\t * animations are finished.\n\t *\n\t * ```TypeScript\n\t * series.hide().then(function(ev) {\n\t *   console.log(\"Series finished hiding\");\n\t * })\n\t * ```\n\t * ```JavaScript\n\t * series.hide().then(function(ev) {\n\t *   console.log(\"Series finished hiding\");\n\t * })\n\t * ```\n\t *\n\t * @return Promise\n\t */\n\tpublic async hide(duration?: number): Promise<void> {\n\t\tif (!this._isHiding && !this._isHidden) {\n\t\t\tthis._isHiding = true;\n\t\t\tthis._isShowing = false;\n\t\t\tlet state = this.states.lookup(\"hidden\");\n\t\t\tif (!state) {\n\t\t\t\tstate = this.states.create(\"hidden\", {\n\t\t\t\t\t\"opacity\": 0,\n\t\t\t\t\t\"visible\": false\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._isHidden = true;\n\t\t\tthis._onHide(duration);\n\n\t\t\tconst animations = this.states.applyAnimate(\"hidden\", duration);\n\n\t\t\tawait waitForAnimations(animations);\n\n\t\t\tthis._isHiding = false;\n\t\t}\n\t}\n\n\t/**\n\t * Returns `true` if this element is currently hidden.\n\t *\n\t * @return Is hidden?\n\t */\n\tpublic isHidden(): boolean {\n\t\treturn this._isHidden;\n\t}\n\n\t/**\n\t * Returns `true` if this element is currently animating to a default state.\n\t *\n\t * @return Is showing?\n\t */\n\tpublic isShowing(): boolean {\n\t\treturn this._isShowing;\n\t}\n\n\t/**\n\t * Returns `true` if this element is currently animating to a hidden state.\n\t *\n\t * @return Is hiding?\n\t */\n\tpublic isHiding(): boolean {\n\t\treturn this._isHiding;\n\t}\n\n\t/**\n\t * Returns `true` if this element is currently hovered by a pointer.\n\t *\n\t * @return Is hovered?\n\t */\n\tpublic isHover(): boolean {\n\t\treturn this._display.hovering();\n\t}\n\n\t/**\n\t * Returns `true` if this element does currently have focus.\n\t *\n\t * @return Is focused?\n\t */\n\tpublic isFocus(): boolean {\n\t\treturn this._root.focused(this);\n\t}\n\n\t/**\n\t * Returns `true` if this element is currently being dragged.\n\t *\n\t * @return Is dragged?\n\t */\n\tpublic isDragging(): boolean {\n\t\treturn this._isDragging;\n\t}\n\n\t/**\n\t * Returns `false` if if either public or private setting `visible` is set\n\t * to `false`, or `forceHidden` is set to `true`.\n\t *\n\t * @return Visible?\n\t */\n\tpublic isVisible(): boolean {\n\t\tif (this.get(\"visible\") && this.getPrivate(\"visible\") && !this.get(\"forceHidden\")) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Same as `isVisible()`, except it checks all ascendants, too.\n\t *\n\t * @since 5.2.7\n\t * @return Visible?\n\t */\n\tpublic isVisibleDeep(): boolean {\n\t\treturn this._parent ? (this._parent.isVisibleDeep() && this.isVisible()) : this.isVisible();\n\t}\n\n\t/**\n\t * Returns an actual opacity of the element, taking into account all parents.\n\t *\n\t * @return Opacity\n\t * @since 5.2.11\n\t */\n\tpublic compositeOpacity(): number {\n\t\tconst opacity = this.get(\"opacity\", 1);\n\t\treturn this._parent ? (this._parent.compositeOpacity() * opacity) : opacity;\n\t}\n\n\t/**\n\t * Returns an actual scale of the element, taking into account all parents.\n\t *\n\t * @return Opacity\n\t * @since 5.9.2\n\t */\n\tpublic compositeScale(): number {\n\t\tconst scale = this.get(\"scale\", 1);\n\t\treturn this._parent ? (this._parent.compositeScale() * scale) : scale;\n\t}\n\n\t/**\n\t * Returns an actual roation of the element, taking into account all parents.\n\t *\n\t * @return Opacity\n\t * @since 5.9.2\n\t */\n\tpublic compositeRotation(): number {\n\t\tconst rotation = this.get(\"rotation\", 0);\n\t\treturn this._parent ? (this._parent.compositeRotation() + rotation) : rotation;\n\t}\n\n\t/**\n\t * Returns width of this element in pixels.\n\t *\n\t * @return Width (px)\n\t */\n\tpublic width(): number {\n\t\tlet width = this.get(\"width\");\n\t\tlet maxWidth = this.get(\"maxWidth\", this.getPrivate(\"maxWidth\"));\n\t\tlet minWidth = this.get(\"minWidth\", this.getPrivate(\"minWidth\"));\n\t\tlet privateWidth = this.getPrivate(\"width\");\n\t\tlet w = 0;\n\n\t\tif ($type.isNumber(privateWidth)) {\n\t\t\tw = privateWidth;\n\t\t}\n\t\telse {\n\t\t\tif (width == null) {\n\t\t\t\tif (this._adjustedLocalBounds) {\n\t\t\t\t\tw = this._adjustedLocalBounds.right - this._adjustedLocalBounds.left;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (width instanceof Percent) {\n\t\t\t\t\tconst parent = this.parent;\n\t\t\t\t\tif (parent) {\n\t\t\t\t\t\tw = parent.innerWidth() * width.value;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tw = this._root.width() * width.value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if ($type.isNumber(width)) {\n\t\t\t\t\tw = width;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ($type.isNumber(minWidth)) {\n\t\t\tw = Math.max(minWidth, w);\n\t\t}\n\t\tif ($type.isNumber(maxWidth)) {\n\t\t\tw = Math.min(maxWidth, w);\n\t\t}\n\n\t\treturn w;\n\t}\n\n\t/**\n\t * Returns maximum allowed width of this element in pixels.\n\t *\n\t * @return Maximum width (px)\n\t */\n\tpublic maxWidth(): number {\n\t\tlet maxWidth = this.get(\"maxWidth\", this.getPrivate(\"maxWidth\"));\n\t\tif ($type.isNumber(maxWidth)) {\n\t\t\treturn maxWidth;\n\t\t}\n\t\telse {\n\t\t\tlet width = this.get(\"width\")\n\t\t\tif ($type.isNumber(width)) {\n\t\t\t\treturn width;\n\t\t\t}\n\t\t}\n\t\tconst parent = this.parent;\n\t\tif (parent) {\n\t\t\treturn parent.innerWidth();\n\t\t}\n\t\treturn this._root.width();\n\t}\n\n\t/**\n\t * Returns maximum allowed height of this element in pixels.\n\t *\n\t * @return Maximum height (px)\n\t */\n\tpublic maxHeight(): number {\n\t\tlet maxHeight = this.get(\"maxHeight\", this.getPrivate(\"maxHeight\"));\n\t\tif ($type.isNumber(maxHeight)) {\n\t\t\treturn maxHeight;\n\t\t}\n\t\telse {\n\t\t\tlet height = this.get(\"height\")\n\t\t\tif ($type.isNumber(height)) {\n\t\t\t\treturn height;\n\t\t\t}\n\t\t}\n\t\tconst parent = this.parent;\n\t\tif (parent) {\n\t\t\treturn parent.innerHeight();\n\t\t}\n\t\treturn this._root.height();\n\t}\n\n\t/**\n\t * Returns height of this element in pixels.\n\t *\n\t * @return Height (px)\n\t */\n\tpublic height(): number {\n\t\tlet height = this.get(\"height\");\n\t\tlet maxHeight = this.get(\"maxHeight\", this.getPrivate(\"maxHeight\"));\n\t\tlet minHeight = this.get(\"minHeight\", this.getPrivate(\"minHeight\"));\n\t\tlet privateHeight = this.getPrivate(\"height\");\n\t\tlet h = 0;\n\n\t\tif ($type.isNumber(privateHeight)) {\n\t\t\th = privateHeight;\n\t\t}\n\t\telse {\n\t\t\tif (height == null) {\n\t\t\t\tif (this._adjustedLocalBounds) {\n\t\t\t\t\th = this._adjustedLocalBounds.bottom - this._adjustedLocalBounds.top;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (height instanceof Percent) {\n\t\t\t\t\tconst parent = this.parent;\n\t\t\t\t\tif (parent) {\n\t\t\t\t\t\th = parent.innerHeight() * height.value;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\th = this._root.height() * height.value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if ($type.isNumber(height)) {\n\t\t\t\t\th = height;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ($type.isNumber(minHeight)) {\n\t\t\th = Math.max(minHeight, h);\n\t\t}\n\t\tif ($type.isNumber(maxHeight)) {\n\t\t\th = Math.min(maxHeight, h);\n\t\t}\n\n\t\treturn h;\n\t}\n\n\tprotected _findStaticTemplate(f: (template: Template<this>) => boolean): Template<this> | undefined {\n\t\t// templateField overrides template\n\t\tif (this._templateField && f(this._templateField)) {\n\t\t\treturn this._templateField;\n\t\t}\n\n\t\treturn super._findStaticTemplate(f);\n\t}\n\n\tpublic _walkParents(f: (parent: Sprite) => void): void {\n\t\tif (this._parent) {\n\t\t\tthis._walkParent(f);\n\t\t}\n\t}\n\n\tprotected _walkParent(f: (parent: Sprite) => void): void {\n\t\tif (this._parent) {\n\t\t\tthis._parent._walkParent(f);\n\t\t}\n\n\t\tf(this);\n\t}\n\n\t/**\n\t * Parent [[Container]] of this element.\n\t *\n\t * @return Parent container\n\t */\n\tpublic get parent(): Container | undefined {\n\t\treturn this._parent;\n\t}\n\n\tpublic _setParent(parent: Container, updateChildren: boolean = false) {\n\t\tconst prevParent = this._parent;\n\t\tif (parent !== prevParent) {\n\t\t\tthis.markDirtyBounds();\n\n\t\t\tparent.markDirty();\n\n\t\t\tthis._parent = parent;\n\n\t\t\tif (updateChildren) {\n\t\t\t\tthis._removeParent(prevParent);\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tthis._addPercentageSizeChildren();\n\t\t\t\t\tthis._addPercentagePositionChildren();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.markDirtyPosition();\n\t\t\tthis._applyThemes();\n\t\t}\n\t}\n\n\t/**\n\t * Returns an instance of [[NumberFormatter]] used in this element.\n\t *\n\t * If this element does not have it set, global one form [[Root]] is used.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/using-formatters/} for more info\n\t * @return NumberFormatter instace\n\t */\n\tpublic getNumberFormatter(): NumberFormatter {\n\t\treturn this.get(\"numberFormatter\", this._root.numberFormatter);\n\t}\n\n\t/**\n\t * Returns an instance of [[DateFormatter]] used in this element.\n\t *\n\t * If this element does not have it set, global one form [[Root]] is used.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/using-formatters/} for more info\n\t * @return DateFormatter instace\n\t */\n\tpublic getDateFormatter(): DateFormatter {\n\t\treturn this.get(\"dateFormatter\", this._root.dateFormatter);\n\t}\n\n\t/**\n\t * Returns an instance of [[DurationFormatter]] used in this element.\n\t *\n\t * If this element does not have it set, global one form [[Root]] is used.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/using-formatters/} for more info\n\t * @return DurationFormatter instace\n\t */\n\tpublic getDurationFormatter(): DurationFormatter {\n\t\treturn this.get(\"durationFormatter\", this._root.durationFormatter);\n\t}\n\n\t/**\n\t * Converts X/Y coordinate within this element to a global coordinate.\n\t *\n\t * @param  point  Local coordinate\n\t * @return        Global coordinate\n\t */\n\tpublic toGlobal(point: IPoint): IPoint {\n\t\treturn this._display.toGlobal(point);\n\t}\n\n\t/**\n\t * Converts global X/Y coordinate to a coordinate within this element.\n\t *\n\t * @param  point  Global coordinate\n\t * @return        Local coordinate\n\t */\n\tpublic toLocal(point: IPoint): IPoint {\n\t\treturn this._display.toLocal(point);\n\t}\n\n\tpublic _getDownPoint(): IPoint | undefined {\n\t\tconst id = this._getDownPointId();\n\t\tif (id) {\n\t\t\treturn this._downPoints[id];\n\t\t}\n\n\t}\n\n\tpublic _getDownPointId(): number | undefined {\n\t\tif (this._downPoints) {\n\t\t\treturn $object.keysOrdered(this._downPoints, (a, b) => {\n\t\t\t\tif (a > b) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\tif (a < b) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t})[0];\n\t\t}\n\t}\n\n\t/**\n\t * Moves sprite to the end of the parent's children array.\n\t *\n\t * Depending on `layout` setting of the parten container, it may effect the\n\t * positioning or overlapping order of the elements.\n\t */\n\tpublic toFront() {\n\t\tconst parent = this.parent;\n\t\tif (parent) {\n\t\t\tparent.children.moveValue(this, parent.children.length - 1);\n\t\t}\n\t}\n\n\t/**\n\t * Moves sprite to the beginning of the parent's children array.\n\t *\n\t * Depending on `layout` setting of the parten container, it may effect the\n\t * positioning or overlapping order of the elements.\n\t */\n\tpublic toBack() {\n\t\tconst parent = this.parent;\n\t\tif (parent) {\n\t\t\tparent.children.moveValue(this, 0);\n\t\t}\n\t}\n\n}\n"],"mappings":";AAaA,SAASA,MAAM,QAAwD,gBAAgB;AACvF,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,SAASC,OAAO,QAAQ,iBAAiB;AACzC,SAASC,eAAe,QAA+B,yBAAyB;AAChF,SAAoBC,aAAa,EAAEC,eAAe,QAAQ,kBAAkB;AAC5E,SAASC,iBAAiB,QAAQ,mBAAmB;AAErD,OAAO,KAAKC,MAAM,MAAM,eAAe;AACvC,OAAO,KAAKC,MAAM,MAAM,eAAe;AACvC,OAAO,KAAKC,KAAK,MAAM,cAAc;AACrC,OAAO,KAAKC,OAAO,MAAM,gBAAgB;AACzC,OAAO,KAAKC,KAAK,MAAM,cAAc;AACrC;AAGA;;;;;AAKA,MAAMC,qBAAuE,SAAQT,eAAkB;EAkGtGU,YAAYC,MAAc;IACzB,KAAK,EAAE;IAPRC,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;aAAmF;;IAEnFD,MAAA,CAAAC,cAAA;;;;aAAsC;;IAIrC,IAAI,CAACC,OAAO,GAAGH,MAAM;EACtB;EAEUI,iBAAiBA,CAAoBC,GAAM,EAAEC,KAAoC;IAC1F,OAAO;MACNC,IAAI,EAAEF,GAAG;MACTG,aAAa,EAAEF,KAAK,CAACA,KAAK;MAC1BG,KAAK,EAAEH,KAAK,CAACG,KAAK;MAClBC,SAAS,EAAEJ,KAAK,CAACI,SAAS;MAC1BC,MAAM,EAAEL,KAAK,CAACK,MAAM;MACpBC,MAAM,EAAE,IAAI,CAACT;KACb;EACF;EAEUU,WAAWA,CAAoCR,GAAQ,EAAES,QAA2D;IAC7H;IACA,IAAI,CAACX,OAAO,CAACY,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC;IACrC,IAAI,CAACZ,OAAO,CAACa,QAAQ,CAACC,WAAW,GAAG,IAAI;IAExC,IAAIC,MAAM,GAAG,IAAI,CAACC,kBAAkB,CAACd,GAAG,CAAC;IAEzC,IAAIa,MAAM,KAAKE,SAAS,EAAE;MACzB,MAAMC,QAAQ,GAAG,IAAI,CAAClB,OAAO,CAACa,QAAQ,CAACM,EAAE,CAACjB,GAAG,EAAGkB,CAAC,IAAI;QACpDT,QAAQ,CAACU,IAAI,CAAC,IAAI,EAAED,CAAC,CAAC;MACvB,CAAC,CAAC;MAEFL,MAAM,GAAG,IAAI,CAACC,kBAAkB,CAACd,GAAG,CAAC,GAAG,IAAId,eAAe,CAAC,MAAK;QAChE,OAAO,IAAI,CAAC4B,kBAAkB,CAACd,GAAG,CAAC;QACnCgB,QAAQ,CAACI,OAAO,EAAE;MACnB,CAAC,CAAC;;IAGH,OAAOP,MAAM,CAACQ,SAAS,EAAE;EAC1B;EAEUC,GAAGA,CAAyBC,IAAa,EAAErB,IAAgB,EAAEsB,QAAa,EAAEC,OAAU,EAAEC,WAAoB,EAAEjB,QAA4C;IACnK,MAAMkB,IAAI,GAAG,KAAK,CAACL,GAAG,CAACC,IAAI,EAAErB,IAAI,EAAEsB,QAAQ,EAAEC,OAAO,EAAEC,WAAW,EAAEjB,QAAQ,CAAC;IAE5E,MAAMmB,aAAa,GAAInC,qBAAqB,CAACoC,eAAuB,CAAC3B,IAAI,CAAC;IAC1E,IAAI0B,aAAa,KAAKb,SAAS,EAAE;MAChCY,IAAI,CAACX,QAAQ,GAAG,IAAI/B,aAAa,CAAC,CACjC0C,IAAI,CAACX,QAAQ,EACb,IAAI,CAACR,WAAW,CAACN,IAAW,EAAE0B,aAAa,CAAC,CAC5C,CAAC;;IAGH,OAAOD,IAAI;EACZ;EAEA;;;;;;;;;;;;;;;;;;;;EAoBOG,kBAAkBA,CAAA;IACxB,IAAI,CAACC,gBAAgB,GAAG,KAAK;EAC9B;EAEA;;;EAGOC,eAAeA,CAAsB9B,IAAS,EAAED,KAAa;IACnE,MAAMgC,GAAG,GAAG,IAAI,CAACF,gBAAgB;IAEjC,IAAI,CAACA,gBAAgB,GAAG,IAAI;IAE5B,IAAI;MACH,IAAI,CAACtB,QAAQ,CAACP,IAAI,EAAED,KAAK,CAAC;MAE1B,IAAI,IAAI,CAAC8B,gBAAgB,IAAI,IAAI,CAACjC,OAAO,CAACoC,MAAM,EAAE;QACjD,IAAI,CAACpC,OAAO,CAACoC,MAAM,CAACrB,MAAM,CAACmB,eAAe,CAAC9B,IAAW,EAAED,KAAK,CAAC;;KAG/D,SAAS;MACT,IAAI,CAAC8B,gBAAgB,GAAGE,GAAG;;EAE7B;;AA9LArC,MAAA,CAAAC,cAAA,CAAAJ,qBAAA;;;;SAA4L;IAC3L,OAAO,EAAE,SAAA0C,CAAUlC,KAAK;MACvB,IAAI,IAAI,CAACmC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAACtC,OAAO,CAACuC,UAAU,EAAE,IAAI,IAAI,CAACvC,OAAO,CAACwC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAACxC,OAAO,CAACyC,SAAS,CAAC,IAAI,CAACxC,iBAAiB,CAAC,OAAO,EAAEE,KAAK,CAAC,CAAC,EAAE;QACxJ,IAAI,CAACQ,QAAQ,CAAC,OAAO,EAAE,IAAI,CAACV,iBAAiB,CAAC,OAAO,EAAEE,KAAK,CAAC,CAAC;;IAEhE,CAAC;IAED,YAAY,EAAE,SAAAuC,CAAUvC,KAAK;MAC5B,IAAI,IAAI,CAACmC,SAAS,CAAC,YAAY,CAAC,EAAE;QACjC,IAAI,CAAC3B,QAAQ,CAAC,YAAY,EAAE,IAAI,CAACV,iBAAiB,CAAC,YAAY,EAAEE,KAAK,CAAC,CAAC;;IAE1E,CAAC;IAED,aAAa,EAAE,SAAAwC,CAAUxC,KAAK;MAC7B,IAAI,IAAI,CAACmC,SAAS,CAAC,aAAa,CAAC,EAAE;QAClC,IAAI,CAAC3B,QAAQ,CAAC,aAAa,EAAE,IAAI,CAACV,iBAAiB,CAAC,aAAa,EAAEE,KAAK,CAAC,CAAC;;IAE5E,CAAC;IAED,UAAU,EAAE,SAAAyC,CAAUzC,KAAK;MAC1B,IAAI,CAAC+B,eAAe,CAAC,UAAU,EAAE,IAAI,CAACjC,iBAAiB,CAAC,UAAU,EAAEE,KAAK,CAAC,CAAC;IAC5E,CAAC;IAED,aAAa,EAAE,SAAA0C,CAAU1C,KAAK;MAE7B,MAAMN,MAAM,GAAG,IAAI,CAACG,OAAO;MAC3B,IAAIW,QAAQ,GAAG,IAAI;MAEnB,IAAId,MAAM,CAACiD,UAAU,CAAC,aAAa,CAAC,EAAE;QACrCjD,MAAM,CAACkD,UAAU,EAAE;QACnB,MAAMC,MAAM,GAAGnD,MAAM,CAACoD,YAAY,EAAE;QAEpC,IAAIpD,MAAM,CAACqD,MAAM,CAAW,UAAU,CAAC,EAAE;UACxC,MAAMC,WAAW,GAAGtD,MAAM,CAACuD,GAAG,CAAC,aAAa,EAAE,CAAC,CAAC,GAAG,CAAC;UACpD,IAAID,WAAW,IAAI,CAAC,EAAE;YACrBH,MAAM,CAACK,IAAI,IAAIF,WAAW;YAC1BH,MAAM,CAACM,KAAK,IAAIH,WAAW;YAC3BH,MAAM,CAACO,GAAG,IAAIJ,WAAW;YACzBH,MAAM,CAACQ,MAAM,IAAIL,WAAW;;;QAI9B,IAAI,CAACzD,KAAK,CAAC+D,QAAQ,CAACtD,KAAK,CAACG,KAAK,EAAE0C,MAAM,CAAC,EAAE;UACzCrC,QAAQ,GAAG,KAAK;UAChBd,MAAM,CAAC6D,KAAK,CAACC,SAAS,CAACC,cAAc,CAAC/D,MAAM,CAACgB,QAAQ,CAAC;;;MAIxD,IAAIF,QAAQ,IAAI,IAAI,CAAC2B,SAAS,CAAC,aAAa,CAAC,EAAE;QAC9C,IAAI,CAAC3B,QAAQ,CAAC,aAAa,EAAE,IAAI,CAACV,iBAAiB,CAAC,aAAa,EAAEE,KAAK,CAAC,CAAC;;IAE5E,CAAC;IAED,YAAY,EAAE,SAAA0D,CAAU1D,KAAK;MAC5B,IAAI,IAAI,CAACmC,SAAS,CAAC,YAAY,CAAC,EAAE;QACjC,IAAI,CAAC3B,QAAQ,CAAC,YAAY,EAAE,IAAI,CAACV,iBAAiB,CAAC,YAAY,EAAEE,KAAK,CAAC,CAAC;;IAE1E,CAAC;IAED,aAAa,EAAE,SAAA2D,CAAU3D,KAAK;MAC7B,IAAI,CAAC+B,eAAe,CAAC,aAAa,EAAE,IAAI,CAACjC,iBAAiB,CAAC,aAAa,EAAEE,KAAK,CAAC,CAAC;IAClF,CAAC;IAED,WAAW,EAAE,SAAA4D,CAAU5D,KAAK;MAC3B,IAAI,IAAI,CAACmC,SAAS,CAAC,WAAW,CAAC,EAAE;QAChC,IAAI,CAAC3B,QAAQ,CAAC,WAAW,EAAE,IAAI,CAACV,iBAAiB,CAAC,WAAW,EAAEE,KAAK,CAAC,CAAC;;IAExE,CAAC;IAED,iBAAiB,EAAE,SAAA6D,CAAU7D,KAAK;MACjC,IAAI,IAAI,CAACmC,SAAS,CAAC,iBAAiB,CAAC,EAAE;QACtC,IAAI,CAAC3B,QAAQ,CAAC,iBAAiB,EAAE,IAAI,CAACV,iBAAiB,CAAC,iBAAiB,EAAEE,KAAK,CAAC,CAAC;;IAEpF,CAAC;IAED,mBAAmB,EAAE,SAAA8D,CAAU9D,KAAK;MACnC,IAAI,IAAI,CAACmC,SAAS,CAAC,mBAAmB,CAAC,EAAE;QACxC,IAAI,CAAC3B,QAAQ,CAAC,mBAAmB,EAAE,IAAI,CAACV,iBAAiB,CAAC,mBAAmB,EAAEE,KAAK,CAAC,CAAC;;IAExF,CAAC;IAED,OAAO,EAAE,SAAA+D,CAAU/D,KAAK;MACvB,IAAI,CAAC+B,eAAe,CAAC,OAAO,EAAE;QAC7B9B,IAAI,EAAE,OAAO;QACbK,MAAM,EAAE,IAAI,CAACT,OAAO;QACpBK,aAAa,EAAEF,KAAK,CAACA,KAAK;QAC1BG,KAAK,EAAEH,KAAK,CAACG;OACb,CAAC;IACH;;;AAkvBF;;;;;AAKA,OAAM,MAAgB6D,MAAO,SAAQpF,MAAM;EAA3Ca,YAAA;;IASCE,MAAA,CAAAC,cAAA;;;;aAAuC;QAAEsD,IAAI,EAAE,CAAC;QAAEC,KAAK,EAAE,CAAC;QAAEC,GAAG,EAAE,CAAC;QAAEC,MAAM,EAAE;MAAC;;IAE7E1D,MAAA,CAAAC,cAAA;;;;aAA+B;QAAEsD,IAAI,EAAE,CAAC;QAAEC,KAAK,EAAE,CAAC;QAAEC,GAAG,EAAE,CAAC;QAAEC,MAAM,EAAE;MAAC;;IAKrE1D,MAAA,CAAAC,cAAA;;;;;;IACAD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;aAAgC;;IAEhC;IACAD,MAAA,CAAAC,cAAA;;;;aAA8B;;IAE9B;IACAD,MAAA,CAAAC,cAAA;;;;;;IAEA;IACAD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;aAA+B;;IAE/BD,MAAA,CAAAC,cAAA;;;;aAAgC;;IAEhCD,MAAA,CAAAC,cAAA;;;;aAA+B;;IAE/BD,MAAA,CAAAC,cAAA;;;;aAA6B;;IAC7BD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;aAAkD;;IAElDD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;;;IAEAD,MAAA,CAAAC,cAAA;;;;aAAoC;;EAy3DrC;EAv3DWqE,SAASA,CAAA;IAClB,IAAI,CAACC,aAAa,CAAC,SAAS,EAAE,IAAI,CAAC;IACnC,KAAK,CAACD,SAAS,EAAE;EAClB;EAEA;;;;EAIOE,YAAYA,CAAsCpE,GAAQ;IAChE,IAAI,CAACqE,aAAa,CAACrE,GAAG,CAAC;EACxB;EAEOqE,aAAaA,CAAsCrE,GAAQ;IACjE,KAAK,CAACqE,aAAa,CAACrE,GAAG,CAAC;IACxB,IAAIA,GAAG,IAAI,GAAG,IAAIA,GAAG,IAAI,GAAG,IAAIA,GAAG,IAAI,IAAI,IAAIA,GAAG,IAAI,IAAI,EAAE;MAC3D,IAAI,CAACsE,eAAe,EAAE;MACtB,IAAI,CAACC,8BAA8B,EAAE;MACrC,IAAI,CAACC,iBAAiB,EAAE;;EAE1B;EAEOC,oBAAoBA,CAA6CzE,GAAQ;IAC/E,KAAK,CAACyE,oBAAoB,CAACzE,GAAG,CAAC;IAC/B,IAAIA,GAAG,IAAI,GAAG,IAAIA,GAAG,IAAI,GAAG,EAAE;MAC7B,IAAI,CAACwE,iBAAiB,EAAE;;EAE1B;EAEUE,oBAAoBA,CAAA;IAC7B,IAAI,IAAI,CAACC,cAAc,EAAE;MACxB,IAAI,CAACA,cAAc,CAACC,qBAAqB,CAAC,IAAI,CAAC;;EAEjD;EAEUC,aAAaA,CAAA;IACtB,OAAO,IAAIpF,qBAAqB,CAAC,IAAI,CAAC;EACvC;EAEOqF,qBAAqBA,CAAA;IAC3B,IAAIC,QAAQ;IAEZ,MAAMC,KAAK,GAAG,IAAI,CAAC9B,GAAG,CAAC,eAAe,CAAC;IAEvC,IAAI8B,KAAK,EAAE;MACV,MAAMC,QAAQ,GAAG,IAAI,CAACA,QAAQ;MAC9B,IAAIA,QAAQ,EAAE;QACb,MAAMxD,OAAO,GAAGwD,QAAQ,CAACC,WAAW;QACpC,IAAIzD,OAAO,EAAE;UACZsD,QAAQ,GAAItD,OAAe,CAACuD,KAAK,CAAC;UAElC,IAAI,EAAED,QAAQ,YAAYjG,QAAQ,CAAC,IAAIiG,QAAQ,EAAE;YAChDA,QAAQ,GAAGjG,QAAQ,CAACqG,GAAG,CAACJ,QAAQ,CAAC;;;;;IAMrC,IAAI,IAAI,CAACJ,cAAc,KAAKI,QAAQ,EAAE;MACrC,IAAI,CAACL,oBAAoB,EAAE;MAE3B,IAAI,CAACC,cAAc,GAAGI,QAAQ;MAE9B,IAAIA,QAAQ,EAAE;QACbA,QAAQ,CAACK,kBAAkB,CAAC,IAAI,CAAC;;MAGlC,IAAI,CAACC,eAAe,EAAE;;EAExB;EAEA;EACA;EACOC,YAAYA,CAACL,QAAuC;IAC1D,MAAMM,WAAW,GAAG,IAAI,CAACC,SAAS;IAClC,IAAI,CAACA,SAAS,GAAGP,QAAQ;IACzB,IAAI,CAACH,qBAAqB,EAAE;IAC5B,MAAMW,SAAS,GAAG,iBAAiB;IACnC,IAAIR,QAAQ,IAAIM,WAAW,EAAE;MAC5B,IAAI,IAAI,CAAC1E,MAAM,CAACuB,SAAS,CAACqD,SAAS,CAAC,EAAE;QACrC,IAAI,CAAC5E,MAAM,CAACJ,QAAQ,CAACgF,SAAS,EAAE;UAC/BvF,IAAI,EAAEuF,SAAS;UACflF,MAAM,EAAE,IAAI;UACZgF,WAAW,EAAEA,WAAW;UACxBG,WAAW,EAAET;SACb,CAAC;;;EAGL;EAEA;;;;;;;;;EASA,IAAWA,QAAQA,CAACU,KAA+C;IAClE,IAAI,CAACL,YAAY,CAACK,KAAK,CAAC;EACzB;EAEA;;;EAGA,IAAWV,QAAQA,CAAA;IAClB,IAAI,IAAI,CAACO,SAAS,EAAE;MACnB,OAAO,IAAI,CAACA,SAAS;KAErB,MAAM;MACN,IAAItD,MAAM,GAAG,IAAI,CAAC0D,OAAO;MAEzB,OAAO1D,MAAM,EAAE;QACd,IAAIA,MAAM,CAACsD,SAAS,EAAE;UACrB,OAAOtD,MAAM,CAACsD,SAAS;SAEvB,MAAM;UACNtD,MAAM,GAAGA,MAAM,CAAC0D,OAAO;;;;EAI3B;EAEUC,0BAA0BA,CAAA;IACnC,IAAI3D,MAAM,GAAG,IAAI,CAACA,MAAM;IACxB,IAAIA,MAAM,EAAE;MACX,IAAI,IAAI,CAACgB,GAAG,CAAC,OAAO,CAAC,YAAYnE,OAAO,IAAI,IAAI,CAACmE,GAAG,CAAC,QAAQ,CAAC,YAAYnE,OAAO,EAAE;QAClFM,MAAM,CAACyG,OAAO,CAAC5D,MAAM,CAAC6D,uBAAuB,EAAE,IAAI,CAAC;OACpD,MAAM;QACN1G,MAAM,CAAC2G,WAAW,CAAC9D,MAAM,CAAC6D,uBAAuB,EAAE,IAAI,CAAC;;;EAG3D;EAEUxB,8BAA8BA,CAAA;IACvC,IAAIrC,MAAM,GAAG,IAAI,CAACA,MAAM;IACxB,IAAIA,MAAM,EAAE;MACX,IAAI,IAAI,CAACgB,GAAG,CAAC,GAAG,CAAC,YAAYnE,OAAO,IAAI,IAAI,CAACmE,GAAG,CAAC,GAAG,CAAC,YAAYnE,OAAO,EAAE;QACzEM,MAAM,CAACyG,OAAO,CAAC5D,MAAM,CAAC+D,2BAA2B,EAAE,IAAI,CAAC;OACxD,MAAM;QACN5G,MAAM,CAAC2G,WAAW,CAAC9D,MAAM,CAAC+D,2BAA2B,EAAE,IAAI,CAAC;;;EAG/D;EAEA;;;EAGOzB,iBAAiBA,CAAA;IACvB,IAAI,CAAChB,KAAK,CAAC0C,iBAAiB,CAAC,IAAI,CAAC;EACnC;EAEUC,gBAAgBA,CAAA;IACzB,MAAMrD,MAAM,GAAG,IAAI,CAACsD,YAAY;IAChC,IAAItD,MAAM,EAAE;MACX,MAAMuD,OAAO,GAAG,IAAI,CAACnD,GAAG,CAAC,SAAS,CAAC;MACnC,IAAImD,OAAO,IAAI,IAAI,EAAE;QACpB,IAAI,CAAC1F,QAAQ,CAAC2F,KAAK,CAACC,CAAC,GAAGzD,MAAM,CAACK,IAAI,GAAG/D,MAAM,CAACoH,eAAe,CAACH,OAAQ,EAAEvD,MAAM,CAACM,KAAK,GAAGN,MAAM,CAACK,IAAI,CAAC;;MAGnG,MAAMsD,OAAO,GAAG,IAAI,CAACvD,GAAG,CAAC,SAAS,CAAC;MACnC,IAAIuD,OAAO,IAAI,IAAI,EAAE;QACpB,IAAI,CAAC9F,QAAQ,CAAC2F,KAAK,CAACI,CAAC,GAAG5D,MAAM,CAACO,GAAG,GAAGjE,MAAM,CAACoH,eAAe,CAACC,OAAQ,EAAE3D,MAAM,CAACQ,MAAM,GAAGR,MAAM,CAACO,GAAG,CAAC;;;EAGpG;EAEOsD,cAAcA,CAAA;IACpB,KAAK,CAACA,cAAc,EAAE;IAEtB;IACA,IAAI,CAACC,aAAa,EAAE;IAEpB,IAAI,IAAI,CAACC,OAAO,CAAC,SAAS,CAAC,EAAE;MAC5B,MAAMC,QAAQ,GAAG,IAAI,CAACC,aAAa,CAACC,OAAO;MAC3C,IAAIF,QAAQ,EAAE;QACbA,QAAQ,CAAC1F,OAAO,EAAE;;;IAIpB,IAAI,IAAI,CAACyF,OAAO,CAAC,OAAO,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,aAAa,CAAC,EAAE;MACzD,IAAI,CAAClG,QAAQ,CAACsG,QAAQ,CAAC,IAAI,CAAC/D,GAAG,CAAC,OAAO,CAAC,EAAE,IAAI,CAACA,GAAG,CAAC,aAAa,CAAC,CAAC;MAClE,IAAI,CAACgE,cAAc,EAAE;;IAGtB,IAAI,IAAI,CAACL,OAAO,CAAC,iBAAiB,CAAC,EAAE;MACpC,MAAMM,aAAa,GAAG,IAAI,CAACC,cAAc;MACzC,IAAID,aAAa,EAAE;QAClBA,aAAa,CAAC/F,OAAO,EAAE;QACvB,IAAI,CAACgG,cAAc,GAAGrG,SAAS;;MAGhC,MAAMsG,gBAAgB,GAAG,IAAI,CAACC,iBAAiB;MAC/C,IAAID,gBAAgB,EAAE;QACrBA,gBAAgB,CAACjG,OAAO,EAAE;QAC1B,IAAI,CAACkG,iBAAiB,GAAGvG,SAAS;;MAGnC,IAAI,IAAI,CAACmC,GAAG,CAAC,iBAAiB,CAAC,IAAI,SAAS,EAAE;QAE7C,IAAI,IAAI,CAACqE,OAAO,EAAE,EAAE;UACnB,IAAI,CAACH,cAAc,GAAG,IAAI,CAACvG,MAAM,CAACI,EAAE,CAAC,mBAAmB,EAAGC,CAAC,IAAI;YAC/D,IAAI,CAACsG,WAAW,CAACtG,CAAC,CAACd,KAAK,CAAC;UAC1B,CAAC,CAAC;;QAGH,IAAI,CAACkH,iBAAiB,GAAG,IAAIrI,aAAa,CAAC,CAC1C,IAAI,CAAC4B,MAAM,CAACI,EAAE,CAAC,aAAa,EAAE,MAAK;UAClC,IAAI,CAACmG,cAAc,GAAG,IAAI,CAACvG,MAAM,CAACI,EAAE,CAAC,mBAAmB,EAAGC,CAAC,IAAI;YAC/D,IAAI,CAACsG,WAAW,CAACtG,CAAC,CAACd,KAAK,CAAC;UAC1B,CAAC,CAAC;QACH,CAAC,CAAC,EAEF,IAAI,CAACS,MAAM,CAACI,EAAE,CAAC,YAAY,EAAE,MAAK;UACjC,MAAMkG,aAAa,GAAG,IAAI,CAACC,cAAc;UACzC,IAAID,aAAa,EAAE;YAClBA,aAAa,CAAC/F,OAAO,EAAE;YACvB,IAAI,CAACgG,cAAc,GAAGrG,SAAS;;QAEjC,CAAC,CAAC,CAAC,CAAC;;;EAGR;EAEU6F,aAAaA,CAAA;IACtB,IAAI,CAAC,IAAI,CAACa,cAAc,EAAE;MACzB,IAAI,IAAI,CAACZ,OAAO,CAAC,QAAQ,CAAC,EAAE;QAC3B,IAAI,IAAI,CAAC3D,GAAG,CAAC,QAAQ,CAAC,EAAE;UACvB,IAAI,CAACwE,MAAM,CAACC,YAAY,CAAC,QAAQ,CAAC;UAClC,IAAI,CAACjH,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC;SAC7B,MACI;UACJ,IAAI,CAAC,IAAI,CAACkH,QAAQ,EAAE,EAAE;YACrB,IAAI,CAACF,MAAM,CAACC,YAAY,CAAC,SAAS,CAAC;;UAEpC,IAAI,CAACjH,GAAG,CAAC,aAAa,EAAE,KAAK,CAAC;;QAE/B,IAAI,CAACmH,sBAAsB,EAAE;;MAG9B,IAAI,IAAI,CAAChB,OAAO,CAAC,UAAU,CAAC,EAAE;QAC7B,IAAI,IAAI,CAAC3D,GAAG,CAAC,UAAU,CAAC,EAAE;UACzB,IAAI,CAACwE,MAAM,CAACC,YAAY,CAAC,UAAU,CAAC;UACpC,IAAI,CAACjH,GAAG,CAAC,aAAa,EAAE,KAAK,CAAC;SAC9B,MACI;UACJ,IAAI,CAAC,IAAI,CAACkH,QAAQ,EAAE,EAAE;YACrB,IAAI,CAACF,MAAM,CAACC,YAAY,CAAC,SAAS,CAAC;;UAEpC,IAAI,CAACjH,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC;;QAE9B,IAAI,CAACmH,sBAAsB,EAAE;;MAE9B,IAAI,CAACJ,cAAc,GAAG,IAAI;;EAE5B;EAEOK,QAAQA,CAAA;IACd,KAAK,CAACA,QAAQ,EAAE;IAEhB,MAAMC,OAAO,GAAG,IAAI,CAACpH,QAAQ;IAC7B,MAAME,MAAM,GAAG,IAAI,CAACA,MAAM;IAE1B,IAAI,IAAI,CAACgG,OAAO,CAAC,WAAW,CAAC,EAAE;MAC9B,MAAMmB,SAAS,GAAG,IAAI,CAAC9E,GAAG,CAAC,WAAW,CAAC;MACvC,IAAI8E,SAAS,EAAE;QACd,IAAI,CAACtH,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC;QAE7B,IAAI,CAACuH,OAAO,GAAG,IAAIhJ,aAAa,CAAC,CAChC4B,MAAM,CAACI,EAAE,CAAC,aAAa,EAAGiH,EAAE,IAAI;UAC/B,IAAI,CAACC,SAAS,CAACD,EAAE,CAAC;QACnB,CAAC,CAAC,EAEFrH,MAAM,CAACI,EAAE,CAAC,mBAAmB,EAAGiH,EAAE,IAAI;UACrC,IAAI,CAACE,QAAQ,CAACF,EAAE,CAAC;QAClB,CAAC,CAAC,EAEFrH,MAAM,CAACI,EAAE,CAAC,iBAAiB,EAAGiH,EAAE,IAAI;UACnC,IAAI,CAACG,QAAQ,CAACH,EAAE,CAAC;QAClB,CAAC,CAAC,CAAC,CAAC;OAEL,MACI;QACJ,IAAI,IAAI,CAACD,OAAO,EAAE;UACjB,IAAI,CAACA,OAAO,CAAC7G,OAAO,EAAE;UACtB,IAAI,CAAC6G,OAAO,GAAGlH,SAAS;;;MAG1BgH,OAAO,CAACO,WAAW,GAAGN,SAAS,GAAG,IAAI,GAAG,KAAK;;IAG/C,IAAI,IAAI,CAACnB,OAAO,CAAC,aAAa,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,aAAa,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,eAAe,CAAC,EAAE;MAChG,MAAM0B,WAAW,GAAG,IAAI,CAACrF,GAAG,CAAC,aAAa,CAAC;MAC3C,MAAMsF,WAAW,GAAG,IAAI,CAACtF,GAAG,CAAC,aAAa,CAAC;MAC3C,MAAMuF,aAAa,GAAG,IAAI,CAACvF,GAAG,CAAC,eAAe,EAAE,OAAO,CAAC;MACxD,IAAI,IAAI,CAACwF,UAAU,EAAE;QACpB,IAAI,CAACA,UAAU,CAACtH,OAAO,EAAE;QACzB,IAAI,CAACsH,UAAU,GAAG3H,SAAS;;MAE5B,IAAIwH,WAAW,IAAIC,WAAW,EAAE;QAC/B,IAAIC,aAAa,IAAI,OAAO,EAAE;UAC7B,IAAI,CAACC,UAAU,GAAG,IAAIzJ,aAAa,CAAC,CACnC4B,MAAM,CAACI,EAAE,CAAC,OAAO,EAAE,MAAK;YACvB,IAAI,CAAC0H,UAAU,CAAC,MAAK;cACpB,MAAM3B,OAAO,GAAG,IAAI,CAAC4B,UAAU,EAAE;cACjC,IAAI5B,OAAO,IAAI,CAACA,OAAO,CAACY,QAAQ,EAAE,IAAIZ,OAAO,CAAC9D,GAAG,CAAC,eAAe,CAAC,KAAK,IAAI,EAAE;gBAC5E,IAAI,CAAC2F,WAAW,EAAE;eAClB,MACI;gBACJ,IAAI,CAACrB,WAAW,EAAE;;YAEpB,CAAC,EAAE,EAAE,CAAC;UACP,CAAC,CAAC,EACFpI,MAAM,CAAC0J,gBAAgB,CAACC,QAAQ,EAAE,OAAO,EAAGC,GAAe,IAAI;YAC9D,IAAI,CAACH,WAAW,EAAE;UACnB,CAAC,CAAC,CACF,CAAC;UACF,IAAI,CAACI,UAAU,CAACC,IAAI,CAAC,IAAI,CAACR,UAAU,CAAC;SACrC,MACI,IAAID,aAAa,IAAI,QAAQ,EAAE;UACnC;QAAA,CACA,MACI;UACJ,IAAI,CAACC,UAAU,GAAG,IAAIzJ,aAAa,CAAC,CACnC4B,MAAM,CAACI,EAAE,CAAC,aAAa,EAAE,MAAK;YAC7B,IAAI,CAACuG,WAAW,EAAE;UACnB,CAAC,CAAC,EACF3G,MAAM,CAACI,EAAE,CAAC,YAAY,EAAE,MAAK;YAC5B,IAAI,CAAC4H,WAAW,EAAE;UACnB,CAAC,CAAC,CACF,CAAC;UACF,IAAI,CAACI,UAAU,CAACC,IAAI,CAAC,IAAI,CAACR,UAAU,CAAC;;;;IAKxC,IAAI,IAAI,CAAC7B,OAAO,CAAC,WAAW,CAAC,EAAE;MAC9B,IAAIsC,SAAS,GAAG,IAAI,CAACjG,GAAG,CAAC,WAAW,CAAQ;MAC5C,IAAIiG,SAAS,IAAIA,SAAS,IAAI,MAAM,EAAE;QACrC,IAAI,CAACC,SAAS,GAAGvI,MAAM,CAACI,EAAE,CAAC,OAAO,EAAE,MAAK;UACxC,IAAI,CAAC,IAAI,CAACoI,WAAW,EAAE;YACtB,IAAI,CAAC3I,GAAG,CAACyI,SAAS,EAAE,CAAC,IAAI,CAACjG,GAAG,CAACiG,SAAS,CAAC,CAAC;;QAE3C,CAAC,CAAC;OACF,MACI;QACJ,IAAI,IAAI,CAACC,SAAS,EAAE;UACnB,IAAI,CAACA,SAAS,CAAChI,OAAO,EAAE;UACxB,IAAI,CAACgI,SAAS,GAAGrI,SAAS;;;;IAM7B,IAAI,IAAI,CAAC8F,OAAO,CAAC,SAAS,CAAC,EAAE;MAC5BkB,OAAO,CAACuB,KAAK,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE,IAAI,CAACtG,GAAG,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;MACnD,IAAI,IAAI,CAACA,GAAG,CAAC,WAAW,CAAC,EAAE;QAC1B,IAAI,CAAC2E,sBAAsB,EAAE;;;IAI/B,IAAI,IAAI,CAAChB,OAAO,CAAC,UAAU,CAAC,EAAE;MAC7B,IAAI,CAACvC,eAAe,EAAE;MACtByD,OAAO,CAAC0B,KAAK,GAAG,IAAI,CAACvG,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC;;IAGxC,IAAI,IAAI,CAAC2D,OAAO,CAAC,OAAO,CAAC,EAAE;MAC1B,IAAI,CAACvC,eAAe,EAAE;MACtByD,OAAO,CAAC2B,KAAK,GAAG,IAAI,CAACxG,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;;IAGrC,IAAI,IAAI,CAAC2D,OAAO,CAAC,SAAS,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,SAAS,CAAC,EAAE;MACvD,IAAI,CAACvC,eAAe,EAAE;MACtB,IAAI,CAAC6B,gBAAgB,EAAE;;IAGxB,IAAI,IAAI,CAACU,OAAO,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC8C,cAAc,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC9C,OAAO,CAAC,aAAa,CAAC,EAAE;MAC7F,IAAI,CAAC,IAAI,CAAC3D,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAACN,UAAU,CAAC,SAAS,CAAC,IAAI,IAAI,CAACM,GAAG,CAAC,aAAa,CAAC,EAAE;QACnF6E,OAAO,CAAC6B,OAAO,GAAG,KAAK;QACvB,IAAI,CAACf,WAAW,EAAE;OAClB,MACI;QACJd,OAAO,CAAC6B,OAAO,GAAG,IAAI;;MAGvB,IAAI,CAACtF,eAAe,EAAE;MACtB,IAAI,IAAI,CAACpB,GAAG,CAAC,WAAW,CAAC,EAAE;QAC1B,IAAI,CAAC2E,sBAAsB,EAAE;;;IAI/B,IAAI,IAAI,CAAChB,OAAO,CAAC,OAAO,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,QAAQ,CAAC,EAAE;MACpD,IAAI,CAACvC,eAAe,EAAE;MACtB,IAAI,CAACuB,0BAA0B,EAAE;MAEjC,MAAM3D,MAAM,GAAG,IAAI,CAACA,MAAM;MAC1B,IAAIA,MAAM,EAAE;QACX,IAAK,IAAI,CAAC2E,OAAO,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC3D,GAAG,CAAC,OAAO,CAAC,YAAYnE,OAAO,IAAM,IAAI,CAAC8H,OAAO,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC3D,GAAG,CAAC,QAAQ,CAAC,YAAYnE,OAAQ,EAAE;UACzImD,MAAM,CAAC2H,SAAS,EAAE;UAClB3H,MAAM,CAAC4H,UAAU,GAAG,CAAC;;;MAIvB,IAAI,CAACC,UAAU,GAAG,IAAI;;IAGvB,IAAI,IAAI,CAAClD,OAAO,CAAC,UAAU,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC8C,cAAc,CAAC,OAAO,CAAC,IAAI,IAAI,CAACA,cAAc,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC9C,OAAO,CAAC,UAAU,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC8C,cAAc,CAAC,UAAU,CAAC,IAAI,IAAI,CAACA,cAAc,CAAC,WAAW,CAAC,IAAI,IAAI,CAACA,cAAc,CAAC,UAAU,CAAC,IAAI,IAAI,CAACA,cAAc,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC9C,OAAO,CAAC,YAAY,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,WAAW,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,aAAa,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,cAAc,CAAC,EAAE;MAC5b,IAAI,CAACvC,eAAe,EAAE;MACtB,IAAI,CAACyF,UAAU,GAAG,IAAI;;IAGvB,IAAI,IAAI,CAACA,UAAU,EAAE;MACpB,IAAI,CAACC,WAAW,EAAE;;IAGnB,IAAI,IAAI,CAACnD,OAAO,CAAC,WAAW,CAAC,EAAE;MAC9B,MAAMoD,SAAS,GAAG,IAAI,CAAC/G,GAAG,CAAC,WAAW,CAAC;MACvC,IAAI+G,SAAS,EAAE;QACd,IAAI,CAACvJ,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC;;MAE9BqH,OAAO,CAACkC,SAAS,GAAGA,SAAS,GAAG,IAAI,GAAG,KAAK;;IAG7C;IACA,IAAI,IAAI,CAACpD,OAAO,CAAC,eAAe,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,gBAAgB,CAAC,EAAE;MACpE,IAAI,IAAI,CAAC3D,GAAG,CAAC,WAAW,CAAC,EAAE;QAC1B,IAAI,CAACM,KAAK,CAAC0G,sBAAsB,CAAC,IAAI,CAAC;OACvC,MACI;QACJ,IAAI,CAAC1G,KAAK,CAAC2G,wBAAwB,CAAC,IAAI,CAAC;;;IAI3C,IAAI,IAAI,CAACtD,OAAO,CAAC,QAAQ,CAAC,EAAE;MAC3B;MACAkB,OAAO,CAACqC,MAAM,GAAG,IAAI,CAAClH,GAAG,CAAC,QAAQ,CAAC;;IAGpC,IAAIkH,MAAM,GAAG,IAAI,CAAClH,GAAG,CAAC,QAAQ,EAAE,EAAE,CAAC;IAEnC,IAAI,IAAI,CAAC2D,OAAO,CAAC,MAAM,CAAC,EAAE;MACzB,MAAMwD,IAAI,GAAG,IAAI,CAACnH,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC;MAChC,IAAImH,IAAI,IAAI,CAAC,EAAE;QACdD,MAAM,IAAI,QAAQ,GAAGC,IAAI,GAAG,KAAK;;;IAInC,IAAI,IAAI,CAACxD,OAAO,CAAC,UAAU,CAAC,EAAE;MAC7B,MAAMyD,QAAQ,GAAG,IAAI,CAACpH,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC;MACxC,IAAIoH,QAAQ,IAAI,CAAC,EAAE;QAClBF,MAAM,IAAI,YAAY,GAAGE,QAAQ,GAAG,GAAG;;;IAIzC,IAAI,IAAI,CAACzD,OAAO,CAAC,YAAY,CAAC,EAAE;MAC/B,MAAM0D,UAAU,GAAG,IAAI,CAACrH,GAAG,CAAC,YAAY,EAAE,CAAC,CAAC;MAC5C,IAAIqH,UAAU,IAAI,CAAC,EAAE;QACpBH,MAAM,IAAI,cAAc,GAAGG,UAAU,GAAG,GAAG;;;IAI7C,IAAI,IAAI,CAAC1D,OAAO,CAAC,UAAU,CAAC,EAAE;MAC7B,MAAM2D,QAAQ,GAAG,IAAI,CAACtH,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC;MACxC,IAAIsH,QAAQ,IAAI,CAAC,EAAE;QAClBJ,MAAM,IAAI,YAAY,GAAGI,QAAQ,GAAG,GAAG;;;IAIzC,IAAI,IAAI,CAAC3D,OAAO,CAAC,OAAO,CAAC,EAAE;MAC1B,MAAM4D,KAAK,GAAG,IAAI,CAACvH,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;MAClC,IAAIuH,KAAK,IAAI,CAAC,EAAE;QACfL,MAAM,IAAI,SAAS,GAAGK,KAAK,GAAG,GAAG;;;IAInC,IAAI,IAAI,CAAC5D,OAAO,CAAC,KAAK,CAAC,EAAE;MACxB,MAAM6D,GAAG,GAAG,IAAI,CAACxH,GAAG,CAAC,KAAK,EAAE,CAAC,CAAC;MAC9B,IAAIwH,GAAG,IAAI,CAAC,EAAE;QACbN,MAAM,IAAI,cAAc,GAAGM,GAAG,GAAG,MAAM;;;IAIzC,IAAI,IAAI,CAAC7D,OAAO,CAAC,QAAQ,CAAC,EAAE;MAC3B,MAAM8D,MAAM,GAAG,IAAI,CAACzH,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC;MACpC,IAAIyH,MAAM,IAAI,CAAC,EAAE;QAChBP,MAAM,IAAI,UAAU,GAAGO,MAAM,GAAG,GAAG;;;IAKrC,IAAIP,MAAM,EAAE;MACXrC,OAAO,CAACqC,MAAM,GAAGA,MAAM;;IAGxB,IAAI,IAAI,CAACvD,OAAO,CAAC,iBAAiB,CAAC,EAAE;MACpCkB,OAAO,CAAC6C,eAAe,GAAG,IAAI,CAAC1H,GAAG,CAAC,iBAAiB,CAAC;;IAGtD,IAAI,IAAI,CAAC2D,OAAO,CAAC,cAAc,CAAC,EAAE;MACjC,IAAI,IAAI,CAAC3D,GAAG,CAAC,cAAc,CAAC,EAAE;QAC7B,IAAI,CAAC2H,QAAQ,GAAG,IAAI5L,aAAa,CAAC,CACjC4B,MAAM,CAACI,EAAE,CAAC,OAAO,EAAE,MAAK;UACvB;UACA,IAAI,CAACuG,WAAW,EAAE;QACnB,CAAC,CAAC,EAEF3G,MAAM,CAACI,EAAE,CAAC,MAAM,EAAE,MAAK;UACtB;UACA,IAAI,CAAC4H,WAAW,EAAE;QACnB,CAAC,CAAC,CAAC,CAAC;OACL,MACI;QACJ,IAAI,IAAI,CAACgC,QAAQ,EAAE;UAClB,IAAI,CAACA,QAAQ,CAACzJ,OAAO,EAAE;UACvB,IAAI,CAACyJ,QAAQ,GAAG9J,SAAS;;;;IAK5B,IAAI,IAAI,CAAC8F,OAAO,CAAC,WAAW,CAAC,EAAE;MAC9B,IAAI,IAAI,CAAC3D,GAAG,CAAC,WAAW,CAAC,EAAE;QAC1B,IAAI,CAACM,KAAK,CAAC0G,sBAAsB,CAAC,IAAI,CAAC;OACvC,MACI;QACJ,IAAI,CAAC1G,KAAK,CAAC2G,wBAAwB,CAAC,IAAI,CAAC;;MAE1C,IAAI,CAACtC,sBAAsB,EAAE;MAC7B,IAAI,CAACoB,UAAU,CAACC,IAAI,CAACrI,MAAM,CAACI,EAAE,CAAC,MAAM,EAAE,MAAK;QAC3C,IAAI,CAACkD,aAAa,CAAC,eAAe,EAAE,KAAK,CAAC;MAC3C,CAAC,CAAC,CAAC;;IAGJ,IAAI,IAAI,CAACwF,cAAc,CAAC,WAAW,CAAC,EAAE;MACrC,IAAI,CAAC9B,sBAAsB,EAAE;;IAG9B,IAAI,IAAI,CAAChB,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,UAAU,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,aAAa,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,YAAY,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,iBAAiB,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,cAAc,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,cAAc,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,cAAc,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,eAAe,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,WAAW,CAAC,IAAI,IAAI,CAACA,OAAO,CAAC,cAAc,CAAC,EAAE;MACnV;MACA;MACA,IAAI,CAACgB,sBAAsB,EAAE;;IAG9B,IAAI,IAAI,CAAChB,OAAO,CAAC,YAAY,CAAC,EAAE;MAC/BkB,OAAO,CAAC+C,UAAU,GAAG,IAAI,CAAC5H,GAAG,CAAC,YAAY,CAAC;;IAG5C,IAAI,IAAI,CAAC2D,OAAO,CAAC,aAAa,CAAC,EAAE;MAChC,MAAMhG,MAAM,GAAG,IAAI,CAACA,MAAM;MAC1B,IAAI,IAAI,CAACqC,GAAG,CAAC,aAAa,CAAC,IAAI,CAACrC,MAAM,CAACkK,UAAU,EAAE,EAAE;QACpD,IAAI,CAACC,QAAQ,GAAG,IAAI/L,aAAa,CAAC,CACjC4B,MAAM,CAACI,EAAE,CAAC,OAAO,EAAGiH,EAAE,IAAI;UACzB,IAAI9I,MAAM,CAAC6L,YAAY,CAAC/C,EAAE,CAAC/H,aAAa,CAAC,EAAE;YAC1C,IAAI,CAAC,IAAI,CAACyC,UAAU,CAAC,eAAe,CAAC,EAAE;cACtC,IAAI,CAAC+F,UAAU,CAAC,MAAK;gBACpB,IAAI,CAACuC,WAAW,EAAE;gBAClB,IAAI,IAAI,CAAChI,GAAG,CAAC,aAAa,CAAC,IAAI,IAAI,CAACA,GAAG,CAAC,aAAa,CAAC,EAAE;kBACvD,IAAI,CAACsE,WAAW,EAAE;;gBAEnB,IAAI,CAACrD,aAAa,CAAC,eAAe,EAAE,IAAI,CAAC;gBACzC,IAAI,CAACtD,MAAM,CAACJ,QAAQ,CAAC,aAAa,EAAE;kBACnCP,IAAI,EAAE,aAAa;kBACnBK,MAAM,EAAE2H,EAAE,CAAC3H,MAAM;kBACjBJ,aAAa,EAAE+H,EAAE,CAAC/H,aAAa;kBAC/BC,KAAK,EAAE8H,EAAE,CAAC9H,KAAK;kBACfC,SAAS,EAAE6H,EAAE,CAAC7H;iBACd,CAAC;cACH,CAAC,EAAE,EAAE,CAAC;;;QAGT,CAAC,CAAC,EAEFQ,MAAM,CAACI,EAAE,CAAC,iBAAiB,EAAGiH,EAAE,IAAI;UACnC,IAAI9I,MAAM,CAAC6L,YAAY,CAAC/C,EAAE,CAAC/H,aAAa,CAAC,EAAE;YAC1C,IAAI,IAAI,CAACyC,UAAU,CAAC,eAAe,CAAC,EAAE;cACrC,IAAI,CAACuI,UAAU,EAAE;cACjB,IAAI,IAAI,CAACjI,GAAG,CAAC,aAAa,CAAC,IAAI,IAAI,CAACA,GAAG,CAAC,aAAa,CAAC,EAAE;gBACvD,IAAI,CAAC2F,WAAW,EAAE;;cAEnB,IAAI,CAAC1E,aAAa,CAAC,eAAe,EAAE,KAAK,CAAC;cAC1C,IAAI,CAACtD,MAAM,CAACJ,QAAQ,CAAC,YAAY,EAAE;gBAClCP,IAAI,EAAE,YAAY;gBAClBK,MAAM,EAAE2H,EAAE,CAAC3H,MAAM;gBACjBJ,aAAa,EAAE+H,EAAE,CAAC/H,aAAa;gBAC/BC,KAAK,EAAE8H,EAAE,CAAC9H,KAAK;gBACfC,SAAS,EAAE6H,EAAE,CAAC7H;eACd,CAAC;;;UAIJ,IAAI,IAAI,CAAC+K,OAAO,EAAE;YACjB,IAAI,CAACC,SAAS,CAACnD,EAAE,CAAC;;UAEnB;QACD,CAAC,CAAC,EAEFrH,MAAM,CAACI,EAAE,CAAC,aAAa,EAAE,MAAK;UAC7B,IAAI,CAACiK,WAAW,EAAE;QACnB,CAAC,CAAC,EAEFrK,MAAM,CAACI,EAAE,CAAC,YAAY,EAAE,MAAK;UAC5B,IAAI,CAACkK,UAAU,EAAE;QAClB,CAAC,CAAC,EAEFtK,MAAM,CAACI,EAAE,CAAC,aAAa,EAAGC,CAAC,IAAI;UAC9B,IAAI,CAACoK,WAAW,CAACpK,CAAC,CAAC;QACpB,CAAC,CAAC,CACF,CAAC;OACF,MACI;QACJ,IAAI,CAACP,QAAQ,CAACC,WAAW,GAAG,KAAK;QACjC,IAAI,IAAI,CAACoK,QAAQ,EAAE;UAClB,IAAI,CAACA,QAAQ,CAAC5J,OAAO,EAAE;UACvB,IAAI,CAAC4J,QAAQ,GAAGjK,SAAS;;;;IAK5B,IAAI,IAAI,CAAC8F,OAAO,CAAC,eAAe,CAAC,EAAE;MAClC,IAAI,CAAClG,QAAQ,CAAC4K,QAAQ,GAAG,IAAI,CAACrI,GAAG,CAAC,eAAe,EAAE,IAAI,CAAC;;IAGzD,IAAI,IAAI,CAACA,GAAG,CAAC,eAAe,CAAC,IAAI,QAAQ,IAAI,IAAI,CAACvC,QAAQ,CAACiJ,OAAO,EAAE;MACnE,IAAI,CAACpC,WAAW,EAAE;;EAEpB;EAEA;;;;EAIOW,SAASA,CAACjH,CAAsB;IACtC,IAAI,CAACsK,UAAU,GAAGtK,CAAC;IACnB,IAAI,CAACL,MAAM,CAACiB,kBAAkB,EAAE;EACjC;EAEA;;;;EAIOuG,QAAQA,CAACnH,CAAsB;IACrC,IAAI,CAACsK,UAAU,GAAGzK,SAAS;IAC3B,IAAI,CAAC0K,UAAU,GAAG1K,SAAS;IAC3B,IAAI,CAACF,MAAM,CAACiB,kBAAkB,EAAE;IAEhC,IAAI,IAAI,CAACuH,WAAW,EAAE;MACrB,IAAI,CAACA,WAAW,GAAG,KAAK;MAExB,MAAMnJ,IAAI,GAAG,UAAU;MACvB,IAAI,IAAI,CAACW,MAAM,CAACuB,SAAS,CAAClC,IAAI,CAAC,EAAE;QAChC,IAAI,CAACW,MAAM,CAACJ,QAAQ,CAACP,IAAI,EAAE;UAC1BA,IAAI,EAAEA,IAAI;UACVK,MAAM,EAAE,IAAI;UACZJ,aAAa,EAAEe,CAAC,CAACf,aAAa;UAC9BC,KAAK,EAAEc,CAAC,CAACd,KAAK;UACdC,SAAS,EAAEa,CAAC,CAACb;SACb,CAAC;;;EAGL;EAEU6K,WAAWA,CAAA;IACpB,IAAI,CAAC,IAAI,CAACtD,QAAQ,EAAE,EAAE;MACrB,IAAI,IAAI,CAAC1E,GAAG,CAAC,QAAQ,CAAC,IAAI,IAAI,CAACwE,MAAM,CAACgE,MAAM,CAAC,aAAa,CAAC,EAAE;QAC5D,IAAI,CAAChE,MAAM,CAACC,YAAY,CAAC,aAAa,CAAC;OACvC,MACI,IAAI,IAAI,CAACzE,GAAG,CAAC,UAAU,CAAC,IAAI,IAAI,CAACwE,MAAM,CAACgE,MAAM,CAAC,eAAe,CAAC,EAAE;QACrE,IAAI,CAAChE,MAAM,CAACC,YAAY,CAAC,eAAe,CAAC;OACzC,MACI;QACJ,IAAI,CAACD,MAAM,CAACC,YAAY,CAAC,OAAO,CAAC;;MAElC,IAAI,IAAI,CAACzE,GAAG,CAAC,WAAW,CAAC,IAAI,IAAI,CAACkI,OAAO,IAAI,IAAI,CAAC1D,MAAM,CAACgE,MAAM,CAAC,MAAM,CAAC,EAAE;QACxE,IAAI,CAAChE,MAAM,CAACC,YAAY,CAAC,MAAM,CAAC;;;EAGnC;EAEUwD,UAAUA,CAAA;IACnB,IAAI,CAAC,IAAI,CAACvD,QAAQ,EAAE,EAAE;MACrB,IAAI,IAAI,CAAC1E,GAAG,CAAC,QAAQ,CAAC,IAAI,IAAI,CAACwE,MAAM,CAACgE,MAAM,CAAC,QAAQ,CAAC,EAAE;QACvD,IAAI,CAAChE,MAAM,CAACC,YAAY,CAAC,QAAQ,CAAC;OAClC,MACI,IAAI,IAAI,CAACzE,GAAG,CAAC,UAAU,CAAC,IAAI,IAAI,CAACwE,MAAM,CAACgE,MAAM,CAAC,UAAU,CAAC,EAAE;QAChE,IAAI,CAAChE,MAAM,CAACC,YAAY,CAAC,UAAU,CAAC;OACpC,MACI;QACJ,IAAI,IAAI,CAACD,MAAM,CAACgE,MAAM,CAAC,OAAO,CAAC,IAAI,IAAI,CAAChE,MAAM,CAACgE,MAAM,CAAC,aAAa,CAAC,EAAE;UACrE,IAAI,CAAChE,MAAM,CAACC,YAAY,CAAC,SAAS,CAAC;;;MAGrC,IAAI,IAAI,CAACzE,GAAG,CAAC,WAAW,CAAC,IAAI,IAAI,CAACkI,OAAO,IAAI,IAAI,CAAC1D,MAAM,CAACgE,MAAM,CAAC,MAAM,CAAC,EAAE;QACxE,IAAI,CAAChE,MAAM,CAACC,YAAY,CAAC,MAAM,CAAC;;;EAGnC;EAEU0D,SAASA,CAACnK,CAAsB;IACzC,IAAI,CAAC,IAAI,CAAC0G,QAAQ,EAAE,EAAE;MACrB,IAAI,IAAI,CAAC1E,GAAG,CAAC,QAAQ,CAAC,IAAI,IAAI,CAACwE,MAAM,CAACgE,MAAM,CAAC,QAAQ,CAAC,EAAE;QACvD,IAAI,CAAChE,MAAM,CAACC,YAAY,CAAC,QAAQ,CAAC;OAClC,MACI,IAAI,IAAI,CAACzE,GAAG,CAAC,UAAU,CAAC,IAAI,IAAI,CAACwE,MAAM,CAACgE,MAAM,CAAC,UAAU,CAAC,EAAE;QAChE,IAAI,CAAChE,MAAM,CAACC,YAAY,CAAC,UAAU,CAAC;OACpC,MACI,IAAI,IAAI,CAACD,MAAM,CAACgE,MAAM,CAAC,MAAM,CAAC,EAAE;QACpC,IAAI,IAAI,CAACnE,OAAO,EAAE,EAAE;UACnB,IAAI,CAACG,MAAM,CAACC,YAAY,CAAC,OAAO,CAAC;SACjC,MACI;UACJ,IAAI,CAACD,MAAM,CAACC,YAAY,CAAC,SAAS,CAAC;;;MAKrC;MACA,IAAI,CAACgE,UAAU,GAAG5K,SAAS;MAE3B,MAAM6K,SAAS,GAAGxM,MAAM,CAACyM,YAAY,CAAC3K,CAAC,CAACf,aAAa,CAAC;MACtD,OAAO,IAAI,CAAC2L,WAAW,CAACF,SAAS,CAAC;MAElC,IAAIrM,OAAO,CAACwM,IAAI,CAAC,IAAI,CAACD,WAAW,CAAC,CAACE,MAAM,IAAI,CAAC,EAAE;QAC/C,IAAI,CAACZ,OAAO,GAAG,KAAK;;;EAGvB;EAEO7I,SAASA,CAACrB,CAAsB;IACtC;IACA;IACA;IACA;IACA;IACA;IAEA,MAAM0K,SAAS,GAAGxM,MAAM,CAACyM,YAAY,CAAC3K,CAAC,CAACf,aAAa,CAAC;IACtD,MAAM8L,SAAS,GAAG,IAAI,CAACH,WAAW,CAACF,SAAS,CAAC;IAC7C,IAAIK,SAAS,EAAE;MACd,MAAM1F,CAAC,GAAGgD,IAAI,CAAC2C,GAAG,CAACD,SAAS,CAAC1F,CAAC,GAAGrF,CAAC,CAACd,KAAK,CAACmG,CAAC,CAAC;MAC3C,MAAMG,CAAC,GAAG6C,IAAI,CAAC2C,GAAG,CAACD,SAAS,CAACvF,CAAC,GAAGxF,CAAC,CAACd,KAAK,CAACsG,CAAC,CAAC;MAC3C,OAAQH,CAAC,GAAG,CAAC,IAAMG,CAAC,GAAG,CAAE;;IAG1B,OAAO,KAAK;EACb;EAEOpE,QAAQA,CAAA;IACd,OAAO/C,OAAO,CAACwM,IAAI,CAAC,IAAI,CAACD,WAAW,CAAC,CAACE,MAAM,GAAG,CAAC;EACjD;EAEUV,WAAWA,CAACpK,CAAsB;IAE3C,MAAMgB,MAAM,GAAG,IAAI,CAACA,MAAM;IAC1B,IAAIA,MAAM,IAAI,CAAC,IAAI,CAACgB,GAAG,CAAC,WAAW,CAAC,EAAE;MACrChB,MAAM,CAACoJ,WAAW,CAACpK,CAAC,CAAC;;IAGtB,IAAI,IAAI,CAACgC,GAAG,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC0E,QAAQ,EAAE,EAAE;MAChD,IAAI,IAAI,CAACF,MAAM,CAACgE,MAAM,CAAC,MAAM,CAAC,EAAE;QAC/B,IAAI,CAAChE,MAAM,CAACC,YAAY,CAAC,MAAM,CAAC;;MAEjC,IAAI,CAACgE,UAAU,GAAG;QACjBpF,CAAC,EAAErF,CAAC,CAACd,KAAK,CAACmG,CAAC;QACZG,CAAC,EAAExF,CAAC,CAACd,KAAK,CAACsG;OACX;MAGD;MACA,IAAI,CAAC0E,OAAO,GAAG,IAAI;MAEnB,MAAMQ,SAAS,GAAGxM,MAAM,CAACyM,YAAY,CAAC3K,CAAC,CAACf,aAAa,CAAC;MACtD,IAAI,CAAC2L,WAAW,CAACF,SAAS,CAAC,GAAG;QAC7BrF,CAAC,EAAErF,CAAC,CAACd,KAAK,CAACmG,CAAC;QACZG,CAAC,EAAExF,CAAC,CAACd,KAAK,CAACsG;OACX;;EAEH;EAEA;;;;EAIO0B,QAAQA,CAAClH,CAAsB;IACrC,IAAIiL,SAAS,GAAG,IAAI,CAACX,UAAU;IAE/B,IAAIW,SAAS,EAAE;MAEd,IAAIA,SAAS,CAAC9L,SAAS,IAAI,CAACa,CAAC,CAACb,SAAS,EAAE;QACxC,OAAO,IAAI;;MAGZ,IAAIoJ,KAAK,GAAG,CAAC;MAEb,IAAIvH,MAAM,GAAG,IAAI,CAACA,MAAM;MACxB,IAAIwH,KAAK,GAAG,CAAC;MAEb,OAAOxH,MAAM,IAAI,IAAI,EAAE;QACtBuH,KAAK,IAAIvH,MAAM,CAACgB,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC;QAClChB,MAAM,GAAGA,MAAM,CAACA,MAAM;QACtB,IAAIA,MAAM,EAAE;UACXwH,KAAK,IAAIxH,MAAM,CAACgB,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;;;MAIjC,IAAIqD,CAAC,GAAG,CAACrF,CAAC,CAACd,KAAK,CAACmG,CAAC,GAAG4F,SAAS,CAAC/L,KAAK,CAACmG,CAAC,IAAImD,KAAK;MAC/C,IAAIhD,CAAC,GAAG,CAACxF,CAAC,CAACd,KAAK,CAACsG,CAAC,GAAGyF,SAAS,CAAC/L,KAAK,CAACsG,CAAC,IAAIgD,KAAK;MAE/C,MAAM7I,MAAM,GAAG,IAAI,CAACA,MAAM;MAE1B,IAAIsL,SAAS,CAAC9L,SAAS,IAAI,CAAC,IAAI,CAACgJ,WAAW,EAAE;QAC7C,IAAI,CAACA,WAAW,GAAG,IAAI;QACvB,IAAI,CAACmC,UAAU,GAAGtK,CAAC;QAEnB,IAAI,CAACuK,UAAU,GAAG;UACjBlF,CAAC,EAAE,IAAI,CAACA,CAAC,EAAE;UACXG,CAAC,EAAE,IAAI,CAACA,CAAC;SACT;QAED,MAAMxG,IAAI,GAAG,WAAW;QACxB,IAAIW,MAAM,CAACuB,SAAS,CAAClC,IAAI,CAAC,EAAE;UAC3BW,MAAM,CAACJ,QAAQ,CAACP,IAAI,EAAE;YACrBA,IAAI,EAAEA,IAAI;YACVK,MAAM,EAAE,IAAI;YACZJ,aAAa,EAAEe,CAAC,CAACf,aAAa;YAC9BC,KAAK,EAAEc,CAAC,CAACd,KAAK;YACdC,SAAS,EAAEa,CAAC,CAACb;WACb,CAAC;;;MAIJ,IAAI,IAAI,CAACgJ,WAAW,EAAE;QACrB,IAAI+C,SAAS,GAAG,IAAI,CAACX,UAAW;QAEhC,IAAI,CAAC/K,GAAG,CAAC,GAAG,EAAE0L,SAAS,CAAC7F,CAAC,GAAGA,CAAC,GAAG/G,KAAK,CAAC6M,GAAG,CAAC5C,KAAK,CAAC,GAAG/C,CAAC,GAAGlH,KAAK,CAAC8M,GAAG,CAAC7C,KAAK,CAAC,CAAC;QACxE,IAAI,CAAC/I,GAAG,CAAC,GAAG,EAAE0L,SAAS,CAAC1F,CAAC,GAAGA,CAAC,GAAGlH,KAAK,CAAC6M,GAAG,CAAC5C,KAAK,CAAC,GAAGlD,CAAC,GAAG/G,KAAK,CAAC8M,GAAG,CAAC7C,KAAK,CAAC,CAAC;QAExE,MAAMvJ,IAAI,GAAG,SAAS;QACtB,IAAIW,MAAM,CAACuB,SAAS,CAAClC,IAAI,CAAC,EAAE;UAC3BW,MAAM,CAACJ,QAAQ,CAACP,IAAI,EAAE;YACrBA,IAAI,EAAEA,IAAI;YACVK,MAAM,EAAE,IAAI;YACZJ,aAAa,EAAEe,CAAC,CAACf,aAAa;YAC9BC,KAAK,EAAEc,CAAC,CAACd,KAAK;YACdC,SAAS,EAAEa,CAAC,CAACb;WACb,CAAC;;OAGH,MAAM;QACN,IAAIkJ,IAAI,CAACgD,KAAK,CAAChG,CAAC,EAAEG,CAAC,CAAC,GAAG,CAAC,EAAE;UACzB,IAAI,CAAC2C,WAAW,GAAG,IAAI;UACvB,IAAI,CAACmC,UAAU,GAAGtK,CAAC;UAEnB,IAAI,CAACuK,UAAU,GAAG;YACjBlF,CAAC,EAAE,IAAI,CAACA,CAAC,EAAE;YACXG,CAAC,EAAE,IAAI,CAACA,CAAC;WACT;UAED,MAAMxG,IAAI,GAAG,WAAW;UACxB,IAAIW,MAAM,CAACuB,SAAS,CAAClC,IAAI,CAAC,EAAE;YAC3BW,MAAM,CAACJ,QAAQ,CAACP,IAAI,EAAE;cACrBA,IAAI,EAAEA,IAAI;cACVK,MAAM,EAAE,IAAI;cACZJ,aAAa,EAAEe,CAAC,CAACf,aAAa;cAC9BC,KAAK,EAAEc,CAAC,CAACd,KAAK;cACdC,SAAS,EAAEa,CAAC,CAACb;aACb,CAAC;;;;;EAKP;EAEO2J,WAAWA,CAAA,GAElB;EAEOnH,UAAUA,CAAA;IAChB,IAAI,CAACuD,YAAY,GAAG,IAAI,CAACzF,QAAQ,CAAC6L,cAAc,EAAE;EACnD;EAEA;;;;;;EAMOC,KAAKA,CAAA;IACX,IAAIC,IAAI,GAA0B,IAAI,CAACxK,MAAM;IAC7C,IAAIuK,KAAK,GAAG,CAAC;IAEb,OAAO,IAAI,EAAE;MACZ,IAAIC,IAAI,EAAE;QACT,EAAED,KAAK;QACPC,IAAI,GAAGA,IAAI,CAACxK,MAAM;OAElB,MAAM;QACN,OAAOuK,KAAK;;;EAGf;EAEA;;;EAGOE,aAAaA,CAAA;IACnB,IAAI,CAAC5C,UAAU,GAAG,IAAI;IACtB,IAAI,CAACF,SAAS,EAAE;EACjB;EAEA;;;EAGOvF,eAAeA,CAAA;IACrB,MAAMyD,OAAO,GAAG,IAAI,CAACpH,QAAQ;IAC7B,IAAI,IAAI,CAACuC,GAAG,CAAC,YAAY,CAAC,EAAE;MAC3B,IAAI,CAACM,KAAK,CAACoJ,eAAe,CAAC,IAAI,CAAC;MAChC7E,OAAO,CAAC8E,UAAU,GAAG,IAAI;MACzB9E,OAAO,CAAC+E,gBAAgB,EAAE;MAE1B,MAAM5K,MAAM,GAAG,IAAI,CAACA,MAAM;MAE1B,IAAIA,MAAM,IAAI,IAAI,CAACgB,GAAG,CAAC,UAAU,CAAC,IAAI,UAAU,EAAE;QACjD,IAAIhB,MAAM,CAACgB,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI,IAAIhB,MAAM,CAACgB,GAAG,CAAC,QAAQ,CAAC,IAAI,IAAI,IAAIhB,MAAM,CAACgB,GAAG,CAAC,QAAQ,CAAC,EAAE;UACxFhB,MAAM,CAACoC,eAAe,EAAE;;;MAI1B,IAAI,IAAI,CAACpB,GAAG,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC6J,OAAO,EAAE,EAAE;QAC5C,IAAI,CAAClF,sBAAsB,EAAE;;;EAGhC;EAEA;;;EAGOA,sBAAsBA,CAAA;IAC5B;IACA,IAAI,CAACrE,KAAK,CAACwJ,wBAAwB,CAAC,IAAI,CAAC;IACzC;EACD;EAEA;;;EAGO9F,cAAcA,CAAA;IACpB;IACA,IAAI,CAACvG,QAAQ,CAACuG,cAAc,CAAC,IAAI,CAAC;EACnC;EAEA;;;EAGO2C,SAASA,CAAA;IACf,KAAK,CAACA,SAAS,EAAE;IACjB,IAAI,CAAC3C,cAAc,EAAE;EACtB;EAEO+F,aAAaA,CAAA;IACnB,MAAMC,SAAS,GAAG,IAAI,CAACC,oBAAoB;IAE3C,IAAIC,SAAkB;IAEtB;IACA,IAAI,CAAC,IAAI,CAAClK,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAACN,UAAU,CAAC,SAAS,CAAC,IAAI,IAAI,CAACM,GAAG,CAAC,aAAa,CAAC,EAAE;MACnFkK,SAAS,GAAG;QACXjK,IAAI,EAAE,CAAC;QACPC,KAAK,EAAE,CAAC;QACRC,GAAG,EAAE,CAAC;QACNC,MAAM,EAAE;OACR;MACD,IAAI,CAAC8C,YAAY,GAAGgH,SAAS;MAC7B,IAAI,CAACD,oBAAoB,GAAGC,SAAS;KACrC,MACI;MACJ,IAAI,CAACvK,UAAU,EAAE;MACjB,IAAI,CAACwK,aAAa,CAAC,IAAI,CAACjH,YAAY,CAAC;MACrC,IAAI,CAACD,gBAAgB,EAAE;MACvB,IAAI,CAACgH,oBAAoB,GAAG,IAAI,CAACxM,QAAQ,CAAC2M,iBAAiB,CAAC,IAAI,CAAClH,YAAY,CAAC;MAC9EgH,SAAS,GAAG,IAAI,CAACD,oBAAqB;;IAGvC,IAAI,CAACD,SAAS,IAAKA,SAAS,CAAC/J,IAAI,KAAKiK,SAAS,CAACjK,IAAI,IAAI+J,SAAS,CAAC7J,GAAG,KAAK+J,SAAS,CAAC/J,GAAG,IAAI6J,SAAS,CAAC9J,KAAK,KAAKgK,SAAS,CAAChK,KAAK,IAAI8J,SAAS,CAAC5J,MAAM,KAAK8J,SAAS,CAAC9J,MAAO,EAAE;MACzK,MAAMmC,SAAS,GAAG,eAAe;MACjC,IAAI,IAAI,CAAC5E,MAAM,CAACuB,SAAS,CAACqD,SAAS,CAAC,EAAE;QACrC,IAAI,CAAC5E,MAAM,CAACJ,QAAQ,CAACgF,SAAS,EAAE;UAAEvF,IAAI,EAAEuF,SAAS;UAAElF,MAAM,EAAE;QAAI,CAAE,CAAC;;MAEnE,IAAI,IAAI,CAAC2B,MAAM,EAAE;QAChB,IAAI,CAACA,MAAM,CAAC2H,SAAS,EAAE;QACvB,IAAI,CAAC3H,MAAM,CAACoC,eAAe,EAAE;;MAG9B;MACA,IAAI,IAAI,CAAC1B,UAAU,CAAC,gBAAgB,CAAC,EAAE;QACtC,IAAI,CAAC4E,WAAW,EAAE;;;EAGrB;EAEO6F,aAAaA,CAACvK,MAAe;IACnC,IAAIyK,QAAQ,GAAG,IAAI,CAACrK,GAAG,CAAC,UAAU,EAAE,IAAI,CAACN,UAAU,CAAC,UAAU,CAAC,CAAC;IAChE,IAAI4K,SAAS,GAAG,IAAI,CAACtK,GAAG,CAAC,WAAW,EAAE,IAAI,CAACN,UAAU,CAAC,WAAW,CAAC,CAAC;IAEnE,IAAItD,KAAK,CAACmO,QAAQ,CAACF,QAAQ,CAAC,EAAE;MAC7B,IAAIzK,MAAM,CAACM,KAAK,GAAGN,MAAM,CAACK,IAAI,GAAGoK,QAAQ,EAAE;QAC1CzK,MAAM,CAACM,KAAK,GAAGN,MAAM,CAACK,IAAI,GAAGoK,QAAQ;;;IAIvC,IAAIjO,KAAK,CAACmO,QAAQ,CAACD,SAAS,CAAC,EAAE;MAC9B,IAAI1K,MAAM,CAACQ,MAAM,GAAGR,MAAM,CAACO,GAAG,GAAGmK,SAAS,EAAE;QAC3C1K,MAAM,CAACQ,MAAM,GAAGR,MAAM,CAACO,GAAG,GAAGmK,SAAS;;;IAIxC,IAAIE,YAAY,GAAG,IAAI,CAAC9K,UAAU,CAAC,OAAO,CAAC;IAC3C,IAAI+K,aAAa,GAAG,IAAI,CAAC/K,UAAU,CAAC,QAAQ,CAAC;IAE7C,IAAItD,KAAK,CAACmO,QAAQ,CAACC,YAAY,CAAC,EAAE;MACjC,IAAIA,YAAY,GAAG,CAAC,EAAE;QACrB5K,MAAM,CAACM,KAAK,GAAGN,MAAM,CAACK,IAAI,GAAGuK,YAAY;OACzC,MACI;QACJ5K,MAAM,CAACK,IAAI,GAAGL,MAAM,CAACM,KAAK,GAAGsK,YAAY;;;IAI3C,IAAIpO,KAAK,CAACmO,QAAQ,CAACE,aAAa,CAAC,EAAE;MAClC,IAAIA,aAAa,GAAG,CAAC,EAAE;QACtB7K,MAAM,CAACQ,MAAM,GAAGR,MAAM,CAACO,GAAG,GAAGsK,aAAa;OAC1C,MACI;QACJ7K,MAAM,CAACO,GAAG,GAAGP,MAAM,CAACQ,MAAM,GAAGqK,aAAa;;;EAG7C;EAEUC,aAAaA,CAAC1L,MAA6B;IACpD,IAAIA,MAAM,EAAE;MACXA,MAAM,CAAC2L,QAAQ,CAACC,WAAW,CAAC,IAAI,CAAC;MACjCzO,MAAM,CAAC2G,WAAW,CAAC9D,MAAM,CAAC6D,uBAAuB,EAAE,IAAI,CAAC;MACxD1G,MAAM,CAAC2G,WAAW,CAAC9D,MAAM,CAAC+D,2BAA2B,EAAE,IAAI,CAAC;;EAE9D;EAEO8H,WAAWA,CAAA;IACjB,KAAK,CAACA,WAAW,EAAE;IACnB,IAAI,CAAChE,UAAU,GAAG,KAAK;IACvB,IAAI,CAACtC,cAAc,GAAG,KAAK;EAC5B;EAEA;;;EAGOuG,KAAKA,CAAA;IACX,IAAI,CAAC,IAAI,CAACjD,UAAU,EAAE,EAAE;MACvB,IAAI,CAACvD,WAAW,EAAE;MAClB,IAAI,CAAC0D,WAAW,EAAE;;EAEpB;EAEA;;;EAGO+C,OAAOA,CAAA;IACb,IAAI,CAAC,IAAI,CAAClD,UAAU,EAAE,EAAE;MACvB,IAAI,CAAClC,WAAW,EAAE;MAClB,IAAI,CAACsC,UAAU,EAAE;;EAEnB;EAEA;;;EAGO3D,WAAWA,CAACpH,KAAc;IAChC,IAAI,CAAC,IAAI,CAAC2K,UAAU,EAAE,EAAE;MACvB,MAAM/D,OAAO,GAAG,IAAI,CAAC4B,UAAU,EAAE;MACjC,MAAML,WAAW,GAAG,IAAI,CAACrF,GAAG,CAAC,aAAa,CAAC;MAC3C,MAAMsF,WAAW,GAAG,IAAI,CAACtF,GAAG,CAAC,aAAa,CAAC;MAE3C,IAAI,CAACqF,WAAW,IAAIC,WAAW,KAAKxB,OAAO,EAAE;QAC5C,MAAMkH,eAAe,GAAG,IAAI,CAAChL,GAAG,CAAC,iBAAiB,CAAC;QACnD,MAAMiL,aAAa,GAAG,IAAI,CAACvL,UAAU,CAAC,eAAe,EAAE,IAAI,CAAC;QAE5D,IAAIsL,eAAe,IAAI,OAAO,IAAI,CAAC9N,KAAK,EAAE;UACzC,IAAI,CAACO,QAAQ,CAACyN,UAAU,EAAE;UAC1BhO,KAAK,GAAG,IAAI,CAACiO,QAAQ,CAACF,aAAa,CAACG,gBAAgB,EAAE,CAAC;;QAGxDtH,OAAO,CAACtG,GAAG,CAAC,SAAS,EAAEN,KAAK,CAAC;QAC7B4G,OAAO,CAACtG,GAAG,CAAC,eAAe,EAAEyN,aAAa,CAAC;QAE3C,IAAI,CAACnH,OAAO,CAAC9D,GAAG,CAAC,GAAG,CAAC,EAAE;UACtB8D,OAAO,CAACtG,GAAG,CAAC,GAAG,EAAEN,KAAK,CAACmG,CAAC,CAAC;;QAE1B,IAAI,CAACS,OAAO,CAAC9D,GAAG,CAAC,GAAG,CAAC,EAAE;UACtB8D,OAAO,CAACtG,GAAG,CAAC,GAAG,EAAEN,KAAK,CAACsG,CAAC,CAAC;;QAG1B,IAAI6B,WAAW,EAAE;UAChBvB,OAAO,CAACuH,KAAK,CAAC7N,GAAG,CAAC,MAAM,EAAE6H,WAAW,CAAC;;QAEvC,IAAIC,WAAW,EAAE;UAChBxB,OAAO,CAACuH,KAAK,CAAC7N,GAAG,CAAC,MAAM,EAAE8H,WAAW,CAAC;;QAEvC,MAAMvD,QAAQ,GAAG,IAAI,CAACA,QAAQ;QAC9B,IAAIA,QAAQ,EAAE;UACb+B,OAAO,CAACuH,KAAK,CAACjJ,YAAY,CAACL,QAAQ,CAAC;;QAGrC,IAAI,IAAI,CAAC/B,GAAG,CAAC,eAAe,CAAC,IAAI,QAAQ,KAAK9C,KAAK,CAACmG,CAAC,GAAG,CAAC,IAAInG,KAAK,CAACmG,CAAC,GAAG,IAAI,CAAC/C,KAAK,CAACgL,KAAK,EAAE,IAAIpO,KAAK,CAACsG,CAAC,GAAG,CAAC,IAAItG,KAAK,CAACsG,CAAC,GAAG,IAAI,CAAClD,KAAK,CAACiL,MAAM,EAAE,CAAC,EAAE;UAC3I,IAAI,CAAC5F,WAAW,EAAE;UAClB;;QAGD7B,OAAO,CAACuH,KAAK,CAACG,IAAI,CAACC,aAAa,EAAE;QAClC,MAAMC,OAAO,GAAG5H,OAAO,CAAC6H,IAAI,EAAE;QAC9B,IAAI,CAAC1K,aAAa,CAAC,gBAAgB,EAAE,IAAI,CAAC;QAC1C,OAAOyK,OAAO;;;EAGjB;EAEA;;;EAGO/F,WAAWA,CAAA;IACjB,MAAM7B,OAAO,GAAG,IAAI,CAAC4B,UAAU,EAAE;IACjC,IAAI5B,OAAO,EAAE;MACZ,IAAIA,OAAO,CAAC9D,GAAG,CAAC,eAAe,CAAC,IAAI,IAAI,CAACN,UAAU,CAAC,eAAe,EAAE,IAAI,CAAC,IAAI,IAAI,CAACM,GAAG,CAAC,SAAS,CAAC,IAAI8D,OAAO,EAAE;QAC7G,IAAI8H,OAAO,GAAG9H,OAAO,CAAC9D,GAAG,CAAC,iBAAiB,CAAC,IAAI8D,OAAO,CAAC9D,GAAG,CAAC,wBAAwB,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,GAAGnC,SAAS;QAC/G,MAAM6N,OAAO,GAAG5H,OAAO,CAAC+H,IAAI,CAACD,OAAO,CAAC;QACrC,IAAI,CAAC3K,aAAa,CAAC,gBAAgB,EAAE,KAAK,CAAC;QAC3C,OAAOyK,OAAO;;;EAGjB;EAEON,gBAAgBA,CAAA;IACtB,MAAMxL,MAAM,GAAG,IAAI,CAACsD,YAAa;IAEjC,IAAItD,MAAM,EAAE;MACX,IAAIyD,CAAC,GAAG,CAAC;MACT,IAAIG,CAAC,GAAG,CAAC;MAET,IAAI,CAAC,IAAI,CAACxD,GAAG,CAAC,YAAY,CAAC,EAAE;QAC5BqD,CAAC,GAAGnH,MAAM,CAACoH,eAAe,CAAC,IAAI,CAACtD,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC,EAAE,IAAI,CAACsL,KAAK,EAAE,CAAC;QACjE9H,CAAC,GAAGtH,MAAM,CAACoH,eAAe,CAAC,IAAI,CAACtD,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC,EAAE,IAAI,CAACuL,MAAM,EAAE,CAAC;OAClE,MACI;QACJlI,CAAC,GAAGzD,MAAM,CAACK,IAAI,GAAG/D,MAAM,CAACoH,eAAe,CAAC,IAAI,CAACtD,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC,EAAEJ,MAAM,CAACM,KAAK,GAAGN,MAAM,CAACK,IAAI,CAAC;QAC7FuD,CAAC,GAAG5D,MAAM,CAACO,GAAG,GAAGjE,MAAM,CAACoH,eAAe,CAAC,IAAI,CAACtD,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC,EAAEJ,MAAM,CAACQ,MAAM,GAAGR,MAAM,CAACO,GAAG,CAAC;;MAG7F,OAAO;QAAEkD,CAAC;QAAEG;MAAC,CAAE;;IAEhB,OAAO;MAAEH,CAAC,EAAE,CAAC;MAAEG,CAAC,EAAE;IAAC,CAAE;EACtB;EAEA;;;;;EAKOkC,UAAUA,CAAA;IAChB,IAAI5B,OAAO,GAAG,IAAI,CAAC9D,GAAG,CAAC,SAAS,CAAC;IACjC,IAAI,CAAC8D,OAAO,EAAE;MACb,IAAI9E,MAAM,GAAG,IAAI,CAACA,MAAM;MACxB,IAAIA,MAAM,EAAE;QACX,OAAOA,MAAM,CAAC0G,UAAU,EAAE;;KAE3B,MACI;MACJ,OAAO5B,OAAO;;EAEhB;EAEOgI,eAAeA,CAAA;IAErB,MAAM9M,MAAM,GAAG,IAAI,CAACA,MAAM;IAE1B,IAAI+M,EAAE,GAAG,IAAI,CAAC/L,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC;IAC1B,IAAIgM,EAAE,GAAG,IAAI,CAAChM,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC;IAE1B,IAAIqD,CAAC,GAAG,IAAI,CAACrD,GAAG,CAAC,GAAG,CAAC;IACrB,IAAIiM,EAAE,GAAG,IAAI,CAACvM,UAAU,CAAC,GAAG,CAAC;IAE7B,IAAIwM,EAAE,GAAG,CAAC;IACV,IAAIC,EAAE,GAAG,CAAC;IAEV,MAAMC,QAAQ,GAAG,IAAI,CAACpM,GAAG,CAAC,UAAU,CAAC;IAErC,IAAIqD,CAAC,YAAYxH,OAAO,EAAE;MACzB,IAAImD,MAAM,EAAE;QACXqE,CAAC,GAAGrE,MAAM,CAACqN,UAAU,EAAE,GAAGhJ,CAAC,CAACZ,KAAK,GAAGzD,MAAM,CAACgB,GAAG,CAAC,aAAa,EAAE,CAAC,CAAC;OAChE,MACI;QACJqD,CAAC,GAAG,CAAC;;;IAGP,IAAIjH,KAAK,CAACmO,QAAQ,CAAClH,CAAC,CAAC,EAAE;MACtB6I,EAAE,GAAG7I,CAAC,GAAG0I,EAAE;KACX,MACI;MACJ,IAAIE,EAAE,IAAI,IAAI,EAAE;QACfC,EAAE,GAAGD,EAAE;OACP,MACI,IAAIjN,MAAM,EAAE;QAChB,IAAIoN,QAAQ,IAAI,UAAU,EAAE;UAC3BF,EAAE,GAAGlN,MAAM,CAACgB,GAAG,CAAC,aAAa,EAAE,CAAC,CAAC,GAAG+L,EAAE;;;;IAMzC,IAAIvI,CAAC,GAAG,IAAI,CAACxD,GAAG,CAAC,GAAG,CAAC;IACrB,IAAIsM,EAAE,GAAG,IAAI,CAAC5M,UAAU,CAAC,GAAG,CAAC;IAE7B,IAAI8D,CAAC,YAAY3H,OAAO,EAAE;MACzB,IAAImD,MAAM,EAAE;QACXwE,CAAC,GAAGxE,MAAM,CAACuN,WAAW,EAAE,GAAG/I,CAAC,CAACf,KAAK,GAAGzD,MAAM,CAACgB,GAAG,CAAC,YAAY,EAAE,CAAC,CAAC;OAChE,MACI;QACJwD,CAAC,GAAG,CAAC;;;IAGP,IAAIpH,KAAK,CAACmO,QAAQ,CAAC/G,CAAC,CAAC,EAAE;MACtB2I,EAAE,GAAG3I,CAAC,GAAGwI,EAAE;KACX,MACI;MACJ,IAAIM,EAAE,IAAI,IAAI,EAAE;QACfH,EAAE,GAAGG,EAAE;OACP,MACI,IAAItN,MAAM,EAAE;QAChB,IAAIoN,QAAQ,IAAI,UAAU,EAAE;UAC3BD,EAAE,GAAGnN,MAAM,CAACgB,GAAG,CAAC,YAAY,EAAE,CAAC,CAAC,GAAGgM,EAAE;;;;IAKxC,MAAMnH,OAAO,GAAG,IAAI,CAACpH,QAAQ;IAE7B,IAAIoH,OAAO,CAACxB,CAAC,IAAI6I,EAAE,IAAIrH,OAAO,CAACrB,CAAC,IAAI2I,EAAE,EAAE;MACvCtH,OAAO,CAAC+E,gBAAgB,EAAE;MAC1B/E,OAAO,CAACxB,CAAC,GAAG6I,EAAE;MACdrH,OAAO,CAACrB,CAAC,GAAG2I,EAAE;MAEd,MAAM5J,SAAS,GAAG,iBAAiB;MACnC,IAAI,IAAI,CAAC5E,MAAM,CAACuB,SAAS,CAACqD,SAAS,CAAC,EAAE;QACrC,IAAI,CAAC5E,MAAM,CAACJ,QAAQ,CAACgF,SAAS,EAAE;UAAEvF,IAAI,EAAEuF,SAAS;UAAElF,MAAM,EAAE;QAAI,CAAE,CAAC;;;IAIpE;IACA,IAAI,IAAI,CAACqC,UAAU,CAAC,gBAAgB,CAAC,EAAE;MACtC,IAAI,CAAC4E,WAAW,EAAE;;EAEpB;EAEA;;;;;EAKOjB,CAACA,CAAA;IACP,IAAIA,CAAC,GAAG,IAAI,CAACrD,GAAG,CAAC,GAAG,CAAC;IACrB,IAAIiM,EAAE,GAAG,IAAI,CAACvM,UAAU,CAAC,GAAG,CAAC;IAE7B,MAAMV,MAAM,GAAG,IAAI,CAACA,MAAM;IAC1B,IAAIA,MAAM,EAAE;MACX,IAAIqE,CAAC,YAAYxH,OAAO,EAAE;QACzB,OAAOK,MAAM,CAACoH,eAAe,CAACD,CAAC,EAAErE,MAAM,CAACqN,UAAU,EAAE,CAAC,GAAGrN,MAAM,CAACgB,GAAG,CAAC,aAAa,EAAE,CAAC,CAAC;OACpF,MACI;QACJ,IAAI,CAAC5D,KAAK,CAACmO,QAAQ,CAAClH,CAAC,CAAC,EAAE;UACvB,IAAI4I,EAAE,IAAI,IAAI,EAAE;YACf,OAAOA,EAAE;WACT,MACI;YACJ,OAAOjN,MAAM,CAACgB,GAAG,CAAC,aAAa,EAAE,IAAI,CAACvC,QAAQ,CAAC4F,CAAC,CAAC;;SAElD,MACI;UACJ,OAAOA,CAAC;;;;IAKX,OAAO,IAAI,CAAC5F,QAAQ,CAAC4F,CAAC;EACvB;EAEA;;;;;EAKOG,CAACA,CAAA;IAEP,IAAI8I,EAAE,GAAG,IAAI,CAAC5M,UAAU,CAAC,GAAG,CAAC;IAE7B,IAAI4M,EAAE,IAAI,IAAI,EAAE;MACf,OAAOA,EAAE;;IAGV,IAAI9I,CAAC,GAAG,IAAI,CAACxD,GAAG,CAAC,GAAG,CAAC;IACrB,MAAMhB,MAAM,GAAG,IAAI,CAACA,MAAM;IAE1B,IAAIA,MAAM,EAAE;MACX,IAAIwE,CAAC,YAAY3H,OAAO,EAAE;QACzB,OAAOK,MAAM,CAACoH,eAAe,CAACE,CAAC,EAAExE,MAAM,CAACuN,WAAW,EAAE,CAAC,GAAGvN,MAAM,CAACgB,GAAG,CAAC,YAAY,EAAE,CAAC,CAAC;OACpF,MACI;QACJ,IAAI,CAAC5D,KAAK,CAACmO,QAAQ,CAAC/G,CAAC,CAAC,EAAE;UACvB,IAAI8I,EAAE,IAAI,IAAI,EAAE;YACf,OAAOA,EAAE;WACT,MACI;YACJ,OAAOtN,MAAM,CAACgB,GAAG,CAAC,YAAY,EAAE,IAAI,CAACvC,QAAQ,CAAC+F,CAAC,CAAC;;SAEjD,MACI;UACJ,OAAOA,CAAC;;;;IAKX,OAAO,IAAI,CAAC/F,QAAQ,CAAC+F,CAAC;EACvB;EAEUgJ,QAAQA,CAAA;IACjB,KAAK,CAACA,QAAQ,EAAE;IAChB,IAAI,CAAC/O,QAAQ,CAACS,OAAO,EAAE;IACvB,IAAI,CAACsD,oBAAoB,EAAE;IAC3B,IAAI,CAACkJ,aAAa,CAAC,IAAI,CAAC1L,MAAM,CAAC;IAC/B,IAAI,CAACsB,KAAK,CAACmM,mBAAmB,CAAC,IAAI,CAAC;IAEpC,MAAM3I,OAAO,GAAG,IAAI,CAAC9D,GAAG,CAAC,SAAS,CAAC;IACnC,IAAI8D,OAAO,EAAE;MACZA,OAAO,CAAC5F,OAAO,EAAE;;IAGlB,IAAI,CAACyI,SAAS,EAAE;EACjB;EAEA;;;EAGO+F,mBAAmBA,CAAA;IACzB,IAAI,CAACvC,aAAa,CAAC,IAAI,CAACF,oBAAoB,CAAC;IAC7C,OAAO,IAAI,CAACA,oBAAoB;EACjC;EAEA;;;;;;EAMO0C,WAAWA,CAAA;IACjB,OAAO,IAAI,CAACzJ,YAAY;EACzB;EAEA;;;;;;EAMOtD,MAAMA,CAAA;IACZ,MAAMA,MAAM,GAAG,IAAI,CAACqK,oBAAoB;IACxC,MAAM5G,CAAC,GAAG,IAAI,CAACA,CAAC,EAAE;IAClB,MAAMG,CAAC,GAAG,IAAI,CAACA,CAAC,EAAE;IAClB,OAAO;MAAEvD,IAAI,EAAEL,MAAM,CAACK,IAAI,GAAGoD,CAAC;MAAEnD,KAAK,EAAEN,MAAM,CAACM,KAAK,GAAGmD,CAAC;MAAElD,GAAG,EAAEP,MAAM,CAACO,GAAG,GAAGqD,CAAC;MAAEpD,MAAM,EAAER,MAAM,CAACQ,MAAM,GAAGoD;IAAC,CAAE;EAC1G;EAEA;;;;;;EAMO3D,YAAYA,CAAA;IAClB,MAAMD,MAAM,GAAG,IAAI,CAAC+M,WAAW,EAAE;IAEjC,MAAMC,EAAE,GAAG,IAAI,CAACzB,QAAQ,CAAC;MAAE9H,CAAC,EAAEzD,MAAM,CAACK,IAAI;MAAEuD,CAAC,EAAE5D,MAAM,CAACO;IAAG,CAAE,CAAC;IAC3D,MAAM0M,EAAE,GAAG,IAAI,CAAC1B,QAAQ,CAAC;MAAE9H,CAAC,EAAEzD,MAAM,CAACM,KAAK;MAAEsD,CAAC,EAAE5D,MAAM,CAACO;IAAG,CAAE,CAAC;IAC5D,MAAM2M,EAAE,GAAG,IAAI,CAAC3B,QAAQ,CAAC;MAAE9H,CAAC,EAAEzD,MAAM,CAACM,KAAK;MAAEsD,CAAC,EAAE5D,MAAM,CAACQ;IAAM,CAAE,CAAC;IAC/D,MAAM2M,EAAE,GAAG,IAAI,CAAC5B,QAAQ,CAAC;MAAE9H,CAAC,EAAEzD,MAAM,CAACK,IAAI;MAAEuD,CAAC,EAAE5D,MAAM,CAACQ;IAAM,CAAE,CAAC;IAE9D,OAAO;MACNH,IAAI,EAAEoG,IAAI,CAAC2G,GAAG,CAACJ,EAAE,CAACvJ,CAAC,EAAEwJ,EAAE,CAACxJ,CAAC,EAAEyJ,EAAE,CAACzJ,CAAC,EAAE0J,EAAE,CAAC1J,CAAC,CAAC;MACtClD,GAAG,EAAEkG,IAAI,CAAC2G,GAAG,CAACJ,EAAE,CAACpJ,CAAC,EAAEqJ,EAAE,CAACrJ,CAAC,EAAEsJ,EAAE,CAACtJ,CAAC,EAAEuJ,EAAE,CAACvJ,CAAC,CAAC;MACrCtD,KAAK,EAAEmG,IAAI,CAACC,GAAG,CAACsG,EAAE,CAACvJ,CAAC,EAAEwJ,EAAE,CAACxJ,CAAC,EAAEyJ,EAAE,CAACzJ,CAAC,EAAE0J,EAAE,CAAC1J,CAAC,CAAC;MACvCjD,MAAM,EAAEiG,IAAI,CAACC,GAAG,CAACsG,EAAE,CAACpJ,CAAC,EAAEqJ,EAAE,CAACrJ,CAAC,EAAEsJ,EAAE,CAACtJ,CAAC,EAAEuJ,EAAE,CAACvJ,CAAC;KACvC;EACF;EAEUyJ,OAAOA,CAACC,SAAkB,GAEpC;EAEUC,OAAOA,CAACD,SAAkB,GAEpC;EAEA;;;;;;;;EAQaE,MAAMA,CAACC,QAAiB,EAAEC,KAAc;;MACpD,MAAM,IAAI,CAACzB,IAAI,CAAC,CAAC,CAAC;MAClB,IAAIyB,KAAK,EAAE;QACV,OAAO,IAAIC,OAAO,CAAO,CAACC,OAAO,EAAEC,MAAM,KAAI;UAC5C,IAAI,CAAChI,UAAU,CAAC,MAAK;YACpB+H,OAAO,CAAC,IAAI,CAAC7B,IAAI,CAAC0B,QAAQ,CAAC,CAAC;UAC7B,CAAC,EAAEC,KAAK,CAAC;QACV,CAAC,CAAC;OAEF,MACI;QACJ,OAAO,IAAI,CAAC3B,IAAI,CAAC0B,QAAQ,CAAC;;IAE5B,CAAC;;EAED;;;;;;;;;;;;;;;;;EAiBa1B,IAAIA,CAAC0B,QAAiB;;MAClC,IAAI,CAAC,IAAI,CAACK,UAAU,EAAE;QACrB,IAAI,CAACC,SAAS,GAAG,KAAK;QACtB,IAAI,CAACD,UAAU,GAAG,IAAI;QACtB,IAAI,CAACE,SAAS,GAAG,KAAK;QAEtB,IAAI,IAAI,CAACpJ,MAAM,CAACgE,MAAM,CAAC,SAAS,CAAE,CAACxI,GAAG,CAAC,SAAS,CAAC,EAAE;UAClD,IAAI,CAACxC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC;;QAE1B,IAAI,CAACyP,OAAO,CAACI,QAAQ,CAAC;QAEtB,MAAMQ,UAAU,GAAG,IAAI,CAACrJ,MAAM,CAACC,YAAY,CAAC,SAAS,EAAE4I,QAAQ,CAAC;QAChE,MAAMpR,iBAAiB,CAAC4R,UAAU,CAAC;QAEnC,IAAI,CAACH,UAAU,GAAG,KAAK;;IAEzB,CAAC;;EAED;;;;;;;;;;;;;;;;;EAiBa7B,IAAIA,CAACwB,QAAiB;;MAClC,IAAI,CAAC,IAAI,CAACO,SAAS,IAAI,CAAC,IAAI,CAACD,SAAS,EAAE;QACvC,IAAI,CAACC,SAAS,GAAG,IAAI;QACrB,IAAI,CAACF,UAAU,GAAG,KAAK;QACvB,IAAII,KAAK,GAAG,IAAI,CAACtJ,MAAM,CAACgE,MAAM,CAAC,QAAQ,CAAC;QACxC,IAAI,CAACsF,KAAK,EAAE;UACXA,KAAK,GAAG,IAAI,CAACtJ,MAAM,CAACuJ,MAAM,CAAC,QAAQ,EAAE;YACpC,SAAS,EAAE,CAAC;YACZ,SAAS,EAAE;WACX,CAAC;;QAEH,IAAI,CAACJ,SAAS,GAAG,IAAI;QACrB,IAAI,CAACR,OAAO,CAACE,QAAQ,CAAC;QAEtB,MAAMQ,UAAU,GAAG,IAAI,CAACrJ,MAAM,CAACC,YAAY,CAAC,QAAQ,EAAE4I,QAAQ,CAAC;QAE/D,MAAMpR,iBAAiB,CAAC4R,UAAU,CAAC;QAEnC,IAAI,CAACD,SAAS,GAAG,KAAK;;IAExB,CAAC;;EAED;;;;;EAKOlJ,QAAQA,CAAA;IACd,OAAO,IAAI,CAACiJ,SAAS;EACtB;EAEA;;;;;EAKOK,SAASA,CAAA;IACf,OAAO,IAAI,CAACN,UAAU;EACvB;EAEA;;;;;EAKOO,QAAQA,CAAA;IACd,OAAO,IAAI,CAACL,SAAS;EACtB;EAEA;;;;;EAKOvJ,OAAOA,CAAA;IACb,OAAO,IAAI,CAAC5G,QAAQ,CAACyQ,QAAQ,EAAE;EAChC;EAEA;;;;;EAKOrE,OAAOA,CAAA;IACb,OAAO,IAAI,CAACvJ,KAAK,CAAC6N,OAAO,CAAC,IAAI,CAAC;EAChC;EAEA;;;;;EAKOhP,UAAUA,CAAA;IAChB,OAAO,IAAI,CAACgH,WAAW;EACxB;EAEA;;;;;;EAMOiI,SAASA,CAAA;IACf,IAAI,IAAI,CAACpO,GAAG,CAAC,SAAS,CAAC,IAAI,IAAI,CAACN,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAACM,GAAG,CAAC,aAAa,CAAC,EAAE;MAClF,OAAO,IAAI;;IAEZ,OAAO,KAAK;EACb;EAEA;;;;;;EAMOqO,aAAaA,CAAA;IACnB,OAAO,IAAI,CAAC3L,OAAO,GAAI,IAAI,CAACA,OAAO,CAAC2L,aAAa,EAAE,IAAI,IAAI,CAACD,SAAS,EAAE,GAAI,IAAI,CAACA,SAAS,EAAE;EAC5F;EAEA;;;;;;EAMOE,gBAAgBA,CAAA;IACtB,MAAMC,OAAO,GAAG,IAAI,CAACvO,GAAG,CAAC,SAAS,EAAE,CAAC,CAAC;IACtC,OAAO,IAAI,CAAC0C,OAAO,GAAI,IAAI,CAACA,OAAO,CAAC4L,gBAAgB,EAAE,GAAGC,OAAO,GAAIA,OAAO;EAC5E;EAEA;;;;;;EAMOC,cAAcA,CAAA;IACpB,MAAMhI,KAAK,GAAG,IAAI,CAACxG,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;IAClC,OAAO,IAAI,CAAC0C,OAAO,GAAI,IAAI,CAACA,OAAO,CAAC8L,cAAc,EAAE,GAAGhI,KAAK,GAAIA,KAAK;EACtE;EAEA;;;;;;EAMOiI,iBAAiBA,CAAA;IACvB,MAAMC,QAAQ,GAAG,IAAI,CAAC1O,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC;IACxC,OAAO,IAAI,CAAC0C,OAAO,GAAI,IAAI,CAACA,OAAO,CAAC+L,iBAAiB,EAAE,GAAGC,QAAQ,GAAIA,QAAQ;EAC/E;EAEA;;;;;EAKOpD,KAAKA,CAAA;IACX,IAAIA,KAAK,GAAG,IAAI,CAACtL,GAAG,CAAC,OAAO,CAAC;IAC7B,IAAI2O,QAAQ,GAAG,IAAI,CAAC3O,GAAG,CAAC,UAAU,EAAE,IAAI,CAACN,UAAU,CAAC,UAAU,CAAC,CAAC;IAChE,IAAI2K,QAAQ,GAAG,IAAI,CAACrK,GAAG,CAAC,UAAU,EAAE,IAAI,CAACN,UAAU,CAAC,UAAU,CAAC,CAAC;IAChE,IAAI8K,YAAY,GAAG,IAAI,CAAC9K,UAAU,CAAC,OAAO,CAAC;IAC3C,IAAIkP,CAAC,GAAG,CAAC;IAET,IAAIxS,KAAK,CAACmO,QAAQ,CAACC,YAAY,CAAC,EAAE;MACjCoE,CAAC,GAAGpE,YAAY;KAChB,MACI;MACJ,IAAIc,KAAK,IAAI,IAAI,EAAE;QAClB,IAAI,IAAI,CAACrB,oBAAoB,EAAE;UAC9B2E,CAAC,GAAG,IAAI,CAAC3E,oBAAoB,CAAC/J,KAAK,GAAG,IAAI,CAAC+J,oBAAoB,CAAChK,IAAI;;OAErE,MACI;QACJ,IAAIqL,KAAK,YAAYzP,OAAO,EAAE;UAC7B,MAAMmD,MAAM,GAAG,IAAI,CAACA,MAAM;UAC1B,IAAIA,MAAM,EAAE;YACX4P,CAAC,GAAG5P,MAAM,CAACqN,UAAU,EAAE,GAAGf,KAAK,CAAC7I,KAAK;WACrC,MACI;YACJmM,CAAC,GAAG,IAAI,CAACtO,KAAK,CAACgL,KAAK,EAAE,GAAGA,KAAK,CAAC7I,KAAK;;SAErC,MACI,IAAIrG,KAAK,CAACmO,QAAQ,CAACe,KAAK,CAAC,EAAE;UAC/BsD,CAAC,GAAGtD,KAAK;;;;IAKZ,IAAIlP,KAAK,CAACmO,QAAQ,CAACF,QAAQ,CAAC,EAAE;MAC7BuE,CAAC,GAAGvI,IAAI,CAACC,GAAG,CAAC+D,QAAQ,EAAEuE,CAAC,CAAC;;IAE1B,IAAIxS,KAAK,CAACmO,QAAQ,CAACoE,QAAQ,CAAC,EAAE;MAC7BC,CAAC,GAAGvI,IAAI,CAAC2G,GAAG,CAAC2B,QAAQ,EAAEC,CAAC,CAAC;;IAG1B,OAAOA,CAAC;EACT;EAEA;;;;;EAKOD,QAAQA,CAAA;IACd,IAAIA,QAAQ,GAAG,IAAI,CAAC3O,GAAG,CAAC,UAAU,EAAE,IAAI,CAACN,UAAU,CAAC,UAAU,CAAC,CAAC;IAChE,IAAItD,KAAK,CAACmO,QAAQ,CAACoE,QAAQ,CAAC,EAAE;MAC7B,OAAOA,QAAQ;KACf,MACI;MACJ,IAAIrD,KAAK,GAAG,IAAI,CAACtL,GAAG,CAAC,OAAO,CAAC;MAC7B,IAAI5D,KAAK,CAACmO,QAAQ,CAACe,KAAK,CAAC,EAAE;QAC1B,OAAOA,KAAK;;;IAGd,MAAMtM,MAAM,GAAG,IAAI,CAACA,MAAM;IAC1B,IAAIA,MAAM,EAAE;MACX,OAAOA,MAAM,CAACqN,UAAU,EAAE;;IAE3B,OAAO,IAAI,CAAC/L,KAAK,CAACgL,KAAK,EAAE;EAC1B;EAEA;;;;;EAKOuD,SAASA,CAAA;IACf,IAAIA,SAAS,GAAG,IAAI,CAAC7O,GAAG,CAAC,WAAW,EAAE,IAAI,CAACN,UAAU,CAAC,WAAW,CAAC,CAAC;IACnE,IAAItD,KAAK,CAACmO,QAAQ,CAACsE,SAAS,CAAC,EAAE;MAC9B,OAAOA,SAAS;KAChB,MACI;MACJ,IAAItD,MAAM,GAAG,IAAI,CAACvL,GAAG,CAAC,QAAQ,CAAC;MAC/B,IAAI5D,KAAK,CAACmO,QAAQ,CAACgB,MAAM,CAAC,EAAE;QAC3B,OAAOA,MAAM;;;IAGf,MAAMvM,MAAM,GAAG,IAAI,CAACA,MAAM;IAC1B,IAAIA,MAAM,EAAE;MACX,OAAOA,MAAM,CAACuN,WAAW,EAAE;;IAE5B,OAAO,IAAI,CAACjM,KAAK,CAACiL,MAAM,EAAE;EAC3B;EAEA;;;;;EAKOA,MAAMA,CAAA;IACZ,IAAIA,MAAM,GAAG,IAAI,CAACvL,GAAG,CAAC,QAAQ,CAAC;IAC/B,IAAI6O,SAAS,GAAG,IAAI,CAAC7O,GAAG,CAAC,WAAW,EAAE,IAAI,CAACN,UAAU,CAAC,WAAW,CAAC,CAAC;IACnE,IAAI4K,SAAS,GAAG,IAAI,CAACtK,GAAG,CAAC,WAAW,EAAE,IAAI,CAACN,UAAU,CAAC,WAAW,CAAC,CAAC;IACnE,IAAI+K,aAAa,GAAG,IAAI,CAAC/K,UAAU,CAAC,QAAQ,CAAC;IAC7C,IAAIoP,CAAC,GAAG,CAAC;IAET,IAAI1S,KAAK,CAACmO,QAAQ,CAACE,aAAa,CAAC,EAAE;MAClCqE,CAAC,GAAGrE,aAAa;KACjB,MACI;MACJ,IAAIc,MAAM,IAAI,IAAI,EAAE;QACnB,IAAI,IAAI,CAACtB,oBAAoB,EAAE;UAC9B6E,CAAC,GAAG,IAAI,CAAC7E,oBAAoB,CAAC7J,MAAM,GAAG,IAAI,CAAC6J,oBAAoB,CAAC9J,GAAG;;OAErE,MACI;QACJ,IAAIoL,MAAM,YAAY1P,OAAO,EAAE;UAC9B,MAAMmD,MAAM,GAAG,IAAI,CAACA,MAAM;UAC1B,IAAIA,MAAM,EAAE;YACX8P,CAAC,GAAG9P,MAAM,CAACuN,WAAW,EAAE,GAAGhB,MAAM,CAAC9I,KAAK;WACvC,MACI;YACJqM,CAAC,GAAG,IAAI,CAACxO,KAAK,CAACiL,MAAM,EAAE,GAAGA,MAAM,CAAC9I,KAAK;;SAEvC,MACI,IAAIrG,KAAK,CAACmO,QAAQ,CAACgB,MAAM,CAAC,EAAE;UAChCuD,CAAC,GAAGvD,MAAM;;;;IAKb,IAAInP,KAAK,CAACmO,QAAQ,CAACD,SAAS,CAAC,EAAE;MAC9BwE,CAAC,GAAGzI,IAAI,CAACC,GAAG,CAACgE,SAAS,EAAEwE,CAAC,CAAC;;IAE3B,IAAI1S,KAAK,CAACmO,QAAQ,CAACsE,SAAS,CAAC,EAAE;MAC9BC,CAAC,GAAGzI,IAAI,CAAC2G,GAAG,CAAC6B,SAAS,EAAEC,CAAC,CAAC;;IAG3B,OAAOA,CAAC;EACT;EAEUC,mBAAmBA,CAACC,CAAwC;IACrE;IACA,IAAI,IAAI,CAACvN,cAAc,IAAIuN,CAAC,CAAC,IAAI,CAACvN,cAAc,CAAC,EAAE;MAClD,OAAO,IAAI,CAACA,cAAc;;IAG3B,OAAO,KAAK,CAACsN,mBAAmB,CAACC,CAAC,CAAC;EACpC;EAEOC,YAAYA,CAACD,CAA2B;IAC9C,IAAI,IAAI,CAACtM,OAAO,EAAE;MACjB,IAAI,CAACwM,WAAW,CAACF,CAAC,CAAC;;EAErB;EAEUE,WAAWA,CAACF,CAA2B;IAChD,IAAI,IAAI,CAACtM,OAAO,EAAE;MACjB,IAAI,CAACA,OAAO,CAACwM,WAAW,CAACF,CAAC,CAAC;;IAG5BA,CAAC,CAAC,IAAI,CAAC;EACR;EAEA;;;;;EAKA,IAAWhQ,MAAMA,CAAA;IAChB,OAAO,IAAI,CAAC0D,OAAO;EACpB;EAEOyM,UAAUA,CAACnQ,MAAiB,EAAiC;IAAA,IAA/BoQ,cAAA,GAAAC,SAAA,CAAAvG,MAAA,QAAAuG,SAAA,QAAAxR,SAAA,GAAAwR,SAAA,MAA0B,KAAK;IACnE,MAAMC,UAAU,GAAG,IAAI,CAAC5M,OAAO;IAC/B,IAAI1D,MAAM,KAAKsQ,UAAU,EAAE;MAC1B,IAAI,CAAClO,eAAe,EAAE;MAEtBpC,MAAM,CAAC2H,SAAS,EAAE;MAElB,IAAI,CAACjE,OAAO,GAAG1D,MAAM;MAErB,IAAIoQ,cAAc,EAAE;QACnB,IAAI,CAAC1E,aAAa,CAAC4E,UAAU,CAAC;QAE9B,IAAItQ,MAAM,EAAE;UACX,IAAI,CAAC2D,0BAA0B,EAAE;UACjC,IAAI,CAACtB,8BAA8B,EAAE;;;MAIvC,IAAI,CAACC,iBAAiB,EAAE;MACxB,IAAI,CAACiO,YAAY,EAAE;;EAErB;EAEA;;;;;;;;EAQOC,kBAAkBA,CAAA;IACxB,OAAO,IAAI,CAACxP,GAAG,CAAC,iBAAiB,EAAE,IAAI,CAACM,KAAK,CAACmP,eAAe,CAAC;EAC/D;EAEA;;;;;;;;EAQOC,gBAAgBA,CAAA;IACtB,OAAO,IAAI,CAAC1P,GAAG,CAAC,eAAe,EAAE,IAAI,CAACM,KAAK,CAACqP,aAAa,CAAC;EAC3D;EAEA;;;;;;;;EAQOC,oBAAoBA,CAAA;IAC1B,OAAO,IAAI,CAAC5P,GAAG,CAAC,mBAAmB,EAAE,IAAI,CAACM,KAAK,CAACuP,iBAAiB,CAAC;EACnE;EAEA;;;;;;EAMO1E,QAAQA,CAACjO,KAAa;IAC5B,OAAO,IAAI,CAACO,QAAQ,CAAC0N,QAAQ,CAACjO,KAAK,CAAC;EACrC;EAEA;;;;;;EAMO4S,OAAOA,CAAC5S,KAAa;IAC3B,OAAO,IAAI,CAACO,QAAQ,CAACqS,OAAO,CAAC5S,KAAK,CAAC;EACpC;EAEO6S,aAAaA,CAAA;IACnB,MAAMC,EAAE,GAAG,IAAI,CAACC,eAAe,EAAE;IACjC,IAAID,EAAE,EAAE;MACP,OAAO,IAAI,CAACpH,WAAW,CAACoH,EAAE,CAAC;;EAG7B;EAEOC,eAAeA,CAAA;IACrB,IAAI,IAAI,CAACrH,WAAW,EAAE;MACrB,OAAOvM,OAAO,CAAC6T,WAAW,CAAC,IAAI,CAACtH,WAAW,EAAE,CAACuH,CAAC,EAAEC,CAAC,KAAI;QACrD,IAAID,CAAC,GAAGC,CAAC,EAAE;UACV,OAAO,CAAC;;QAET,IAAID,CAAC,GAAGC,CAAC,EAAE;UACV,OAAO,CAAC,CAAC;;QAEV,OAAO,CAAC;MACT,CAAC,CAAC,CAAC,CAAC,CAAC;;EAEP;EAEA;;;;;;EAMOC,OAAOA,CAAA;IACb,MAAMrR,MAAM,GAAG,IAAI,CAACA,MAAM;IAC1B,IAAIA,MAAM,EAAE;MACXA,MAAM,CAAC2L,QAAQ,CAAC2F,SAAS,CAAC,IAAI,EAAEtR,MAAM,CAAC2L,QAAQ,CAAC7B,MAAM,GAAG,CAAC,CAAC;;EAE7D;EAEA;;;;;;EAMOyH,MAAMA,CAAA;IACZ,MAAMvR,MAAM,GAAG,IAAI,CAACA,MAAM;IAC1B,IAAIA,MAAM,EAAE;MACXA,MAAM,CAAC2L,QAAQ,CAAC2F,SAAS,CAAC,IAAI,EAAE,CAAC,CAAC;;EAEpC;;AAn6DA5T,MAAA,CAAAC,cAAA,CAAAoE,MAAA;;;;SAAkC;;AAClCrE,MAAA,CAAAC,cAAA,CAAAoE,MAAA;;;;SAA0CpF,MAAM,CAAC6U,UAAU,CAACC,MAAM,CAAC,CAAC1P,MAAM,CAAC2P,SAAS,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}